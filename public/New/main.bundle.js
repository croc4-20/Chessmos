/*! For license information please see main.bundle.js.LICENSE.txt */
(()=>{var e,t,n,r,o,i,a,s,c={6463:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Keplr=void 0;const i=n(4202),a=n(7533),s=n(6677),c=o(n(4744)),l=o(n(8570)),u=n(8287),h=o(n(7007));t.Keplr=class{constructor(e,t,n){this.version=e,this.mode=t,this.requester=n,this.enigmaUtils=new Map,this.defaultOptions={},this.ethereum=new d(this,this.requester)}ping(){return r(this,void 0,void 0,(function*(){yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"chains","keplr-ping",{})}))}enable(e){return"string"==typeof e&&(e=[e]),new Promise(((t,n)=>{let r=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"permission-interactive","enable-access",{chainIds:e}).then(t).catch(n).finally((()=>r=!0)),setTimeout((()=>{r||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}isEnabled(e){return r(this,void 0,void 0,(function*(){return"string"==typeof e&&(e=[e]),yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"permission-interactive","is-enabled-access",{chainIds:e})}))}disable(e){return r(this,void 0,void 0,(function*(){return"string"==typeof e&&(e=[e]),new Promise(((t,n)=>{let r=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"permission-interactive","disable-access",{chainIds:null!=e?e:[]}).then(t).catch(n).finally((()=>r=!0)),setTimeout((()=>{r||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}experimentalSuggestChain(e){return r(this,void 0,void 0,(function*(){if(e.hideInUI)throw new Error("hideInUI is not allowed");if(e.gasPriceStep){const t=Object.assign({},e.gasPriceStep);for(const n of e.feeCurrencies)n.gasPriceStep||(n.gasPriceStep=t);delete e.gasPriceStep,console.warn("The `gasPriceStep` field of the `ChainInfo` has been moved under `feeCurrencies`. This is automatically handled as of right now, but the upcoming update would potentially cause errors.")}return e.coinType&&(console.warn("The `coinType` field of the `ChainInfo` is removed. This is automatically handled as of right now, but the upcoming update would potentially cause errors."),delete e.coinType),new Promise(((t,n)=>{let r=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"chains","suggest-chain-info",{chainInfo:e}).then(t).catch(n).finally((()=>r=!0)),setTimeout((()=>{r||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}getKey(e){return r(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{let r=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-cosmos","get-cosmos-key",{chainId:e}).then(t).catch(n).finally((()=>r=!0)),setTimeout((()=>{r||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}getKeysSettled(e){return r(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{let r=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-cosmos","get-cosmos-keys-settled",{chainIds:e}).then(t).catch(n).finally((()=>r=!0)),setTimeout((()=>{r||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}getChainInfosWithoutEndpoints(){return r(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{let n=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"chains","get-chain-infos-without-endpoints",{}).then((t=>e(t.chainInfos))).catch(t).finally((()=>n=!0)),setTimeout((()=>{n||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}getChainInfoWithoutEndpoints(e){return r(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{let r=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"chains","get-chain-info-without-endpoints",{chainId:e}).then((e=>t(e.chainInfo))).catch(n).finally((()=>r=!0)),setTimeout((()=>{r||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}sendTx(e,t,n){return r(this,void 0,void 0,(function*(){return yield this.enable(e),yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"background-tx","send-tx-to-background",{chainId:e,tx:t,mode:n})}))}signAmino(e,t,n,o={}){return r(this,void 0,void 0,(function*(){return new Promise(((r,a)=>{var s;let l=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-cosmos","request-cosmos-sign-amino",{chainId:e,signer:t,signDoc:n,signOptions:(0,c.default)(null!==(s=this.defaultOptions.sign)&&void 0!==s?s:{},o)}).then(r).catch(a).finally((()=>l=!0)),setTimeout((()=>{l||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}signDirect(e,t,n,o={}){return r(this,void 0,void 0,(function*(){return new Promise(((r,a)=>{var s;let u=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-cosmos","request-cosmos-sign-direct",{chainId:e,signer:t,signDoc:{bodyBytes:n.bodyBytes,authInfoBytes:n.authInfoBytes,chainId:n.chainId,accountNumber:n.accountNumber?n.accountNumber.toString():null},signOptions:(0,c.default)(null!==(s=this.defaultOptions.sign)&&void 0!==s?s:{},o)}).then((e=>r({signed:{bodyBytes:e.signed.bodyBytes,authInfoBytes:e.signed.authInfoBytes,chainId:e.signed.chainId,accountNumber:l.default.fromString(e.signed.accountNumber)},signature:e.signature}))).catch(a).finally((()=>u=!0)),setTimeout((()=>{u||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}signDirectAux(e,t,n,o={}){return r(this,void 0,void 0,(function*(){return new Promise(((r,a)=>{var s;let u=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-cosmos","request-cosmos-sign-direct-aux",{chainId:e,signer:t,signDoc:{bodyBytes:n.bodyBytes,publicKey:n.publicKey,chainId:n.chainId,accountNumber:n.accountNumber?n.accountNumber.toString():null,sequence:n.sequence?n.sequence.toString():null},signOptions:(0,c.default)({preferNoSetMemo:null===(s=this.defaultOptions.sign)||void 0===s?void 0:s.preferNoSetMemo},o)}).then((e=>r({signed:{bodyBytes:e.signed.bodyBytes,publicKey:e.signed.publicKey,chainId:e.signed.chainId,accountNumber:l.default.fromString(e.signed.accountNumber),sequence:l.default.fromString(e.signed.sequence)},signature:e.signature}))).catch(a).finally((()=>u=!0)),setTimeout((()=>{u||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}signArbitrary(e,t,n){return r(this,void 0,void 0,(function*(){return new Promise(((r,o)=>{let a=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-cosmos","request-cosmos-sign-amino-adr-36",{chainId:e,signer:t,data:"string"==typeof n?u.Buffer.from(n):n,signOptions:{isADR36WithString:"string"==typeof n}}).then(r).catch(o).finally((()=>a=!0)),setTimeout((()=>{a||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}verifyArbitrary(e,t,n,o){return r(this,void 0,void 0,(function*(){return"string"==typeof n&&(n=u.Buffer.from(n)),new Promise(((r,a)=>{let s=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-cosmos","verify-cosmos-sign-amino-adr-36",{chainId:e,signer:t,data:n,signature:o}).then(r).catch(a).finally((()=>s=!0)),setTimeout((()=>{s||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}signEthereum(e,t,n,o){return r(this,void 0,void 0,(function*(){return new Promise(((r,a)=>{let s=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-ethereum","request-sign-ethereum",{chainId:e,signer:t,message:"string"==typeof n?u.Buffer.from(n):n,signType:o}).then(r).catch(a).finally((()=>s=!0)),setTimeout((()=>{s||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}signICNSAdr36(e,t,n,o,a){return r(this,void 0,void 0,(function*(){return new Promise(((r,s)=>{let c=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-cosmos","request-icns-adr-36-signatures-v2",{chainId:e,contractAddress:t,owner:n,username:o,addressChainIds:a}).then(r).catch(s).finally((()=>c=!0)),setTimeout((()=>{c||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}getOfflineSigner(e,t){return new s.CosmJSOfflineSigner(e,this,t)}getOfflineSignerOnlyAmino(e,t){return new s.CosmJSOfflineSignerOnlyAmino(e,this,t)}getOfflineSignerAuto(e,t){return r(this,void 0,void 0,(function*(){return(yield this.getKey(e)).isNanoLedger?new s.CosmJSOfflineSignerOnlyAmino(e,this,t):new s.CosmJSOfflineSigner(e,this,t)}))}suggestToken(e,t,n){return r(this,void 0,void 0,(function*(){return new Promise(((r,o)=>{let a=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"token-cw20","SuggestTokenMsg",{chainId:e,contractAddress:t,viewingKey:n}).then(r).catch(o).finally((()=>a=!0)),setTimeout((()=>{a||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}getSecret20ViewingKey(e,t){return r(this,void 0,void 0,(function*(){return new Promise(((n,r)=>{let o=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"token-cw20","get-secret20-viewing-key",{chainId:e,contractAddress:t}).then(n).catch(r).finally((()=>o=!0)),setTimeout((()=>{o||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}getEnigmaPubKey(e){return r(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{let r=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"secret-wasm","get-pubkey-msg",{chainId:e}).then(t).catch(n).finally((()=>r=!0)),setTimeout((()=>{r||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}getEnigmaTxEncryptionKey(e,t){return r(this,void 0,void 0,(function*(){return new Promise(((n,r)=>{let o=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"secret-wasm","get-tx-encryption-key-msg",{chainId:e,nonce:t}).then(n).catch(r).finally((()=>o=!0)),setTimeout((()=>{o||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}enigmaEncrypt(e,t,n){return r(this,void 0,void 0,(function*(){return new Promise(((r,o)=>{let a=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"secret-wasm","request-encrypt-msg",{chainId:e,contractCodeHash:t,msg:n}).then(r).catch(o).finally((()=>a=!0)),setTimeout((()=>{a||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}enigmaDecrypt(e,t,n){return r(this,void 0,void 0,(function*(){return t&&0!==t.length?new Promise(((r,o)=>{let a=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"secret-wasm","request-decrypt-msg",{chainId:e,cipherText:t,nonce:n}).then(r).catch(o).finally((()=>a=!0)),setTimeout((()=>{a||this.protectedTryOpenSidePanelIfEnabled()}),100)})):new Uint8Array}))}getEnigmaUtils(e){if(this.enigmaUtils.has(e))return this.enigmaUtils.get(e);const t=new a.KeplrEnigmaUtils(e,this);return this.enigmaUtils.set(e,t),t}experimentalSignEIP712CosmosTx_v0(e,t,n,o,a={}){return r(this,void 0,void 0,(function*(){return new Promise(((r,s)=>{var l;let u=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-cosmos","request-sign-eip-712-cosmos-tx-v0",{chainId:e,signer:t,eip712:n,signDoc:o,signOptions:(0,c.default)(null!==(l=this.defaultOptions.sign)&&void 0!==l?l:{},a)}).then(r).catch(s).finally((()=>u=!0)),setTimeout((()=>{u||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}__core__getAnalyticsId(){return r(this,void 0,void 0,(function*(){return yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"analytics","get-analytics-id",{})}))}changeKeyRingName({defaultName:e,editable:t=!0}){return r(this,void 0,void 0,(function*(){return new Promise(((n,r)=>{let o=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-v2","change-keyring-name-interactive",{defaultName:e,editable:t}).then(n).catch(r).finally((()=>o=!0)),setTimeout((()=>{o||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}__core__privilageSignAminoWithdrawRewards(e,t,n){return r(this,void 0,void 0,(function*(){return yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-cosmos","PrivilegeCosmosSignAminoWithdrawRewards",{chainId:e,signer:t,signDoc:n})}))}__core__privilageSignAminoDelegate(e,t,n){return r(this,void 0,void 0,(function*(){return yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-cosmos","PrivilegeCosmosSignAminoDelegate",{chainId:e,signer:t,signDoc:n})}))}sendEthereumTx(e,t){return r(this,void 0,void 0,(function*(){return yield this.enable(e),yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"background-tx-ethereum","send-ethereum-tx-to-background",{chainId:e,tx:t})}))}suggestERC20(e,t){return r(this,void 0,void 0,(function*(){return new Promise(((n,r)=>{let o=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"token-erc20","SuggestERC20TokenMsg",{chainId:e,contractAddress:t}).then(n).catch(r).finally((()=>o=!0)),setTimeout((()=>{o||this.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}protectedTryOpenSidePanelIfEnabled(e=!1){return r(this,void 0,void 0,(function*(){let t=!1;if("undefined"!=typeof window&&!0===window.__keplr_content_script&&(t=!0),t&&(yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"side-panel","GetSidePanelEnabledMsg",{})).enabled)try{return yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"router-extension/src/router/extension.ts","tryOpenSidePanelIfEnabled",{})}catch(t){if(console.log(t),!e&&t.message&&t.message.includes("in response to a user gesture")&&!document.getElementById("__open_keplr_side_panel__")){if(yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"interaction","ping-content-script-tab-has-opened-side-panel",{}))return;const e=yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring","GetIsLockedMsg",{}),t=yield(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"settings","GetThemeOptionMsg",{}),n=`\n                @font-face {\n                  font-family: 'Inter-SemiBold-Keplr';\n                  src: url('${chrome.runtime.getURL("/assets/Inter-SemiBold.ttf")}') format('truetype');\n                  font-weight: 600;\n                  font-style: normal;\n                }\n\n                @keyframes slide-left {\n                  0% {\n                    transform: translateY(0%) translateX(100%);\n                  }\n                  100% {\n                    transform: translateY(0%) translateX(0);\n                  }\n                }\n                    \n                @keyframes tada {\n                  0% {\n                    transform: scale3d(1, 1, 1);\n                  }\n                  10%, 20% {\n                    transform: scale3d(.9, .9, .9) rotate3d(0, 0, 1, -3deg);\n                  }\n                  30%, 50%, 70%, 90% {\n                    transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, 3deg);\n                  }\n                  40%, 60%, 80% {\n                    transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, -3deg);\n                  }\n                  100% {\n                    transform: scale3d(1, 1, 1);\n                  }\n                }\n                  \n            `,r="auto"===t?!window.matchMedia("(prefers-color-scheme: dark)").matches:"light"===t,o=document.createElement("style");o.appendChild(document.createTextNode(n)),document.head.appendChild(o);const a=document.createElement("div");a.id="__open_keplr_side_panel__",a.style.boxSizing="border-box",a.style.animation="slide-left 0.5s forwards",a.style.position="fixed",a.style.right="1.5rem",a.style.top="1.5rem",a.style.padding="1rem 1.75rem 1rem 0.75rem",a.style.zIndex="2147483647",a.style.borderRadius="1rem",a.style.display="flex",a.style.alignItems="center",a.style.fontFamily="Inter-SemiBold-Keplr",a.style.fontWeight="600",a.style.background=r?"#FEFEFE":"#1D1D1F";const s=document.createElement("div");s.style.boxSizing="border-box",s.style.transform="translateY(-0.65rem)",s.style.marginRight="0.35rem",s.innerHTML=`\n                <svg width="31" height="31" viewBox="0 0 31 31" fill="none" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M30 29.7522C25.1484 31.0691 16.7109 27.1184 18.6093 18.3391C20.5078 9.55979 25.5703 11.5351 26.414 12.852C27.2578 14.1689 28.3125 22.2898 15.8672 19.2171C5.9109 16.7589 7.15625 6.04811 8 1M8 1L14 8M8 1L1 7.5" stroke="${r?"#2C4BE2":"#72747B"}"/>\n                </svg>\n              `;const c=document.createElement("div");c.style.boxSizing="border-box",c.style.position="relative",c.style.marginRight="1rem";const l=document.createElement("img"),u=chrome.runtime.getURL(`/assets/${e?"locked-keplr-logo":"icon"}-128.png`);l.src=u,l.style.boxSizing="border-box",l.style.width="3rem",l.style.height="3rem",c.appendChild(l);const h=document.createElement("img"),d=chrome.runtime.getURL("assets/icon-click-cursor.png");h.src=d,h.style.boxSizing="border-box",h.style.position="absolute",h.style.right="-0.2rem",h.style.bottom="-0.2rem",h.style.aspectRatio="78/98",h.style.height="1.375rem",c.appendChild(h);const f=document.createElement("span");if(f.style.boxSizing="border-box",f.style.fontSize="1rem",f.style.color=r?"#020202":"#FEFEFE",f.textContent=e?"Unlock Keplr to proceed":"Open Keplr to approve request(s)",a.appendChild(s),a.appendChild(c),a.appendChild(f),!document.getElementById("__open_keplr_side_panel__")){let e=!1;const t=setInterval((()=>{(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"interaction","ping-content-script-tab-has-opened-side-panel",{}).then((n=>{n&&(clearInterval(t),e||(a.remove(),e=!0))}))}),300);document.body.appendChild(a)}}}}))}};class d extends h.default{constructor(e,t){super(),this.keplr=e,this.requester=t,this.chainId=null,this.selectedAddress=null,this.networkVersion=null,this.isKeplr=!0,this.isMetaMask=!0}protectedEnableAccess(){return r(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{let n=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"permission-interactive","enable-access-for-evm",{}).then(e).catch(t).finally((()=>n=!0)),setTimeout((()=>{n||this.keplr.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}isConnected(){return!0}request({method:e,params:t,providerId:n,chainId:o}){return r(this,void 0,void 0,(function*(){return"keplr_initProviderState"!==e&&(yield this.protectedEnableAccess()),new Promise(((r,a)=>{let s=!1;(0,i.sendSimpleMessage)(this.requester,i.BACKGROUND_PORT,"keyring-ethereum","request-json-rpc-to-evm",{method:e,params:t,providerId:n,chainId:o}).then(r).catch(a).finally((()=>s=!0)),setTimeout((()=>{!s&&f.includes(e)&&this.keplr.protectedTryOpenSidePanelIfEnabled()}),100)}))}))}enable(){return r(this,void 0,void 0,(function*(){return yield this.request({method:"eth_requestAccounts"})}))}net_version(){return r(this,void 0,void 0,(function*(){return yield this.request({method:"net_version"})}))}}const f=["eth_sendTransaction","personal_sign","eth_signTypedData_v3","eth_signTypedData_v4","wallet_addEthereumChain","wallet_switchEthereumChain","wallet_watchAsset"]},6677:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CosmJSOfflineSigner=t.CosmJSOfflineSignerOnlyAmino=void 0;class r{constructor(e,t,n){this.chainId=e,this.keplr=t,this.signOptions=n}getAccounts(){return n(this,void 0,void 0,(function*(){const e=yield this.keplr.getKey(this.chainId);return[{address:e.bech32Address,algo:"secp256k1",pubkey:e.pubKey}]}))}signAmino(e,t){return n(this,void 0,void 0,(function*(){if(this.chainId!==t.chain_id)throw new Error("Unmatched chain id with the offline signer");if((yield this.keplr.getKey(t.chain_id)).bech32Address!==e)throw new Error("Unknown signer address");return yield this.keplr.signAmino(this.chainId,e,t,this.signOptions)}))}sign(e,t){return n(this,void 0,void 0,(function*(){return yield this.signAmino(e,t)}))}}t.CosmJSOfflineSignerOnlyAmino=r,t.CosmJSOfflineSigner=class extends r{constructor(e,t,n){super(e,t,n)}signDirect(e,t){return n(this,void 0,void 0,(function*(){if(this.chainId!==t.chainId)throw new Error("Unmatched chain id with the offline signer");if((yield this.keplr.getKey(t.chainId)).bech32Address!==e)throw new Error("Unknown signer address");return yield this.keplr.signDirect(this.chainId,e,t,this.signOptions)}))}}},7533:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.KeplrEnigmaUtils=void 0,t.KeplrEnigmaUtils=class{constructor(e,t){this.chainId=e,this.keplr=t}getPubkey(){return n(this,void 0,void 0,(function*(){return yield this.keplr.getEnigmaPubKey(this.chainId)}))}getTxEncryptionKey(e){return n(this,void 0,void 0,(function*(){return yield this.keplr.getEnigmaTxEncryptionKey(this.chainId,e)}))}encrypt(e,t){return n(this,void 0,void 0,(function*(){return yield this.keplr.enigmaEncrypt(this.chainId,e,t)}))}decrypt(e,t){return n(this,void 0,void 0,(function*(){return yield this.keplr.enigmaDecrypt(this.chainId,e,t)}))}}},2026:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(6463),t),o(n(6677),t),o(n(7533),t),o(n(2737),t)},2737:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InjectedKeplr=t.injectKeplrToWindow=void 0;const i=n(6382),a=n(4202),s=n(7533),c=n(6677),l=o(n(4744)),u=o(n(8570)),h=o(n(7007));function d(e,t,n){const r=Object.getOwnPropertyDescriptor(e,t);!r||r.writable?!r||r.configurable?Object.defineProperty(e,t,{value:n,writable:!1}):e[t]=n:console.warn(`Failed to inject ${t} from keplr. Probably, other wallet is trying to intercept Keplr`)}t.injectKeplrToWindow=function(e){d(window,"keplr",e),d(window,"getOfflineSigner",e.getOfflineSigner),d(window,"getOfflineSignerOnlyAmino",e.getOfflineSignerOnlyAmino),d(window,"getOfflineSignerAuto",e.getOfflineSignerAuto),d(window,"getEnigmaUtils",e.getEnigmaUtils)};class f{static startProxy(e,t={addMessageListener:e=>window.addEventListener("message",e),removeMessageListener:e=>window.removeEventListener("message",e),postMessage:e=>window.postMessage(e,window.location.origin)},n){const o=o=>r(this,void 0,void 0,(function*(){const i=n?n(o.data):o.data;if(i&&"proxy-request"===i.type)try{if(!i.id)throw new Error("Empty id");if(i.method.startsWith("protected"))throw new Error("Rejected");if("version"===i.method)throw new Error("Version is not function");if("mode"===i.method)throw new Error("Mode is not function");if("defaultOptions"===i.method)throw new Error("DefaultOptions is not function");if(!e[i.method]||"ethereum"!==i.method&&"function"!=typeof e[i.method])throw new Error(`Invalid method: ${i.method}`);if("getOfflineSigner"===i.method)throw new Error("GetOfflineSigner method can't be proxy request");if("getOfflineSignerOnlyAmino"===i.method)throw new Error("GetOfflineSignerOnlyAmino method can't be proxy request");if("getOfflineSignerAuto"===i.method)throw new Error("GetOfflineSignerAuto method can't be proxy request");if("getEnigmaUtils"===i.method)throw new Error("GetEnigmaUtils method can't be proxy request");const n=i.method,o=yield(()=>r(this,void 0,void 0,(function*(){if("signDirect"===n)return yield(()=>r(this,void 0,void 0,(function*(){const t=i.args[2],n=yield e.signDirect(i.args[0],i.args[1],{bodyBytes:t.bodyBytes,authInfoBytes:t.authInfoBytes,chainId:t.chainId,accountNumber:t.accountNumber?u.default.fromString(t.accountNumber):null},i.args[3]);return{signed:{bodyBytes:n.signed.bodyBytes,authInfoBytes:n.signed.authInfoBytes,chainId:n.signed.chainId,accountNumber:n.signed.accountNumber.toString()},signature:n.signature}})))();if("signDirectAux"===n)return yield(()=>r(this,void 0,void 0,(function*(){const t=i.args[2],n=yield e.signDirectAux(i.args[0],i.args[1],{bodyBytes:t.bodyBytes,publicKey:t.publicKey,chainId:t.chainId,accountNumber:t.accountNumber?u.default.fromString(t.accountNumber):null,sequence:t.sequence?u.default.fromString(t.sequence):null},i.args[3]);return{signed:{bodyBytes:n.signed.bodyBytes,publicKey:n.signed.publicKey,chainId:n.signed.chainId,accountNumber:n.signed.accountNumber.toString(),sequence:n.signed.sequence.toString()},signature:n.signature}})))();if("ethereum"===n){const t=i.ethereumProviderMethod;if(null==t?void 0:t.startsWith("protected"))throw new Error("Rejected");if("chainId"===t)throw new Error("chainId is not function");if("selectedAddress"===t)throw new Error("selectedAddress is not function");if("networkVersion"===t)throw new Error("networkVersion is not function");if("isKeplr"===t)throw new Error("isKeplr is not function");if("isMetaMask"===t)throw new Error("isMetaMask is not function");if(void 0===t||"function"!=typeof e.ethereum[t])throw new Error(`${i.ethereumProviderMethod} is not function or invalid Ethereum provider method`);return"request"===t?yield e.ethereum.request(a.JSONUint8Array.unwrap(i.args)):yield e.ethereum[t](...a.JSONUint8Array.unwrap(i.args))}return yield e[n](...a.JSONUint8Array.unwrap(i.args))})))(),s={type:"proxy-request-response",id:i.id,result:{return:a.JSONUint8Array.wrap(o)}};t.postMessage(s)}catch(e){const n={type:"proxy-request-response",id:i.id,result:{error:e.code&&!e.module?{code:e.code,message:e.message,data:e.data}:e.message||e.toString()}};t.postMessage(n)}}));return t.addMessageListener(o),()=>{t.removeMessageListener(o)}}requestMethod(e,t){const n=new Uint8Array(8),r=Array.from(crypto.getRandomValues(n)).map((e=>e.toString(16))).join(""),o={type:"proxy-request",id:r,method:e,args:a.JSONUint8Array.wrap(t)};return new Promise(((e,t)=>{const n=o=>{const i=this.parseMessage?this.parseMessage(o.data):o.data;if(!i||"proxy-request-response"!==i.type)return;if(i.id!==r)return;this.eventListener.removeMessageListener(n);const s=a.JSONUint8Array.unwrap(i.result);s?s.error?t(new Error(s.error)):e(s.return):t(new Error("Result is null"))};this.eventListener.addMessageListener(n),this.eventListener.postMessage(o)}))}constructor(e,t,n={addMessageListener:e=>window.addEventListener("message",e),removeMessageListener:e=>window.removeEventListener("message",e),postMessage:e=>window.postMessage(e,window.location.origin)},r,o){this.version=e,this.mode=t,this.eventListener=n,this.parseMessage=r,this.eip6963ProviderInfo=o,this.enigmaUtils=new Map,this.defaultOptions={},this.ethereum=new g(this,this.eventListener,this.parseMessage,this.eip6963ProviderInfo);const i=Object.keys(this);for(const e of i)if("defaultOptions"!==e&&Object.defineProperty(this,e,{value:this[e],writable:!1}),"eventListener"===e){const e=Object.keys(this.eventListener);for(const t of e)Object.defineProperty(this.eventListener,t,{value:this.eventListener[t],writable:!1})}const a=Object.getOwnPropertyNames(f.prototype);for(const e of a)"constructor"!==e&&"function"==typeof this[e]&&Object.defineProperty(this,e,{value:this[e].bind(this),writable:!1})}ping(){return r(this,void 0,void 0,(function*(){yield this.requestMethod("ping",[])}))}enable(e){return r(this,void 0,void 0,(function*(){yield this.requestMethod("enable",[e])}))}disable(e){return r(this,void 0,void 0,(function*(){yield this.requestMethod("disable",[e])}))}experimentalSuggestChain(e){var t,n;return r(this,void 0,void 0,(function*(){if(e.hideInUI)throw new Error("hideInUI is not allowed");((null===(t=e.features)||void 0===t?void 0:t.includes("stargate"))||(null===(n=e.features)||void 0===n?void 0:n.includes("no-legacy-stdTx")))&&console.warn("“stargate”, “no-legacy-stdTx” feature has been deprecated. The launchpad is no longer supported, thus works without the two features. We would keep the aforementioned two feature for a while, but the upcoming update would potentially cause errors. Remove the two feature."),yield this.requestMethod("experimentalSuggestChain",[e])}))}getKey(e){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("getKey",[e])}))}getKeysSettled(e){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("getKeysSettled",[e])}))}sendTx(e,t,n){return r(this,void 0,void 0,(function*(){return"length"in t||console.warn("Do not send legacy std tx via `sendTx` API. We now only support protobuf tx. The usage of legeacy std tx would throw an error in the near future."),yield this.requestMethod("sendTx",[e,t,n])}))}signAmino(e,t,n,o={}){var i;return r(this,void 0,void 0,(function*(){return yield this.requestMethod("signAmino",[e,t,n,(0,l.default)(null!==(i=this.defaultOptions.sign)&&void 0!==i?i:{},o)])}))}signDirect(e,t,n,o={}){var i;return r(this,void 0,void 0,(function*(){const r=yield this.requestMethod("signDirect",[e,t,{bodyBytes:n.bodyBytes,authInfoBytes:n.authInfoBytes,chainId:n.chainId,accountNumber:n.accountNumber?n.accountNumber.toString():null},(0,l.default)(null!==(i=this.defaultOptions.sign)&&void 0!==i?i:{},o)]),a=r.signed;return{signed:{bodyBytes:a.bodyBytes,authInfoBytes:a.authInfoBytes,chainId:a.chainId,accountNumber:u.default.fromString(a.accountNumber)},signature:r.signature}}))}signDirectAux(e,t,n,o={}){var i;return r(this,void 0,void 0,(function*(){const r=yield this.requestMethod("signDirectAux",[e,t,{bodyBytes:n.bodyBytes,publicKey:n.publicKey,chainId:n.chainId,accountNumber:n.accountNumber?n.accountNumber.toString():null,sequence:n.sequence?n.sequence.toString():null},(0,l.default)({preferNoSetMemo:null===(i=this.defaultOptions.sign)||void 0===i?void 0:i.preferNoSetMemo},o)]),a=r.signed;return{signed:{bodyBytes:a.bodyBytes,publicKey:a.publicKey||void 0,chainId:a.chainId,accountNumber:u.default.fromString(a.accountNumber),sequence:u.default.fromString(a.sequence)},signature:r.signature}}))}signArbitrary(e,t,n){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("signArbitrary",[e,t,n])}))}signICNSAdr36(e,t,n,r,o){return this.requestMethod("signICNSAdr36",[e,t,n,r,o])}verifyArbitrary(e,t,n,o){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("verifyArbitrary",[e,t,n,o])}))}signEthereum(e,t,n,o){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("signEthereum",[e,t,n,o])}))}getOfflineSigner(e,t){return new c.CosmJSOfflineSigner(e,this,t)}getOfflineSignerOnlyAmino(e,t){return new c.CosmJSOfflineSignerOnlyAmino(e,this,t)}getOfflineSignerAuto(e,t){return r(this,void 0,void 0,(function*(){return(yield this.getKey(e)).isNanoLedger?new c.CosmJSOfflineSignerOnlyAmino(e,this,t):new c.CosmJSOfflineSigner(e,this,t)}))}suggestToken(e,t,n){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("suggestToken",[e,t,n])}))}getSecret20ViewingKey(e,t){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("getSecret20ViewingKey",[e,t])}))}getEnigmaPubKey(e){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("getEnigmaPubKey",[e])}))}getEnigmaTxEncryptionKey(e,t){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("getEnigmaTxEncryptionKey",[e,t])}))}enigmaEncrypt(e,t,n){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("enigmaEncrypt",[e,t,n])}))}enigmaDecrypt(e,t,n){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("enigmaDecrypt",[e,t,n])}))}getEnigmaUtils(e){if(this.enigmaUtils.has(e))return this.enigmaUtils.get(e);const t=new s.KeplrEnigmaUtils(e,this);return this.enigmaUtils.set(e,t),t}experimentalSignEIP712CosmosTx_v0(e,t,n,o,i={}){var a;return r(this,void 0,void 0,(function*(){return yield this.requestMethod("experimentalSignEIP712CosmosTx_v0",[e,t,n,o,(0,l.default)(null!==(a=this.defaultOptions.sign)&&void 0!==a?a:{},i)])}))}getChainInfosWithoutEndpoints(){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("getChainInfosWithoutEndpoints",[])}))}getChainInfoWithoutEndpoints(e){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("getChainInfoWithoutEndpoints",[e])}))}__core__getAnalyticsId(){return this.requestMethod("__core__getAnalyticsId",[])}changeKeyRingName({defaultName:e,editable:t=!0}){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("changeKeyRingName",[{defaultName:e,editable:t}])}))}__core__privilageSignAminoWithdrawRewards(e,t,n){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("__core__privilageSignAminoWithdrawRewards",[e,t,n])}))}__core__privilageSignAminoDelegate(e,t,n){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("__core__privilageSignAminoDelegate",[e,t,n])}))}sendEthereumTx(e,t){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("sendEthereumTx",[e,t])}))}suggestERC20(e,t){return r(this,void 0,void 0,(function*(){return yield this.requestMethod("suggestERC20",[e,t])}))}}t.InjectedKeplr=f;class g extends h.default{constructor(e,t={addMessageListener:e=>window.addEventListener("message",e),removeMessageListener:e=>window.removeEventListener("message",e),postMessage:e=>window.postMessage(e,window.location.origin)},n,o){if(super(),this.injectedKeplr=e,this.eventListener=t,this.parseMessage=n,this.eip6963ProviderInfo=o,this.chainId=null,this.networkVersion=null,this.selectedAddress=null,this.isKeplr=!0,this.isMetaMask=!0,this._isConnected=!1,this._currentChainId=null,this._initProviderState(),window.addEventListener("keplr_keystorechange",(()=>r(this,void 0,void 0,(function*(){if(this._currentChainId&&(yield e.getChainInfoWithoutEndpoints(this._currentChainId))){const t=(yield e.getKey(this._currentChainId)).ethereumHexAddress;this._handleAccountsChanged(t)}})))),window.addEventListener("keplr_chainChanged",(e=>{if(e.detail.origin===window.location.origin){const t=e.detail.evmChainId;this._handleChainChanged(t)}})),window.addEventListener("keplr_ethSubscription",(e=>{var t;const n=e.detail.origin,r=e.detail.providerId;if(n===window.location.origin&&r===(null===(t=this.eip6963ProviderInfo)||void 0===t?void 0:t.uuid)){const t=e.detail.data;this.emit("message",{type:"eth_subscription",data:t})}})),this.eip6963ProviderInfo){const e=new CustomEvent(i.EIP6963EventNames.Announce,{detail:Object.freeze({info:this.eip6963ProviderInfo,provider:this})});window.addEventListener(i.EIP6963EventNames.Request,(()=>window.dispatchEvent(e))),window.dispatchEvent(e)}}_requestMethod(e,t){return r(this,void 0,void 0,(function*(){const n=new Uint8Array(8),r=Array.from(crypto.getRandomValues(n)).map((e=>e.toString(16))).join(""),o={type:"proxy-request",id:r,method:"ethereum",args:a.JSONUint8Array.wrap(t),ethereumProviderMethod:e};return new Promise(((e,t)=>{const n=o=>{const i=this.parseMessage?this.parseMessage(o.data):o.data;if(!i||"proxy-request-response"!==i.type)return;if(i.id!==r)return;this.eventListener.removeMessageListener(n);const s=a.JSONUint8Array.unwrap(i.result);if(s)if(s.error){const e=s.error;t(e.code&&!e.module?new a.EthereumProviderRpcError(e.code,e.message,e.data):new Error(e))}else e(s.return);else t(new Error("Result is null"))};this.eventListener.addMessageListener(n),this.eventListener.postMessage(o)}))}))}_initProviderState(){return r(this,void 0,void 0,(function*(){const e=yield this._requestMethod("request",{method:"keplr_initProviderState"});if(e){const{currentEvmChainId:t,currentChainId:n,selectedAddress:r}=e;null!=n&&null!=t&&null!=r&&(this._handleConnect(t),this._handleChainChanged(t),this._currentChainId=n,this._handleAccountsChanged(r))}}))}_handleConnect(e){return r(this,void 0,void 0,(function*(){if(!this._isConnected){this._isConnected=!0;const t=`0x${e.toString(16)}`;this.emit("connect",{chainId:t})}}))}_handleDisconnect(){return r(this,void 0,void 0,(function*(){this._isConnected&&(yield this._requestMethod("request",{method:"keplr_disconnect"}),this._isConnected=!1,this.chainId=null,this.selectedAddress=null,this.networkVersion=null,this.emit("disconnect"))}))}_handleChainChanged(e){return r(this,void 0,void 0,(function*(){const t=`0x${e.toString(16)}`;t!==this.chainId&&(this.chainId=t,this.networkVersion=e.toString(10),this.emit("chainChanged",t))}))}_handleAccountsChanged(e){return r(this,void 0,void 0,(function*(){this.selectedAddress!==e&&(this.selectedAddress=e,this.emit("accountsChanged",[e]))}))}isConnected(){return this._isConnected}request({method:e,params:t,chainId:n}){var o;return r(this,void 0,void 0,(function*(){return this._isConnected||(yield this._initProviderState()),"eth_accounts"===e?this.selectedAddress?[this.selectedAddress]:[]:yield this._requestMethod("request",{method:e,params:t,providerId:null===(o=this.eip6963ProviderInfo)||void 0===o?void 0:o.uuid,chainId:n})}))}enable(){return r(this,void 0,void 0,(function*(){return yield this.request({method:"eth_requestAccounts"})}))}net_version(){return r(this,void 0,void 0,(function*(){return yield this.request({method:"net_version"})}))}}},2948:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WEBPAGE_PORT=t.APP_PORT=t.BACKGROUND_PORT=void 0,t.BACKGROUND_PORT="background",t.APP_PORT="popup",t.WEBPAGE_PORT="webpage"},3366:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageRegistry=void 0,t.MessageRegistry=class{constructor(){this.registeredMsgType=new Map}registerMessage(e){if(this.registeredMsgType.has(e.type()))throw new Error(`Already registered type ${e.type()}`);this.registeredMsgType.set(e.type(),e)}parseMessage(e){if(!e.type)throw new Error("Null type");const t=this.registeredMsgType.get(e.type);if(!t)throw new Error(`Unregistered msg type ${e.type}`);return Object.setPrototypeOf(e.msg,t.prototype)}}},7328:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EthereumProviderRpcError=t.KeplrError=void 0;class n extends Error{constructor(e,t,r){super(r),this.module=e,this.code=t,Object.setPrototypeOf(this,n.prototype)}}t.KeplrError=n;class r extends Error{constructor(e,t,n){super(t),this.code=e,this.data=n,Object.setPrototypeOf(this,r.prototype)}}t.EthereumProviderRpcError=r},8582:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1947:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromHex=t.toHex=void 0,t.toHex=function(e){let t="";for(const n of e)t+=("0"+n.toString(16)).slice(-2);return t},t.fromHex=function(e){if(e.length%2!=0)throw new Error("hex string length must be a multiple of 2");const t=[];for(let n=0;n<e.length;n+=2){const r=e.substr(n,2);if(!r.match(/[0-9a-f]{2}/i))throw new Error("hex string contains invalid characters");t.push(parseInt(r,16))}return new Uint8Array(t)}},4202:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(1778),t),o(n(8582),t),o(n(7720),t),o(n(3271),t),o(n(7328),t),o(n(1549),t),o(n(2948),t),o(n(3366),t),o(n(6458),t),o(n(42),t)},7720:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1549:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Message=void 0,t.Message=class{approveExternal(e,t){return!1}}},1778:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;const o=n(3366),i=n(42);t.Router=class{constructor(e){this.envProducer=e,this.msgRegistry=new o.MessageRegistry,this.registeredHandler=new Map,this.guards=[],this.port="",this._isInitialized=!1}get isInitialized(){return this._isInitialized}registerMessage(e){this.msgRegistry.registerMessage(e)}addHandler(e,t){if(this.registeredHandler.has(e))throw new Error(`Already registered type ${e}`);this.registeredHandler.set(e,t)}addGuard(e){this.guards.push(e)}listen(e,t){return r(this,void 0,void 0,(function*(){if(this.port=e,this.attachHandler(),t){let e;this._initWaiter=new Promise((t=>{e=t})),yield t(),e()}this._isInitialized=!0}))}unlisten(){this.port="",this.detachHandler()}handleMessage(e,t){var n;return r(this,void 0,void 0,(function*(){this.isInitialized||(yield this._initWaiter);const r=this.msgRegistry.parseMessage(i.JSONUint8Array.unwrap(e)),o=this.envProducer(t,null!==(n=r.routerMeta)&&void 0!==n?n:{});for(const e of this.guards)yield e(o,r,t);r.validateBasic();const a=r.route();if(!a)throw new Error("Null router");const s=this.registeredHandler.get(a);if(!s)throw new Error("Can't get handler");return i.JSONUint8Array.wrap(yield s(o,r))}))}}},6458:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendSimpleMessage=t.SimpleMessage=void 0;const o=n(1549),i=Symbol(),a=Symbol();class s extends o.Message{constructor(e,t,n){super(),this[i]=e,this[a]=t;for(const e of Object.keys(n))this[e]=n[e]}route(){return this[i]}type(){return this[a]}validateBasic(){}approveExternal(){return!0}}t.SimpleMessage=s,t.sendSimpleMessage=function(e,t,n,o,i){return r(this,void 0,void 0,(function*(){return yield e.sendMessage(t,new s(n,o,i))}))}},3271:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},42:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONUint8Array=void 0;const r=n(1947);class o{static parse(e){return JSON.parse(e,((e,t)=>{if("__proto__"===e)throw new Error("__proto__ is disallowed");return t&&"string"==typeof t&&t.startsWith("__uint8array__")?(0,r.fromHex)(t.replace("__uint8array__","")):t}))}static stringify(e){return JSON.stringify(e,((e,t)=>{if("__proto__"===e)throw new Error("__proto__ is disallowed");if(t&&(t instanceof Uint8Array||"object"==typeof t&&"type"in t&&"data"in t&&"Buffer"===t.type&&Array.isArray(t.data))){const e=t instanceof Uint8Array?t:new Uint8Array(t.data);return`__uint8array__${(0,r.toHex)(e)}`}return t}))}static wrap(e){if(void 0!==e)return JSON.parse(o.stringify(e))}static unwrap(e){if(void 0!==e)return o.parse(JSON.stringify(e))}}t.JSONUint8Array=o},8927:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2633:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1324:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1327:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6233:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7259:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3145:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.EthTxStatus=t.EthSignType=void 0,(r=t.EthSignType||(t.EthSignType={})).MESSAGE="message",r.TRANSACTION="transaction",r.EIP712="eip-712",(n=t.EthTxStatus||(t.EthTxStatus={})).Success="0x1",n.Failure="0x0"},6382:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(7259),t),o(n(8927),t),o(n(2633),t),o(n(1324),t),o(n(9542),t),o(n(8636),t),o(n(3145),t),o(n(6233),t),o(n(1327),t),o(n(371),t),o(n(4251),t)},371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4251:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6322:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EIP6963EventNames=void 0,(n=t.EIP6963EventNames||(t.EIP6963EventNames={})).Announce="eip6963:announceProvider",n.Request="eip6963:requestProvider"},9542:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(2804),t),o(n(6322),t)},2804:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8636:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7526:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=s(e),a=i[0],c=i[1],l=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,c)),u=0,h=c>0?a-4:a;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[u++]=255&t),1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],a=16383,s=0,l=r-o;s<l;s+=a)i.push(c(e,s,s+a>l?l:s+a));return 1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),i.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=i[a],r[i.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,r){for(var o,i,a=[],s=t;s<r;s+=3)o=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(i=o)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},8287:(e,t,n)=>{"use strict";const r=n(7526),o=n(251),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50;const a=2147483647;function s(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return l(e,t,n)}function l(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|p(e,t);let r=s(n);const o=r.write(e,t);return o!==n&&(r=r.slice(0,o)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(J(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(J(e,ArrayBuffer)||e&&J(e.buffer,ArrayBuffer))return f(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(J(e,SharedArrayBuffer)||e&&J(e.buffer,SharedArrayBuffer)))return f(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return c.from(r,t,n);const o=function(e){if(c.isBuffer(e)){const t=0|g(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||Y(e.length)?s(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),s(e<0?0:0|g(e))}function d(e){const t=e.length<0?0:0|g(e.length),n=s(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function f(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,c.prototype),r}function g(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||J(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let o=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(o)return r?-1:z(e).length;t=(""+t).toLowerCase(),o=!0}}function m(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,n);case"utf8":case"utf-8":return q(this,t,n);case"ascii":return M(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return A(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Y(n=+n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:w(e,t,n,r,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,o){let i,a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){let r=-1;for(i=n;i<s;i++)if(l(e,i)===l(t,-1===r?0:i-r)){if(-1===r&&(r=i),i-r+1===c)return r*a}else-1!==r&&(i-=i-r),r=-1}else for(n+c>s&&(n=s-c),i=n;i>=0;i--){let n=!0;for(let r=0;r<c;r++)if(l(e,i+r)!==l(t,r)){n=!1;break}if(n)return i}return-1}function b(e,t,n,r){n=Number(n)||0;const o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;const i=t.length;let a;for(r>i/2&&(r=i/2),a=0;a<r;++a){const r=parseInt(t.substr(2*a,2),16);if(Y(r))return a;e[n+a]=r}return a}function P(e,t,n,r){return $(z(t,e.length-n),e,n,r)}function S(e,t,n,r){return $(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function k(e,t,n,r){return $(V(t),e,n,r)}function E(e,t,n,r){return $(function(e,t){let n,r,o;const i=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function A(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function q(e,t,n){n=Math.min(e.length,n);const r=[];let o=t;for(;o<n;){const t=e[o];let i=null,a=t>239?4:t>223?3:t>191?2:1;if(o+a<=n){let n,r,s,c;switch(a){case 1:t<128&&(i=t);break;case 2:n=e[o+1],128==(192&n)&&(c=(31&t)<<6|63&n,c>127&&(i=c));break;case 3:n=e[o+1],r=e[o+2],128==(192&n)&&128==(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:n=e[o+1],r=e[o+2],s=e[o+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&s,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,a=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),o+=a}return function(e){const t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=C));return n}(r)}t.kMaxLength=a,c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},c.allocUnsafe=function(e){return h(e)},c.allocUnsafeSlow=function(e){return h(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(J(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),J(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=c.allocUnsafe(t);let o=0;for(n=0;n<e.length;++n){let t=e[n];if(J(t,Uint8Array))o+t.length>r.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(r,o)):Uint8Array.prototype.set.call(r,t,o);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,o)}o+=t.length}return r},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)v(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?q(this,0,e):m.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(c.prototype[i]=c.prototype.inspect),c.prototype.compare=function(e,t,n,r,o){if(J(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;let i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0);const s=Math.min(i,a),l=this.slice(r,o),u=e.slice(t,n);for(let e=0;e<s;++e)if(l[e]!==u[e]){i=l[e],a=u[e];break}return i<a?-1:a<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return P(this,e,t,n);case"ascii":case"latin1":case"binary":return S(this,e,t,n);case"base64":return k(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const C=4096;function M(e,t,n){let r="";n=Math.min(e.length,n);for(let o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function I(e,t,n){let r="";n=Math.min(e.length,n);for(let o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function L(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let o="";for(let r=t;r<n;++r)o+=Q[e[r]];return o}function T(e,t,n){const r=e.slice(t,n);let o="";for(let e=0;e<r.length-1;e+=2)o+=String.fromCharCode(r[e]+256*r[e+1]);return o}function B(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,n,r,o,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function _(e,t,n,r,o){K(t,r,o,e,n,7);let i=Number(t&BigInt(4294967295));e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,n}function x(e,t,n,r,o){K(t,r,o,e,n,7);let i=Number(t&BigInt(4294967295));e[n+7]=i,i>>=8,e[n+6]=i,i>>=8,e[n+5]=i,i>>=8,e[n+4]=i;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=a,a>>=8,e[n+2]=a,a>>=8,e[n+1]=a,a>>=8,e[n]=a,n+8}function R(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(e,t,n,r,i){return t=+t,n>>>=0,i||R(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function j(e,t,n,r,i){return t=+t,n>>>=0,i||R(e,0,n,8),o.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,c.prototype),r},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||B(e,t,this.length);let r=this[e],o=1,i=0;for(;++i<t&&(o*=256);)r+=this[e+i]*o;return r},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||B(e,t,this.length);let r=this[e+--t],o=1;for(;t>0&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||B(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||B(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||B(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=Z((function(e){F(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,o=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(o)<<BigInt(32))})),c.prototype.readBigUInt64BE=Z((function(e){F(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],o=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(o)})),c.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||B(e,t,this.length);let r=this[e],o=1,i=0;for(;++i<t&&(o*=256);)r+=this[e+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||B(e,t,this.length);let r=t,o=1,i=this[e+--r];for(;r>0&&(o*=256);)i+=this[e+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return e>>>=0,t||B(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||B(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){e>>>=0,t||B(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=Z((function(e){F(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=Z((function(e){F(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||B(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||B(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||B(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||B(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||O(this,e,t,n,Math.pow(2,8*n)-1,0);let o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||O(this,e,t,n,Math.pow(2,8*n)-1,0);let o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=Z((function(e,t=0){return _(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Z((function(e,t=0){return x(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);O(this,e,t,n,r-1,-r)}let o=0,i=1,a=0;for(this[t]=255&e;++o<n&&(i*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/i|0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);O(this,e,t,n,r-1,-r)}let o=n-1,i=1,a=0;for(this[t+o]=255&e;--o>=0&&(i*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/i|0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=Z((function(e,t=0){return _(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Z((function(e,t=0){return x(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return j(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return j(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const o=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),o},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{const i=c.isBuffer(e)?e:c.from(e,r),a=i.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=i[o%a]}return this};const U={};function D(e,t,n){U[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function G(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function K(e,t,n,r,o,i){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let o;throw o=i>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(i+1)}${r}`:`>= -(2${r} ** ${8*(i+1)-1}${r}) and < 2 ** ${8*(i+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new U.ERR_OUT_OF_RANGE("value",o,e)}!function(e,t,n){F(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||W(t,e.length-(n+1))}(r,o,i)}function F(e,t){if("number"!=typeof e)throw new U.ERR_INVALID_ARG_TYPE(t,"number",e)}function W(e,t,n){if(Math.floor(e)!==e)throw F(e,n),new U.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new U.ERR_BUFFER_OUT_OF_BOUNDS;throw new U.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}D("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),D("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),D("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,o=n;return Number.isInteger(n)&&Math.abs(n)>2**32?o=G(String(n)):"bigint"==typeof n&&(o=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(o=G(o)),o+="n"),r+=` It must be ${t}. Received ${o}`,r}),RangeError);const H=/[^+/0-9A-Za-z-_]/g;function z(e,t){let n;t=t||1/0;const r=e.length;let o=null;const i=[];for(let a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function V(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function $(e,t,n,r){let o;for(o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function J(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const Q=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let o=0;o<16;++o)t[r+o]=e[n]+e[o]}return t}();function Z(e){return"undefined"==typeof BigInt?X:e}function X(){throw new Error("BigInt not supported")}},4744:e=>{"use strict";var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?s((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function i(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function a(e,t){try{return t in e}catch(e){return!1}}function s(e,n,c){(c=c||{}).arrayMerge=c.arrayMerge||o,c.isMergeableObject=c.isMergeableObject||t,c.cloneUnlessOtherwiseSpecified=r;var l=Array.isArray(n);return l===Array.isArray(e)?l?c.arrayMerge(e,n,c):function(e,t,n){var o={};return n.isMergeableObject(e)&&i(e).forEach((function(t){o[t]=r(e[t],n)})),i(t).forEach((function(i){(function(e,t){return a(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(a(e,i)&&n.isMergeableObject(t[i])?o[i]=function(e,t){if(!t.customMerge)return s;var n=t.customMerge(e);return"function"==typeof n?n:s}(i,n)(e[i],t[i],n):o[i]=r(t[i],n))})),o}(e,n,c):r(n,c)}s.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return s(e,n,t)}),{})};var c=s;e.exports=c},7007:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(n,r){function o(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}p(e,t,i,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&p(e,"error",t,{once:!0})}(e,o)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var o,i,a,l;if(s(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),a=i[t]),void 0===a)a=i[t]=n,++e._eventsCount;else if("function"==typeof a?a=i[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(o=c(e))>0&&a.length>o&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,l=u,console&&console.warn&&console.warn(l)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=u.bind(r);return o.listener=n,r.wrapFn=o,o}function d(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):g(o,o.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function p(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){r.once&&e.removeEventListener(t,o),n(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var l=c.length,u=g(c,l);for(n=0;n<l;++n)r(u[n],this,t)}return!0},i.prototype.addListener=function(e,t){return l(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return l(this,e,t,!0)},i.prototype.once=function(e,t){return s(t),this.on(e,h(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,h(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,r,o,i,a;if(s(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){a=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},i.prototype.listeners=function(e){return d(this,e,!0)},i.prototype.rawListeners=function(e){return d(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},i.prototype.listenerCount=f,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},251:(e,t)=>{t.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,c=(1<<s)-1,l=c>>1,u=-7,h=n?o-1:0,d=n?-1:1,f=e[t+h];for(h+=d,i=f&(1<<-u)-1,f>>=-u,u+=s;u>0;i=256*i+e[t+h],h+=d,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===i)i=1-l;else{if(i===c)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),i-=l}return(f?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,s,c,l=8*i-o-1,u=(1<<l)-1,h=u>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,g=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(a++,c/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(t*c-1)*Math.pow(2,o),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,o),a=0));o>=8;e[n+f]=255&s,f+=g,s/=256,o-=8);for(a=a<<o|s,l+=o;l>0;e[n+f]=255&a,f+=g,a/=256,l-=8);e[n+f-g]|=128*p}},8570:e=>{e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var o={},i={};function a(e,t){var n,r,a;return t?(a=0<=(e>>>=0)&&e<256)&&(r=i[e])?r:(n=c(e,(0|e)<0?-1:0,!0),a&&(i[e]=n),n):(a=-128<=(e|=0)&&e<128)&&(r=o[e])?r:(n=c(e,e<0?-1:0,!1),a&&(o[e]=n),n)}function s(e,t){if(isNaN(e))return t?v:m;if(t){if(e<0)return v;if(e>=f)return S}else{if(e<=-g)return k;if(e+1>=g)return P}return e<0?s(-e,t).neg():c(e%d|0,e/d|0,t)}function c(e,t,r){return new n(e,t,r)}n.fromInt=a,n.fromNumber=s,n.fromBits=c;var l=Math.pow;function u(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return m;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(e.substring(1),t,n).neg();for(var o=s(l(n,8)),i=m,a=0;a<e.length;a+=8){var c=Math.min(8,e.length-a),h=parseInt(e.substring(a,a+c),n);if(c<8){var d=s(l(n,c));i=i.mul(d).add(s(h))}else i=(i=i.mul(o)).add(s(h))}return i.unsigned=t,i}function h(e,t){return"number"==typeof e?s(e,t):"string"==typeof e?u(e,t):c(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}n.fromString=u,n.fromValue=h;var d=4294967296,f=d*d,g=f/2,p=a(1<<24),m=a(0);n.ZERO=m;var v=a(0,!0);n.UZERO=v;var y=a(1);n.ONE=y;var w=a(1,!0);n.UONE=w;var b=a(-1);n.NEG_ONE=b;var P=c(-1,2147483647,!1);n.MAX_VALUE=P;var S=c(-1,-1,!0);n.MAX_UNSIGNED_VALUE=S;var k=c(0,-2147483648,!1);n.MIN_VALUE=k;var E=n.prototype;E.toInt=function(){return this.unsigned?this.low>>>0:this.low},E.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},E.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(k)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=s(l(e,6),this.unsigned),i=this,a="";;){var c=i.div(o),u=(i.sub(c.mul(o)).toInt()>>>0).toString(e);if((i=c).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},E.getHighBits=function(){return this.high},E.getHighBitsUnsigned=function(){return this.high>>>0},E.getLowBits=function(){return this.low},E.getLowBitsUnsigned=function(){return this.low>>>0},E.getNumBitsAbs=function(){if(this.isNegative())return this.eq(k)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},E.isZero=function(){return 0===this.high&&0===this.low},E.eqz=E.isZero,E.isNegative=function(){return!this.unsigned&&this.high<0},E.isPositive=function(){return this.unsigned||this.high>=0},E.isOdd=function(){return!(1&~this.low)},E.isEven=function(){return!(1&this.low)},E.equals=function(e){return r(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},E.eq=E.equals,E.notEquals=function(e){return!this.eq(e)},E.neq=E.notEquals,E.ne=E.notEquals,E.lessThan=function(e){return this.comp(e)<0},E.lt=E.lessThan,E.lessThanOrEqual=function(e){return this.comp(e)<=0},E.lte=E.lessThanOrEqual,E.le=E.lessThanOrEqual,E.greaterThan=function(e){return this.comp(e)>0},E.gt=E.greaterThan,E.greaterThanOrEqual=function(e){return this.comp(e)>=0},E.gte=E.greaterThanOrEqual,E.ge=E.greaterThanOrEqual,E.compare=function(e){if(r(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},E.comp=E.compare,E.negate=function(){return!this.unsigned&&this.eq(k)?k:this.not().add(y)},E.neg=E.negate,E.add=function(e){r(e)||(e=h(e));var t=this.high>>>16,n=65535&this.high,o=this.low>>>16,i=65535&this.low,a=e.high>>>16,s=65535&e.high,l=e.low>>>16,u=0,d=0,f=0,g=0;return f+=(g+=i+(65535&e.low))>>>16,d+=(f+=o+l)>>>16,u+=(d+=n+s)>>>16,u+=t+a,c((f&=65535)<<16|(g&=65535),(u&=65535)<<16|(d&=65535),this.unsigned)},E.subtract=function(e){return r(e)||(e=h(e)),this.add(e.neg())},E.sub=E.subtract,E.multiply=function(e){if(this.isZero())return m;if(r(e)||(e=h(e)),t)return c(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return m;if(this.eq(k))return e.isOdd()?k:m;if(e.eq(k))return this.isOdd()?k:m;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(p)&&e.lt(p))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=65535&this.high,i=this.low>>>16,a=65535&this.low,l=e.high>>>16,u=65535&e.high,d=e.low>>>16,f=65535&e.low,g=0,v=0,y=0,w=0;return y+=(w+=a*f)>>>16,v+=(y+=i*f)>>>16,y&=65535,v+=(y+=a*d)>>>16,g+=(v+=o*f)>>>16,v&=65535,g+=(v+=i*d)>>>16,v&=65535,g+=(v+=a*u)>>>16,g+=n*f+o*d+i*u+a*l,c((y&=65535)<<16|(w&=65535),(g&=65535)<<16|(v&=65535),this.unsigned)},E.mul=E.multiply,E.divide=function(e){if(r(e)||(e=h(e)),e.isZero())throw Error("division by zero");var n,o,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:m;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return w;i=v}else{if(this.eq(k))return e.eq(y)||e.eq(b)?k:e.eq(k)?y:(n=this.shr(1).div(e).shl(1)).eq(m)?e.isNegative()?y:b:(o=this.sub(e.mul(n)),i=n.add(o.div(e)));if(e.eq(k))return this.unsigned?v:m;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=m}for(o=this;o.gte(e);){n=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(n)/Math.LN2),u=a<=48?1:l(2,a-48),d=s(n),f=d.mul(e);f.isNegative()||f.gt(o);)f=(d=s(n-=u,this.unsigned)).mul(e);d.isZero()&&(d=y),i=i.add(d),o=o.sub(f)}return i},E.div=E.divide,E.modulo=function(e){return r(e)||(e=h(e)),t?c((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},E.mod=E.modulo,E.rem=E.modulo,E.not=function(){return c(~this.low,~this.high,this.unsigned)},E.and=function(e){return r(e)||(e=h(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},E.or=function(e){return r(e)||(e=h(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},E.xor=function(e){return r(e)||(e=h(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},E.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},E.shl=E.shiftLeft,E.shiftRight=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},E.shr=E.shiftRight,E.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},E.shru=E.shiftRightUnsigned,E.shr_u=E.shiftRightUnsigned,E.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},E.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},E.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},E.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},E.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},2091:()=>{},63:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(){o=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var o=t&&t.prototype instanceof w?t:w,i=Object.create(o.prototype),s=new B(r||[]);return a(i,"_invoke",{value:M(e,n,s)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var g="suspendedStart",p="suspendedYield",m="executing",v="completed",y={};function w(){}function b(){}function P(){}var S={};h(S,c,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(O([])));E&&E!==n&&i.call(E,c)&&(S=E);var A=P.prototype=w.prototype=Object.create(S);function q(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(o,a,s,c){var l=f(e[o],e,a);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==r(h)&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}})}function M(t,n,r){var o=g;return function(i,a){if(o===m)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=I(s,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===g)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?v:p,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=v,r.method="throw",r.arg=l.arg)}}}function I(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,I(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function B(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function O(t){if(t||""===t){var n=t[c];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(i.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(r(t)+" is not iterable")}return b.prototype=P,a(A,"constructor",{value:P,configurable:!0}),a(P,"constructor",{value:b,configurable:!0}),b.displayName=h(P,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,P):(e.__proto__=P,h(e,u,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},q(C.prototype),h(C.prototype,l,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(d(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},q(A),h(A,u,"Generator"),h(A,c,(function(){return this})),h(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=O,B.prototype={constructor:B,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:O(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function i(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function a(){var e;return e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Keplr connect called! window being:",window,"window.keplr being",window.keplr),window.onload=function(){if(window.keplr){console.log("Keplr found"),window.keplr.enable("stargaze-1");var e=window.getOfflineSigner("stargaze-1").getAccounts();console.log("Connected wallet address:",e[0].address)}else console.log("Keplr extension not found!")};case 2:case"end":return e.stop()}}),e)})),a=function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,c,"next",e)}function c(e){i(a,r,o,s,c,"throw",e)}s(void 0)}))},a.apply(this,arguments)}n(2026),document.addEventListener("DOMContentLoaded",(function(){document.querySelector("#connectWalletButton").addEventListener("click",(function(){!function(){a.apply(this,arguments)}()}))}))},2115:(e,t,n)=>{"use strict";n.a(e,(async(e,r)=>{try{function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=f(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function h(e,t){return m(e)||p(e,t)||f(e,t)||d()}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}function m(e){if(Array.isArray(e))return e}function v(){v=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var i=t&&t.prototype instanceof w?t:w,a=Object.create(i.prototype),s=new B(r||[]);return o(a,"_invoke",{value:M(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",g="suspendedYield",p="executing",m="completed",y={};function w(){}function b(){}function P(){}var S={};u(S,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(O([])));E&&E!==n&&r.call(E,a)&&(S=E);var A=P.prototype=w.prototype=Object.create(S);function q(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(o,i,a,s){var c=d(e[o],e,i);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==l(h)&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(h).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function M(t,n,r){var o=f;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=I(s,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=p;var l=d(t,n,r);if("normal"===l.type){if(o=r.done?m:g,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=m,r.method="throw",r.arg=l.arg)}}}function I(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,I(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function B(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function O(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(l(t)+" is not iterable")}return b.prototype=P,o(A,"constructor",{value:P,configurable:!0}),o(P,"constructor",{value:b,configurable:!0}),b.displayName=u(P,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,P):(e.__proto__=P,u(e,c,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},q(C.prototype),u(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(h(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},q(A),u(A,c,"Generator"),u(A,a,(function(){return this})),u(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=O,B.prototype={constructor:B,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:O(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function y(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){y(i,r,o,a,s,"next",e)}function s(e){y(i,r,o,a,s,"throw",e)}a(void 0)}))}}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S(r.key),r)}}function P(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function S(e){var t=k(e,"string");return"symbol"==l(t)?t:t+""}function k(e,t){if("object"!=l(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){if(t&&("object"==l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return q(e)}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t)}function L(e,t){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},L(e,t)}var o;n.r(t),n.d(t,{default:()=>c});var i=["king","queen","rook","bishop","knight","pawn"],a=(await Promise.resolve().then(n.bind(n,3894))).default,s=function(e){function t(e,n,r,o,i,a,s){return E(this,t),c=this,u=[e,n,r,o,i,a,s],l=M(l=t),A(c,C()?Reflect.construct(l,u||[],M(c).constructor):l.apply(c,u));var c,l,u}return I(t,e),P(t)}(a);function T(){return B.apply(this,arguments)}function B(){return(B=w(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.chessPiece=s;case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var c=function(){return P((function e(t,n,r,o){E(this,e),this.chessPieces=[],this.squareElements=Array.from(document.querySelectorAll(".chess-square")),this.moveHistory=[],this.currentPlayer="white",this.gameStatus="active",this.game=o,console.log("this.Game",this.game),this.boardElement=document.getElementById("chessboard"),this.pieces=r,this.currentlySelectedPiece=null,this.initializeBoard=this.initializeBoard.bind(this),this.board=Array(8).fill(null).map((function(){return Array(8).fill(null)})),this.board.length=8,this.ChessPiece=n,this.initialize(),this.blackPieces=[],this.whitePieces=[],this.selectedPieceElement=null,this.movePiece=this.movePiece.bind(this)}),[{key:"initialize",value:(r=w(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.initializeBoard();case 3:return e.next=5,this.runChessGame();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to initialize the chess board:",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return r.apply(this,arguments)})},{key:"initializeBoard",value:(n=w(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("Current context (this.game):",this.game),console.log("Current context (this.game):",this.game),this.game){e.next=5;break}throw new Error("Game not initialized");case 5:return console.log("this.game:",this.game),console.log("this.chessGame:",this.chessGame),this.initializeEmptyBoard(),e.next=10,this.populateBoardWithPieces();case 10:T(),console.log("ExtendedPiece",s),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(0),console.error("Failed to initialize board:",e.t0),e.t0;case 18:case"end":return e.stop()}}),e,this,[[0,14]])}))),function(){return n.apply(this,arguments)})},{key:"populateBoardWithPieces",value:(t=w(v().mark((function e(){var t=this;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.pieces.forEach((function(e){var n=new a(e.type,e.color,e.row,e.col,e.imagePath,e.elementId,t.game);t.board[e.row][e.col]=n,t.chessPieces.push(n),document.getElementById("square-".concat(e.row,"-").concat(e.col)).innerHTML='<div class="chess-piece '.concat(e.color,"-").concat(e.type,'" style="background-image: url(\'').concat(e.imagePath,"')\"></div>")})),console.log("Board populated with pieces:",this.board);case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"initializeEmptyBoard",value:function(){this.game.board=Array.from({length:8},(function(){return Array(8).fill(null)}))}},{key:"runChessGame",value:(e=w(v().mark((function e(){var t,n,r,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.defineExtendedPiece(),e.next=4,this.initialize(o,this.pieces);case 4:t=e.sent,n=t.chessArray,r=t.chessBoard,i=t.chessGame,this.chessArray=n,this.chessBoard=r,this.chessGame=i,this.game=o,console.log("Chess game is running..."),console.log("chessArray:",this.chessArray),console.log("chessBoard:",this.chessBoard),console.log("chessGame:",this.chessGame),this.game.runChessGame(),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.error("Failed to run the chess game:",e.t0);case 22:case"end":return e.stop()}}),e,this,[[0,19]])}))),function(){return e.apply(this,arguments)})},{key:"registerPieceClickHandlers",value:function(){this.chessPieces.forEach((function(e){e.getDOMElement().addEventListener("click",(function(t){e.handleClick(t)}),{once:!0})}))}},{key:"setupInitialPosition",value:function(e,t,n,r){var o=this;e.forEach((function(e){var s=e.type,c=e.color,l=e.row,u=e.col,h=e.imagePath,d=e.elementId;if(!i.includes(s))throw new Error("Invalid piece type: ".concat(s));var f=new a(s,c,l,u,h,d,n);t.addPiece(f),o.board.push(f),r.addPiece(f);var g=document.getElementById(d);g.innerHTML='<div class="chess-piece '.concat(c,"-").concat(s,'"></div>'),g.classList.add("has-piece"),g.querySelector(".chess-piece").style.backgroundImage="url(".concat(h,")"),g.style.gridRow=l+1,g.style.gridColumn=u+1}))}},{key:"createPieceFromBoard",value:function(){var e=this;this.chessBoard.forEach((function(t,n){t.forEach((function(t,n){if(t){var r=e.createPiece(e.type,e.color,e.row,e.col,e.imagePath,e.elementId,e.game);e.addPiece(r)}}))}))}},{key:"createPiece",value:function(e,t,n,r,o,i,s){var c=new a(e,t,n,r,o,i,this.game);return this.chessPieces.push(c),this.placePieces(c),c}},{key:"placePieces",value:function(){var e=this;this.chessPieces.forEach((function(t){e.squareElements[t.position].innerHTML=t.html}))}},{key:"addPiece",value:function(e){this.chessPieces.push(e),console.log("adding piece to the array :",e),this.board[e.row][e.col]=e,console.log("updating board array :",this.board[e.row][e.col]);var t=document.createElement("img");t.src=e.imagePath,document.getElementById(e.elementId).appendChild(t)}},{key:"verifyPiecePlacement",value:function(){document.querySelectorAll(".chess-square").forEach((function(e){var t=e.firstElementChild;t?console.log("chessPieces: ".concat(t.dataset.chessPieces," placed in square with class/id: ").concat(e.className)):console.log("No piece placed in square with class/id: ".concat(e.className))}))}},{key:"setGame",value:function(e){this.game=e}},{key:"resetBoardColors",value:function(){for(var e=0;e<8;e++)for(var t=0;t<8;t++){var n=document.getElementById("square-".concat(t,"-").concat(e));n?(n.classList.remove("light","dark"),(e+t)%2==0?n.classList.add("dark"):n.classList.add("light")):console.error("Square at ".concat(t,"-").concat(e," not found."))}}},{key:"removePiece",value:function(e,t){var n=this.board[e][t];if(n){var r=this.chessPieces.indexOf(n);this.chessPieces.splice(r,1),this.squareElements[8*e+t].innerHTML="",this.chessBoard[e][t]=null}}},{key:"getPiece",value:function(e,t){return console.log("getPiece function called"),e<0||e>7||t<0||t>7?null:this.game.board[e][t]}},{key:"movePiece",value:function(e,t,n,r){if(console.log("Target Square:",e),console.log("Game:",t),console.log("Destination Element:",r),n=document.querySelector(".selected-piece"),console.log("Piece Element in movePiece:",n),console.log("Current context of this in movePiece:",this),console.log("game in in movePiece",t),console.log("game.game.board in movePiece",t.game.board),!this.validateMoveInputs(e,t,n,r))return!1;this.selectPiece(n);var o=this.getSquareCoords(e);if(console.log("targetCoords in movePiece :",o),!this.validateCoords(o,t))return!1;var i=this.getSelectedPieceElement(),a=this.selectedPieceParent;if(console.log("Parent element in movePiece :",a),console.log("selectedElement",i),!i)return console.log("Selected piece not found."),!1;if(!a)return console.log("Parent element not found."),!1;var s=this.getSquareCoords(a);if(!this.validateCoords(s))return console.log("false corords"),!1;if(e.classList.contains("valid-move")){console.log("validmove entered trying to call executemove"),this.executeMove(s,o,i,a,t),console.log("selectedElement.row",i.row);var c=this.getPiece(i.row,i.col);return console.log("chessPiece right after executeMovecalled in movepiece."),c?(console.log("trying to call postMoveActions"),c.postMoveActions(o)):console.error("ChessPiece instance not found for the selected element."),console.log("this context in removePiece before calling updateGameStateInMovePiece",this),this.updateGameStateInMovePiece(e,r,t),!0}return console.log("Invalid move attempted."),!1}},{key:"isPieceInRift",value:function(e,t){console.log("isPieceInRift function called");var n=t.getRiftArea();return console.log("Rift Area:",n),console.log("Target Coordinates:",e),n.some((function(t){var n=h(t,2),r=n[0],o=n[1];return console.log("Checking rift position: (".concat(r,", ").concat(o,") against target position: (").concat(e.row,", ").concat(e.col,")")),r===e.row&&o===e.col}))}},{key:"validateMoveInputs",value:function(e,t,n,r){return!!(e&&t&&n&&r)||(console.error("Invalid arguments.","targetSquare",e,"game",t,"pieceElement",n,"destinationElement",r),!1)}},{key:"getSquareCoords",value:function(e){return{row:parseInt(e.dataset.row,10),col:parseInt(e.dataset.col,10)}}},{key:"validateCoords",value:function(e){var t=e.row,n=e.col;return!!(t>=0&&t<8&&n>=0&&n<8)||(console.error("Invalid target row or column."),!1)}},{key:"selectPiece",value:function(e){console.log("pieceElement in selecPiece function :",e),e&&e instanceof Element?(this.selectedPieceElement=e,this.selectedPieceParent=e.parentNode,console.log("this.selectedPieceParent in selectPiece :",this.selectedPieceParent),e.classList.add("selected-piece")):console.error("Invalid piece element selected:",e)}},{key:"deselectPiece",value:function(){this.selectedPieceElement&&(this.selectedPieceElement.classList.remove("selected-piece"),this.selectedPieceElement=null)}},{key:"getSelectedPieceElement",value:function(){return this.selectedPieceElement}},{key:"executeMove",value:function(e,t,n,r,o){console.log("this context in executeMove in classBoard",this),console.log("game context in executeMove in classBoard",o),console.log("game.board in executeMove in classBoard",o.game.board),console.log("oldSquare in executeMove in classBoard",r);var i=e.row,a=e.col,s=t.row,c=t.col;o.game.board[i][a]=null,o.game.board[s][c]=this.currentlySelectedPiece;var l=document.querySelector("#square-".concat(s,"-").concat(c));console.log("newSquare in executeMove in classBoard",l),console.log("selectedElement in executeMove in classBoard",n),r.removeChild(n),l.appendChild(n),n.style.gridRow=s+1,n.style.gridColumn=c+1,n.classList.remove("selected-piece"),this.currentlySelectedPiece=null,this.resetBoardColors()}},{key:"createBoardElements",value:function(){this.squareElements=[];for(var e=0;e<8;e++){this.squareElements[e]=[];for(var t=0;t<8;t++)this.squareElements[e][t]=document.getElementById("".concat(e,"-").concat(t))}this.displayBoard()}},{key:"isCheck",value:function(e){var t=this,n=h("white"===e?[this.blackPieces,this.whiteKing]:[this.whitePieces,this.blackKing],2),r=n[0],o=n[1];return r.some((function(e){return e.calculateValidMoves(e.row,e.col,t.chessBoard).some((function(e){return e.row===o.row&&e.col===o.col}))}))}},{key:"isCheckmate",value:function(e){if(!this.isCheck(e))return!1;var t,n=u(this.getValidPieces(e));try{for(n.s();!(t=n.n()).done;){var r,o=t.value,i=u(o.calculateValidMoves(o.row,o.col,this.chessBoard));try{for(i.s();!(r=i.n()).done;){var a=h(r.value,2),s=a[0],c=a[1];if(!this.isBlocked(o.row,o.col,s,c))return!1}}catch(e){i.e(e)}finally{i.f()}}}catch(e){n.e(e)}finally{n.f()}return!0}},{key:"isDraw",value:function(){return 1===this.getNumWhitePieces()&&1===this.getNumBlackPieces()||2===this.getNumWhitePieces()&&2===this.getNumBlackPieces()&&1===this.getNumWhiteBishops()&&1===this.getNumBlackBishops()}},{key:"getNumBishops",value:function(e){return("white"===e?this.whitePieces:this.blackPieces).filter((function(e){return e instanceof Bishop})).length}},{key:"getNumPieces",value:function(e){return("white"===e?this.whitePieces:this.blackPieces).length}},{key:"generateBoardHTML",value:function(){for(var e="",t=0;t<this.numRows;t++)for(var n=0;n<this.numCols;n++){this.chessBoard[t][n];var r=this.getPieceAtPosition({row:t,col:n});r&&console.log("Generating piece HTML at (".concat(t,", ").concat(n,"):"),r);var o=r?r.generateHTML():"",i=(t+n)%2==0?"light":"dark",a="square-".concat(t,"-").concat(n);e+='<div id="'.concat(a,'" class="square ').concat(i,'">').concat(o,"</div>")}return e}},{key:"getPieceAtPosition",value:function(e,t){return this.chessPieces.find((function(n){return n.row===e&&n.col===t}))}},{key:"displayBoard",value:function(){var e=this.generateBoardHTML();this.boardElement?(console.log("Initial board state:",this.chessBoard),this.boardElement.innerHTML=e):console.error("Board element not found!",this.boardElement)}},{key:"endTurn",value:function(){this.isPlayerTurn=!this.isPlayerTurn,this.selectedPiece=null}},{key:"highlightLegalMoves",value:function(e,t){this.chessGame.getLegalMoves(e,t).forEach((function(e){document.getElementById("chess-square-".concat(e[0],"-").concat(e[1])).classList.add("highlight")}))}},{key:"removeHighlightFromAllSquares",value:function(){var e,t=u(document.querySelectorAll(".chess-square"));try{for(t.s();!(e=t.n()).done;)e.value.classList.remove("highlight")}catch(e){t.e(e)}finally{t.f()}}},{key:"updateSquareElements",value:function(e,t,n){this.squareElements.splice(e,1),this.squareElements.splice(t,0,n)}},{key:"updateGameState",value:function(e,t,n,r){console.log("updateGameState called"),console.log("Event:",e),console.log("Piece Element:",t),console.log("Destination Element:",n),console.log("Game:",r),this.moveHistory.push({piece:t?t.dataset.piece:null,from:{row:t?parseInt(t.dataset.row,10):null,col:t?parseInt(t.dataset.col,10):null},to:{row:parseInt(n.dataset.row,10),col:parseInt(n.dataset.col,10)},captured:n.querySelector(".chess-piece")?n.querySelector(".chess-piece").dataset.piece:null})}},{key:"announceWinner",value:function(){var e="Checkmate! ".concat(this.currentPlayer," wins!");alert(e)}},{key:"announceDraw",value:function(){alert("Stalemate. The game is a draw.")}},{key:"isBlocked",value:function(e,t,n,r){for(var o=n>e?1:n<e?-1:0,i=r>t?1:r<t?-1:0,a=e+o,s=t+i;a!=n||s!=r;a+=o,s+=i)if(this.board[a][s])return!0;return!1}}]);var e,t,n,r}();r()}catch(O){r(O)}}),1)},473:(e,t,n)=>{"use strict";function r(){r=function(){return t};var e,t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var o=t&&t.prototype instanceof w?t:w,a=Object.create(o.prototype),s=new B(r||[]);return i(a,"_invoke",{value:M(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var g="suspendedStart",p="suspendedYield",m="executing",v="completed",y={};function w(){}function b(){}function P(){}var S={};u(S,s,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(O([])));E&&E!==n&&o.call(E,s)&&(S=E);var A=P.prototype=w.prototype=Object.create(S);function q(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(r,i,a,s){var c=d(e[r],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==f(u)&&o.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var r;i(this,"_invoke",{value:function(e,o){function i(){return new t((function(t,r){n(e,o,t,r)}))}return r=r?r.then(i,i):i()}})}function M(t,n,r){var o=g;return function(i,a){if(o===m)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=I(s,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===g)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var l=d(t,n,r);if("normal"===l.type){if(o=r.done?v:p,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=v,r.method="throw",r.arg=l.arg)}}}function I(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,I(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function B(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function O(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function n(){for(;++r<t.length;)if(o.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(f(t)+" is not iterable")}return b.prototype=P,i(A,"constructor",{value:P,configurable:!0}),i(P,"constructor",{value:b,configurable:!0}),b.displayName=u(P,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,P):(e.__proto__=P,u(e,l,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},q(C.prototype),u(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(h(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},q(A),u(A,l,"Generator"),u(A,s,(function(){return this})),u(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=O,B.prototype={constructor:B,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:O(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t,n){return t=u(t),function(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,l()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(l=function(){return!!e})()}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function g(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}var p;n.r(t),n.d(t,{default:()=>m}),function(){var e,t=(e=r().mark((function e(){var t,o,a,l,u,d,g,v,y,w,b,P,S,k,E,A;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,3894));case 2:return t=e.sent,o=t.default,console.log(o),console.log(f(o)),e.next=8,Promise.resolve().then(n.bind(n,2115));case 8:return a=e.sent,l=a.default,console.log(l),console.log(f(l)),e.next=14,n.e(618).then(n.bind(n,7618));case 14:u=e.sent,d=u.default,console.log(d),console.log(f(d)),console.log("Classes imported successfully"),p=new d(m),g=new l(m),v=new m(p,g,void 0),window.chessPiece=function(e){function t(e,n,r,o,i,a,l){var u;return s(this,t),(u=c(this,t,[e,n,r,o,i,a,l])).forceMove=u.forceMove.bind(u),u}return h(t,e),i(t)}(o),window.chessGame=function(e){function t(e,n,r,o){return s(this,t),c(this,t,[e,n,r,o])}return h(t,e),i(t)}(m),y=o.type,w=o.color,b=o.row,P=o.col,S=o.imagePath,window.ChessPiece=o,k=new window.ChessPiece(y,w,b,P,S,"'square-".concat(b,"-").concat(P,"'"),v),E="'square-".concat(k.row,"-").concat(k.col,"'"),k.elementId=E,(A=document.getElementById(k.elementId)).innerHTML='<div class="chess-piece '.concat(k.color,"-").concat(k.type,'"></div>'),A.classList.add("has-piece"),A.style.gridRow=k.row+1,A.style.gridColumn=k.col+1,window.ChessBoard=l,window.ChessGame=m,window.ChessArray=d;case 41:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){g(i,r,o,a,s,"next",e)}function s(e){g(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}()().then((function(){console.log("Chess game initialized!")}));var m=function(){function e(t,n,r,o){var i,c,l,u,h,d=this;s(this,e),l=this,h=function(){console.log("Synchronizing board state..."),document.querySelectorAll(".chess-square").forEach((function(e){var t=parseInt(e.dataset.row,10),n=parseInt(e.dataset.col,10),r=e.querySelector(".chess-piece");if(r){var o=r.parentNode,i=o.getAttribute("data-type"),a=o.getAttribute("data-color");d.game.board[t][n]=new ChessPiece(i,a,t,n,d.imagePath,d.elementId,d.game,d.game.board)}else d.game.board[t][n]=null})),console.log("this.game.board state synchronized:",d.game.board)},(u=a(u="syncBoardState"))in l?Object.defineProperty(l,u,{value:h,enumerable:!0,configurable:!0,writable:!0}):l[u]=h,this.chessArray=t,this.chessBoard=n,this.board=Array(8).fill(null).map((function(){return Array(8).fill(null)})),this.pieces=(null===(i=this.chessArray)||void 0===i||null===(i=i.board)||void 0===i?void 0:i.pieces)||{},this.selectedPiece=null,this.whitePieces=[],this.blackPieces=[],this.whiteCaptured=[],this.blackCaptured=[],this.currentPlayer="white",this.squares=document.querySelectorAll(".chess-square"),this.checkGameStatus="ongoing",this.validMoves=[],this.game={board:this.board,pieces:(null===(c=this.chessArray)||void 0===c||null===(c=c.board)||void 0===c?void 0:c.pieces)||{},id:this.id,status:"ongoing",turn:this.player1Id},this.turnCount=0,this.turnDuration=60,this.currentTurnTimeLeft=this.turnDuration,this.turnTimer=null,this.updateTurnDisplay=this.updateTurnDisplay.bind(this),this.extraTimeLimit=300,this.extraTimer=null,this.extraWhiteTimeLeft=this.extraTimeLimit,this.extraBlackTimeLeft=this.extraTimeLimit,this.extraWhiteTimer=null,this.extraBlackTimer=null,this.handlePieceSelection=this.handlePieceSelection.bind(this),this.handleMove=this.handleMove.bind(this),this.handleSquareClick=this.handleSquareClick.bind(this),this.startTurnTimer(),e.instance=this}return i(e,[{key:"startTurn",value:function(){console.log("startTurn function entered in classGame"),this.currentTurnTimeLeft=this.turnDuration,this.updateTurnDisplay(),this.startTurnTimer()}},{key:"startTurnTimer",value:function(){var e=this;this.turnTimer&&clearInterval(this.turnTimer),this.turnTimer=setInterval((function(){e.currentTurnTimeLeft>0?(e.currentTurnTimeLeft--,e.updateTurnDisplay(),e.updateTurnDisplay()):e.endTurnMove()}),1e3)}},{key:"checkAndUpdateSpellEffects",value:function(){console.log("checkAndUpdateSpellEffects function entered in classPiece"),document.querySelectorAll(".chess-piece.pawn-random-move").forEach((function(e){var t=parseInt(e.dataset.spellExpirationTurn,10);t>0?e.dataset.spellExpirationTurn=t-1:(["forward","left","right","diagonalLeft","diagonalRight","pawn-random-move"].forEach((function(t){return e.classList.remove(t)})),delete e.dataset.spellExpirationTurn)}))}},{key:"updateTurnDisplay",value:function(){var e=document.getElementById("turn-timer");e&&(e.textContent="Time Left: ".concat(this.currentTurnTimeLeft," seconds"),0===this.currentTurnTimeLeft?e.classList.add("blinking"):e.classList.remove("blinking"))}},{key:"endTurnMove",value:function(){clearInterval(this.turnTimer);var e=this.currentPlayer;0===this.currentTurnTimeLeft?this.extraTimer||this.startExtraTimer(e):(console.log("instance before trying to call startTurnServ",instance),this.startTurn(),this.turnCount++,this.updateTurnCountDisplay(),console.log("this context in endturnMove",this),console.log("window.chessPiece",window.chessPiece),this.checkAndUpdateSpellEffects())}},{key:"startExtraTimer",value:function(e){var t=this;"white"===e?(this.extraWhiteTimer&&clearInterval(this.extraWhiteTimer),this.extraWhiteTimer=setInterval((function(){t.extraWhiteTimeLeft>0?(t.extraWhiteTimeLeft--,t.updateExtraTimerDisplay("white")):(clearInterval(t.extraWhiteTimer),t.endGame("White's time is up!"))}),1e3)):(this.extraBlackTimer&&clearInterval(this.extraBlackTimer),this.extraBlackTimer=setInterval((function(){t.extraBlackTimeLeft>0?(t.extraBlackTimeLeft--,t.updateExtraTimerDisplay("black")):(clearInterval(t.extraBlackTimer),t.endGame("Black's time is up!"))}),1e3))}},{key:"updateTurnCountDisplay",value:function(){var e=document.getElementById("turn-count-display");e&&(e.textContent="Turn: ".concat(this.turnCount))}},{key:"updateExtraTimerDisplay",value:function(e){var t="white"===e?document.getElementById("extra-white-timer-display"):document.getElementById("extra-black-timer-display");if(t){var n="white"===e?this.extraWhiteTimeLeft:this.extraBlackTimeLeft;t.textContent="Extra Time for ".concat("white"===e?"White":"Black"," Player: ").concat(n," seconds")}}},{key:"startTimer",value:function(e){var t,n=this,r=60*this.timeLimit;t=setInterval((function(){r--,n.updateClock(e,r),r<=0&&(clearInterval(t),n.endGame(e.opponent))}),1e3)}},{key:"updateGameState",value:function(e){e.sourcePiece;var t=e.targetPiece;t&&("white"===t.color?this.whiteCaptured.push(t):this.blackCaptured.push(t))}},{key:"changeTurn",value:function(){console.log("changeTurn function entered with this.currentPlayer  being :",this.currentPlayer),"white"===this.currentPlayer?(console.log("thiscurrent player being white checking:",this.currentPlayer),this.currentPlayer="black",console.log("thiscurrent player value after the change, normally black checking:",this.currentPlayer)):(console.log("tryig to change to white"),this.currentPlayer="white")}},{key:"handleMove",value:function(e,t,n){if(this.chessArray&&this.chessArray.board&&e){var r=e.row,o=e.col;if(this.chessArray.board.isValidMove(r,o,t,n)){var i=this.chessArray.board[r][o],a=this.chessArray.board[t][n];a&&("white"===a.color?this.whiteCaptured.push(a):this.blackCaptured.push(a)),this.chessArray.board[t][n]=i,this.chessArray.board[r][o]=null,document.getElementById("square-".concat(t,"-").concat(n)).appendChild(e.element),document.getElementById("square-".concat(r,"-").concat(o)).innerHTML="",this.timer+=60,this.currentPlayer="white"===this.currentPlayer?"black":"white",this.selectedPiece=null;var s="white"===this.currentPlayer;this.chessArray.board.isCheck(s)&&console.log("".concat(this.currentPlayer," is in check")),this.chessArray.board.isCheckmate(s)&&console.log("".concat(this.currentPlayer," wins by checkmate!"))}e&&e.element&&e.element.classList.remove("selected")}}},{key:"handlePieceSelection",value:function(e,t){if(this.board){var n=this.board[e][t];if(n&&n.color===this.currentPlayer)if(this.currentlySelectedPiece===n)this.currentlySelectedPiece=null,this.unhighlightSquares();else{this.currentlySelectedPiece=n;var r=this.currentlySelectedPiece.calculateValidMoves(e,t,this.board);this.highlightSquares(r)}}}},{key:"startNewGame",value:function(){this.checkGameOver()?alert("The game is already over. Please start a new game."):(this.pieceArray.createPieces(),this.pieceArray.addPiecesToBoard(),this.chessBoard=new ChessBoard,this.chessBoard.placePieces(),this.whiteTurn=!0,this.selectedPiece=null,this.legalMoves=[],this.currentPlayer="white")}},{key:"handleSquareClick",value:function(e){console.log("handleSquareClick called"),this.selectedPiece?this.legalMoves.includes(e)&&(e.appendChild(this.selectedPiece),this.selectedPiece=null,this.legalMoves=[],this.endTurn()):e.firstElementChild&&(e.classList.add("selected"),this.selectedPiece=e.firstElementChild,this.legalMoves=this.getLegalMoves(this.selectedPiece),this.legalMoves.forEach((function(e){e.classList.add("legal-move")})))}},{key:"getLegalMoves",value:function(e){for(var t=[],n=e.row,r=e.col,o=0;o<this.board.length;o++)for(var i=0;i<this.board[0].length;i++){var a=document.getElementById("square-".concat(o,"-").concat(i));this.isLegalMove(e,a)&&this.isClearPath(n,r,o,i)&&t.push([o,i])}return t}},{key:"highlightSquare",value:function(e){if(e.children.length>0){var t=e.children[0];(this.isWhiteTurn&&t.classList.contains("white")||!this.isWhiteTurn&&t.classList.contains("black"))&&(this.selectedPiece&&this.selectedPiece.classList.remove("highlight"),e.classList.add("highlight"),this.selectedPiece=e,console.log(chessPiece))}}},{key:"clearSelectedSquares",value:function(){document.querySelectorAll(".selected-piece").forEach((function(e){return e.classList.remove("selected-piece")}))}},{key:"isLegalMove",value:function(e,t){console.log("isLegalMove entered");var n=piece.type,r=piece.color;switch(console.log("pieceType in isLegalMove",n),console.log("pieceColor in isLegalMove",r),parseInt(e.row),parseInt(e.col),parseInt(t.getAttribute("data-row")),parseInt(t.getAttribute("data-col")),n){case"queen":return!(Math.abs(newSquareCoords[0]-currentSquareCoords[0])===Math.abs(newSquareCoords[1]-currentSquareCoords[1])&&!isClearPath(chessBoard,currentSquareCoords[0],currentSquareCoords[1],newSquareCoords[0],newSquareCoords[1])||!(newSquareCoords[0]!==currentSquareCoords[0]&&newSquareCoords[1]!==currentSquareCoords[1]||isClearPath(chessBoard,currentSquareCoords[0],currentSquareCoords[1],newSquareCoords[0],newSquareCoords[1])));case"rook":if((newSquareCoords[0]===currentSquareCoords[0]||newSquareCoords[1]===currentSquareCoords[1])&&!isClearPath(chessBoard,currentSquareCoords[0],currentSquareCoords[1],newSquareCoords[0],newSquareCoords[1]))return!1;break;case"bishop":return!(Math.abs(newSquareCoords[0]-currentSquareCoords[0])!==Math.abs(newSquareCoords[1]-currentSquareCoords[1])||!isClearPath(chessBoard,currentSquareCoords[0],currentSquareCoords[1],newSquareCoords[0],newSquareCoords[1]));case"knight":return 2===Math.abs(newSquareCoords[0]-currentSquareCoords[0])&&1===Math.abs(newSquareCoords[1]-currentSquareCoords[1])||1===Math.abs(newSquareCoords[0]-currentSquareCoords[0])&&2===Math.abs(newSquareCoords[1]-currentSquareCoords[1]);case"pawn":if("white"===r){if(newSquareCoords[0]===currentSquareCoords[0]-1){if(newSquareCoords[1]===currentSquareCoords[1]&&!getPieceOnSquare(t))return!0;if(1===Math.abs(newSquareCoords[1]-currentSquareCoords[1])){var o=getPieceOnSquare(t);if(o&&o.classList[1]!==r)return!0}}if(newSquareCoords[0]===currentSquareCoords[0]+1){if(newSquareCoords[1]===currentSquareCoords[1]&&!getPieceOnSquare(t))return!0;if(1===Math.abs(newSquareCoords[1]-currentSquareCoords[1])){var i=getPieceOnSquare(t);if(i&&i.classList[1]!==r)return!0}}if(newSquareCoords[0]===currentSquareCoords[0]+2&&newSquareCoords[1]===currentSquareCoords[1]&&!piece.hasMoved){var a=document.getElementById("square-".concat(currentSquareCoords[0]+1,"-").concat(currentSquareCoords[1]));if(!getPieceOnSquare(a))return!0}break}default:if(Math.abs(newSquareCoords[0]-currentSquareCoords[0])<=1&&Math.abs(newSquareCoords[1]-currentSquareCoords[1])<=1)return!0;if(newSquareCoords[1]===currentSquareCoords[1]+2&&!piece.hasMoved){var s=document.getElementById("square-".concat(currentSquareCoords[0],"-").concat(currentSquareCoords[1]+1)),c=document.getElementById("square-".concat(currentSquareCoords[0],"-").concat(currentSquareCoords[1]+3));if(getPieceOnSquare(s)||getPieceOnSquare(c))return!1;var l=getPieceOnSquare(c);return!(l&&l.hasMoved||isSquareInCheck(chessBoard,currentSquare)||isSquareInCheck(chessBoard,s)||isSquareInCheck(chessBoard,t))}if(newSquareCoords[1]===currentSquareCoords[1]-2&&!piece.hasMoved){var u=document.getElementById("square-".concat(currentSquareCoords[0],"-").concat(currentSquareCoords[1]-1)),h=document.getElementById("square-".concat(currentSquareCoords[0],"-").concat(currentSquareCoords[1]-4));if(getPieceOnSquare(u)||getPieceOnSquare(h))return!1;var d=getPieceOnSquare(h);return!(d&&d.hasMoved||isSquareInCheck(chessBoard,currentSquare)||isSquareInCheck(chessBoard,u)||isSquareInCheck(chessBoard,t))}}}},{key:"isPlayerTurn",value:function(e){var t=document.querySelectorAll(".chess-square");t.forEach((function(e){e.addEventListener("click",(function(n){if(n.target.firstElementChild)e.classList.add("highlighted"),isLegalMoves(e).forEach((function(e){e.classList.add("legal-move")}));else{if(!e.classList.contains("legal-move"))return;e.appendChild(),t.forEach((function(e){e.classList.remove("highlighted","legal-move")})),endTurn()}}))}))}},{key:"isClearPath",value:function(e,t,n,r,o){if(t===r||n===o){for(var i=Math.min(t,r),a=Math.max(t,r),s=i+1;s<a;s++)if(e[s][n])return!1}else{var c=Math.abs(r-t),l=Math.abs(o-n);if(c!==l)return!1;for(var u=(r-t)/c,h=(o-n)/l,d=t+u,f=n+h;d!==r&&f!==o;){if(e[d][f])return!1;d+=u,f+=h}}return!0}},{key:"getKing",value:function(e){for(var t=0;t<8;t++)for(var n=0;n<8;n++){var r=chessBoard.getBoard()[t][n];if(r&&"king"==r.type&&r.color==e)return r}}},{key:"checkGameOver",value:function(){return!(0!=getNumWhitePieces()&&0!=getNumBlackPieces()&&!isCheckmate("white")&&!isCheckmate("black")&&!isDraw()&&0!==this.extraTimeLeft)}},{key:"checkGameStatus",value:function(){if(this.chessBoard.isCheckmate())return this.gameStatus="checkmate",void this.chessBoard.announceWinner();this.gameStatus="ongoing"}}],[{key:"startTurnServ",value:function(t){console.log("startTurnServ function entered in classGame, instance being :",t),e.instance=new e,console.log("ChessGame",e),t.chessGame.endTurnMoveServ(t)}},{key:"startTurnTimerServ",value:function(e){console.log("startTurnTimerServ function entered, instance being : ",e),e.chessGame.endTurnMoveServ(e)}},{key:"checkAndUpdateSpellEffectsServ",value:function(e){console.log("checkAndUpdateSpellEffects function entered in classPiece"),document.querySelectorAll(".chess-piece.pawn-random-move").forEach((function(e){var t=parseInt(e.dataset.spellExpirationTurn,10);t>0?e.dataset.spellExpirationTurn=t-1:(["forward","left","right","diagonalLeft","diagonalRight","pawn-random-move"].forEach((function(t){return e.classList.remove(t)})),delete e.dataset.spellExpirationTurn)}))}},{key:"endTurnMoveServ",value:function(t){if(console.log("endTurnMoveServ function entered in classGame, instance being:",t),t)if(0===t.currentTurnTimeLeft)t.extraTimer||t.startExtraTimer(t.currentPlayer);else{console.log("instance before trying to call startTurnServ",t),t.turnCount++,e.updateTurnCountDisplayServ(t),console.log("window.chessPiece",window.chessPiece),console.log("instance before the updateTurnDIsplay call",t);var n=new window.chessGame(p,null,null,null);console.log("myChessGame",n),console.log("myTurn",myTurn,"turnCount",n.turnCount);var r=n.turnCount,o=n.currentPlayer;console.log("instanceTurnCount",r,"turnPlayer",o),n.changeTurn(),n.updateTurnDisplay(myTurn,r),console.log("turn player after changing turn",t.chessGame.instance.currentPlayer)}else console.error("Instance is undefined.")}},{key:"updateTurnCountDisplayServ",value:function(e){var t=document.getElementById("turn-count-display");t&&(t.textContent="Turn: ".concat(e.turnCount))}},{key:"updateTurnDisplayServ",value:function(e){var t=document.getElementById("turn-timer");t&&(t.textContent="Time Left: ".concat(e.currentTurnTimeLeft," seconds"),0===e.currentTurnTimeLeft?t.classList.add("blinking"):t.classList.remove("blinking"))}},{key:"updateExtraTimerDisplayServ",value:function(e,t){console.log("nstane  before trying to change player turn",e);var n="white"===t?document.getElementById("extra-white-timer-display"):document.getElementById("extra-black-timer-display");if(n){var r="white"===t?e.extraWhiteTimeLeft:e.extraBlackTimeLeft;n.textContent="Extra Time for ".concat("white"===t?"White":"Black"," Player: ").concat(r," seconds")}}}])}()},3894:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>P});var r=n(4577);n(8499);var o=new Map;function i(e){console.log("Attempting to retrieve game session with ID:",e);var t=o.get(e);return console.log("session being in the gameSession file :",t),t?console.log("Game session retrieved:",t):console.log("No game session found for ID:",e),t}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(){s=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof w?t:w,a=Object.create(i.prototype),s=new B(r||[]);return o(a,"_invoke",{value:M(e,n,s)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var g="suspendedStart",p="suspendedYield",m="executing",v="completed",y={};function w(){}function b(){}function P(){}var S={};h(S,c,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(O([])));E&&E!==n&&r.call(E,c)&&(S=E);var A=P.prototype=w.prototype=Object.create(S);function q(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(o,i,s,c){var l=f(e[o],e,i);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==a(h)&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,c)}))}c(l.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function M(t,n,r){var o=g;return function(i,a){if(o===m)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=I(s,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===g)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?v:p,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=v,r.method="throw",r.arg=l.arg)}}}function I(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,I(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function B(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function O(t){if(t||""===t){var n=t[c];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(a(t)+" is not iterable")}return b.prototype=P,o(A,"constructor",{value:P,configurable:!0}),o(P,"constructor",{value:b,configurable:!0}),b.displayName=h(P,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,P):(e.__proto__=P,h(e,u,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},q(C.prototype),h(C.prototype,l,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(d(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},q(A),h(A,u,"Generator"),h(A,c,(function(){return this})),h(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=O,B.prototype={constructor:B,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:O(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function c(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=h(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function h(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function g(e,t,n){return(t=p(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}function m(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){m(i,r,o,a,s,"next",e)}function s(e){m(i,r,o,a,s,"throw",e)}a(void 0)}))}}console.log("seededRNG",r.SeededRNG);function y(e,t,n){return w.apply(this,arguments)}function w(){return(w=v(s().mark((function e(t,n,r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("chessBoard in initializeChessPieces",r),t.forEach((function(e){var t=new P(e.type,e.color,e.row,e.col,e.imagePath,e.elementId,n,r);document.getElementById(t.elementId)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return b=v(s().mark((function e(){var t,r,o,i,c,l,u,h,d,f,g,p,m,v,w,b,P,S;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,3894));case 2:return t=e.sent,r=t.default,e.next=6,Promise.resolve().then(n.bind(n,2115));case 6:return o=e.sent,i=o.default,e.next=10,Promise.resolve().then(n.bind(n,473));case 10:return c=e.sent,l=c.default,e.next=14,n.e(618).then(n.bind(n,7618));case 14:for(u=e.sent,h=u.default,d=Promise.resolve().then(n.bind(n,4577)),console.log("seededRNG",d),f=new h,g=new i,console.log("chessBoard",g),g.initializeBoard(),g.populateBoardWithPieces(),p=new l(f,g,this),console.log("game"),y(m=[{type:"rook",color:"black",row:7,col:0,imagePath:"img/blackROOK.png",elementId:"square-7-0",game:p},{type:"knight",color:"black",row:7,col:1,imagePath:"img/blackKNIGHT.png",elementId:"square-7-1",game:p},{type:"bishop",color:"black",row:7,col:2,imagePath:"img/BlackBISHOP.png",elementId:"square-7-2",game:p},{type:"queen",color:"black",row:7,col:3,imagePath:"testNewImages/BlackQueen.png",elementId:"square-7-3",game:p},{type:"king",color:"black",row:7,col:4,imagePath:"images/blackKING.png",elementId:"square-7-4",game:p},{type:"bishop",color:"black",row:7,col:5,imagePath:"img/BlackBISHOP.png",elementId:"square-7-5",game:p},{type:"knight",color:"black",row:7,col:6,imagePath:"img/blackKNIGHT.png",elementId:"square-7-6",game:p},{type:"rook",color:"black",row:7,col:7,imagePath:"img/blackROOK.png",elementId:"square-7-7",game:p},{type:"pawn",color:"black",row:6,col:0,imagePath:"images/blackPAWN.png",elementId:"square-6-0",game:p},{type:"pawn",color:"black",row:6,col:1,imagePath:"images/blackPAWN.png",elementId:"square-6-1",game:p},{type:"pawn",color:"black",row:6,col:2,imagePath:"images/blackPAWN.png",elementId:"square-6-2",game:p},{type:"pawn",color:"black",row:6,col:3,imagePath:"images/blackPAWN.png",elementId:"square-6-3",game:p},{type:"pawn",color:"black",row:6,col:4,imagePath:"images/blackPAWN.png",elementId:"square-6-4",game:p},{type:"pawn",color:"black",row:6,col:5,imagePath:"images/blackPAWN.png",elementId:"square-6-5",game:p},{type:"pawn",color:"black",row:6,col:6,imagePath:"images/blackPAWN.png",elementId:"square-6-6",game:p},{type:"pawn",color:"black",row:6,col:7,imagePath:"images/blackPAWN.png",elementId:"square-6-7",game:p},{type:"rook",color:"white",row:0,col:0,imagePath:"img/whiteROOK.png",elementId:"square-0-0",game:p},{type:"knight",color:"white",row:0,col:1,imagePath:"img/whiteKNIGHT.png",elementId:"square-0-1",game:p},{type:"bishop",color:"white",row:0,col:2,imagePath:"img/whiteBISHOP.png",elementId:"square-0-2",game:p},{type:"queen",color:"white",row:0,col:3,imagePath:"images/whiteQUEEN.png",elementId:"square-0-3",game:p},{type:"king",color:"white",row:0,col:4,imagePath:"images/whiteKING.png",elementId:"square-0-4",game:p},{type:"bishop",color:"white",row:0,col:5,imagePath:"img/whiteBISHOP.png",elementId:"square-0-5",game:p},{type:"knight",color:"white",row:0,col:6,imagePath:"img/whiteKNIGHT.png",elementId:"square-0-6",game:p},{type:"rook",color:"white",row:0,col:7,imagePath:"img/whiteROOK.png",elementId:"square-0-7",game:p},{type:"pawn",color:"white",row:1,col:0,imagePath:"images/whitePAWN.png",elementId:"square-1-0",game:p},{type:"pawn",color:"white",row:1,col:1,imagePath:"images/whitePAWN.png",elementId:"square-1-1",game:p},{type:"pawn",color:"white",row:1,col:2,imagePath:"images/whitePAWN.png",elementId:"square-1-2",game:p},{type:"pawn",color:"white",row:1,col:3,imagePath:"images/whitePAWN.png",elementId:"square-1-3",game:p},{type:"pawn",color:"white",row:1,col:4,imagePath:"images/whitePAWN.png",elementId:"square-1-4",game:p},{type:"pawn",color:"white",row:1,col:5,imagePath:"images/whitePAWN.png",elementId:"square-1-5",game:p},{type:"pawn",color:"white",row:1,col:6,imagePath:"images/whitePAWN.png",elementId:"square-1-6",game:p},{type:"pawn",color:"white",row:1,col:7,imagePath:"images/whitePAWN.png",elementId:"square-1-7",game:p}],p,g),v=0,w=m;v<w.length;v++)P=new r((b=w[v]).type,b.color,b.row,b.col,b.imagePath,b.elementId,b.game,g),(S=document.getElementById(P.elementId)).innerHTML='<div class="chess-piece '.concat(P.color,"-").concat(P.type,'"></div>'),S.classList.add("has-piece"),S.querySelector(".chess-piece").style.backgroundImage="url(".concat(P.imagePath,")"),S.style.gridRow=P.row+1,S.style.gridColumn=P.col+1,p.board[b.row][b.col]=P,S.classList.contains("event-listener-attached")||(P.element.addEventListener("click",P.boundHandleClick),S.classList.add("event-listener-attached"),console.log("Event listener attached to: ".concat(P.elementId)));console.log(a(i)),console.log("ChessBoard in classPiiece",i),console.log(a(l)),console.log(l),console.log(a(h)),console.log(h),console.log("Classes imported successfully");case 35:case"end":return e.stop()}}),e,this)}))),b.apply(this,arguments)}Array(8).fill().map((function(){return Array(8).fill(null)})),function(){return b.apply(this,arguments)}().then((function(){console.log("Pieces have been initialized and instances have been created.")}));var P=function(){function e(t,n,r,o,i,a,s,c){var l=this;switch(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),g(this,"handleClick",(function(e,t,n){document.querySelectorAll(".chess-piece.selected-piece").forEach((function(e){e.removeEventListener("click",l.handleClick),e.addEventListener("click",l.handleClick)}));var r=e.target.closest(".chess-square");if(r){var o=r.querySelector(".chess-piece");if(o){if(console.log("myTurn",myTurn),!myTurn)return l.showAlert("Wrong Turn. Wait a bit for the opponent to finish."),void setTimeout((function(){r.classList.add("shake-red")}),500);console.log("this.game.board in handleclick before syncBoardState",l.game.board),l.game.syncBoardState(),console.log("Active Spells in handleclick:",l.activeSpells);var i=parseInt(r.getAttribute("data-row"),10),a=parseInt(r.getAttribute("data-col"),10);if(console.log("this.validPiecesToResolveCheck",l.validPiecesToResolveCheck),console.log("pieceRow",i,"pieceCol",a),l.validPiecesToResolveCheck.length>0){var s=l.validPiecesToResolveCheck.some((function(e){var t=e.row===i,n=e.col===a;return console.log("Checking valid piece at row ".concat(e.row,", col ").concat(e.col,": Row match = ").concat(t,", Col match = ").concat(n)),t&&n}));if(console.log("isValidPiece for the check",s),!s)return l.showAlert("King is in check and this piece cannot resolve it."),r.classList.add("shake-red"),void console.log("This piece cannot resolve the check, so it's not selectable.")}var c=myTurn?"white":"black";if(console.log("currentPlayerColor",c),!l.isSpecialMoveActive&&!l.isSpellActive){var u=o?l.getPieceFromElement(o):null;console.log("trying to select piece : ",u),console.log("this.type",l.type);var h=l.type,d=l.color;console.log("check before selecting piece thistype being ",h,"this.color being",d,"playerColor",c);var f=o.classList.contains("".concat(d,"-").concat(h)),g=o.classList.contains("selected-piece");if(r.getAttribute("data-type"),console.log("isAlliedPiece",f,"isSelected",g),f&&!g){console.log("piece is allied, not selected and of the correct color, trying to selectit."),console.log("currentPlayerColor",d,"thistype",h);var p=document.querySelectorAll(".".concat(d,"-pawn.selected-piece, .").concat(d,"-knight.selected-piece, .").concat(d,"-bishop.selected-piece, .").concat(d,"-rook.selected-piece, .").concat(d,"-queen.selected-piece, .").concat(d,"-king.selected-piece"));console.log("alliedSelectedPieces",p),p.forEach((function(e){return e.classList.remove("selected-piece")})),console.log("clickedPieceElement value before trying to addd selectedPiece to it.",o),o.classList.add("selected-piece")}if(l.selectedPiece=u,o.classList.contains("frozen-piece")||r.classList.contains("frozen-square"))console.log("This piece is frozen and cannot move.");else{if(console.log("this.selectedPiece",l.selectedPiece,"this.clickedPieceElement",l.clickedPieceElement),l.selectedPiece&&o&&o.color===(d?"black":"white"))return r.classList.contains("valid-move")?(console.log("CHECK FOR MOVEMADE "),void l.executeMove(n.board,r,t)):(alert("Invalid move!"),void l.deselectAndClear());if(l.selectedPiece&&r.classList.contains("valid-move")){console.log("trying to executeMove fnution in handlelick:"),console.log("clickedSquareElement passed :",r),l.executeMove(n.board,r,t),console.log("selectedElement.row",selectedElement.row);var m=l.getPiece(selectedElement.row,selectedElement.col);return console.log("chessPiece right after executeMovecalled in movepiece."),m?(console.log("trying to call postMoveActions"),m.postMoveActions(targetCoords)):console.error("ChessPiece instance not found for the selected element."),console.log("this context in removePiece before calling updateGameStateInMovePiece",l),void l.updateGameStateInMovePiece(targetSquare,destinationElement,n)}u?(console.log("handling new selection"),l.selectNewPiece(u,o,t,n)):l.deselectAndClear()}}}}})),g(this,"syncBoardState",(function(){console.log("Synchronizing board state..."),document.querySelectorAll(".chess-square").forEach((function(t){var n=parseInt(t.dataset.row,10),r=parseInt(t.dataset.col,10),o=t.querySelector(".chess-piece");if(o){var i=o.parentNode,a=i.getAttribute("data-type"),s=i.getAttribute("data-color");l.game.game.board[n][r]=new e(a,s,n,r,l.imagePath,l.elementId,l.game,l.game.board)}else l.game.game.board[n][r]=null})),console.log("this.game.board state synchronized:",l.game.board)})),this.type=t,t){case"pawn":console.log("Pawn created");break;case"rook":console.log("Rook created");break;case"knight":console.log("Knight created");break;case"bishop":console.log("Bishop created");break;case"queen":console.log("Queen created");break;case"king":console.log("King created");break;case"FirePawn":console.log("FirePawn created");break;case"WaterPawn":console.log("WaterPawn created");break;case"AirPawn":console.log("AirPawn created");break;case"LightPawn":console.log("LightPawn created");break;default:throw new Error("Invalid piece type")}this.initObserver(),this.validPiecesToResolveCheck=[],this.threateningPath=[],this.board=c,console.log("this.board in chessPiece constructor",this.board),this.color=n,this.gameSession=e.gameSession,console.log("Constructor color:",this.color),this.row=r,this.col=o,this.imagePath=i;var u="square-".concat(this.row,"-").concat(this.col);this.elementId=a||u,this.isChaosTheoryActive=!1,this.hasMovedDueToRift=!1,this.isPawnPlacementActive=!1,this.isSpecialMoveActive=!1,this.isSpellActive=!1,this.pieceSwapped=!0,this.riftSpellDuration=0,this.setupMoveListener(),this.activeSpells=[],this.game=s,this.selectedSquare=null,this.prevTarget=null,this.validMoves=[],this.selectedPiece=null,this.currentPlayer=s.currentPlayer,this.currentPlayerColor=this.currentPlayerColor,this.highlightedSquares=[],this.boundHandleClick=this.handleClick.bind(this),this.handleHover=this.handleHover.bind(this),this.boundHandleSelection=this.handleSelection.bind(this),this.castAdeptWandSpell=this.castAdeptWandSpell.bind(this),this.activeClickListeners={},this.element=document.getElementById(this.elementId),this.capturedPieces=[],this.element.setAttribute("data-type",t),this.element.setAttribute("data-color",n),this.element.style.backgroundImage="url('".concat(i,"')"),this.executeMove=this.executeMove.bind(this),this.updateGameStateInMovePiece=this.updateGameStateInMovePiece.bind(this),this.castDigitzKingSpell=this.castDigitzKingSpell.bind(this),this.miniBoards={topLeft:this.createEmptyMiniBoard(),topRight:this.createEmptyMiniBoard(),bottomLeft:this.createEmptyMiniBoard(),bottomRight:this.createEmptyMiniBoard()},this.isFinalStandActive=!1,this.miniBoardArea={x1:4,y1:4,x2:7,y2:7},this.finalStandTurnCount=0,this.finalStandScore={white:0,black:0},this.pointThreshold=5,this.isRealityShattered=!1,this.spellDeck=["staff-of-fire","staff-of-water","staff-of-air","staff-of-light","staff-of-earth","ice","novice-staff","iced-out","apprentice-wand","apprentice-staff","lightsaber","hourglass","staff-of-chaos","staff-of-the-necromancer","orbs-of-illusion","adept-wand","novice-staff","arcane-hands","spoon","excalibur","magician-wand","trident","reaper-scythe","rebel-sword","wooden-staff","broomstick","celestial-staff","cybermancer-staff","stick-of-the-forest","grand-master-staff","samba"],this.isWindOfChangeActive=!1,this.movesLeftWithSpell=0,this.directions=["forward","left","right","diagonalLeft","diagonalRight"],this.currentDirection="forward",this.isMiniGameActive=!1,this.miniGameScore=0,this.pointThreshold=5,this.miniGameMoveCount=0,this.towers=[],this.towerOfPowerActivated=!1,this.chaosTheoryStartEvent=new Event("chaosTheoryStart"),this.chaosTheoryEndEvent=new Event("chaosTheoryEnd"),document.addEventListener("chaosTheoryStart",(function(){l.isChaosTheoryActive=!0})),document.addEventListener("chaosTheoryEnd",(function(){l.isChaosTheoryActive=!1})),this.element.classList.contains("event-listener-attached")?console.error("Event listener already attached to: ".concat(this.element)):(this.element.addEventListener("click",this.boundHandleClick,{once:!0}),this.element.dataset.listenerAttached="true",console.log("Adding event listener to:",this.element)),a&&console.log("Type:",t,"color:",n,"! row,col: ",r,o,"imagePath: ",i,"elementId :",a,"game",s),window.addEventListener("updateValidPiecesToResolveCheck",(function(e){console.log("Received valid pieces to resolve check:",e.detail),l.validPiecesToResolveCheck=e.detail.validPiecesToResolveCheck,l.threateningPath=e.detail.threateningPath})),window.addEventListener("resetValidPiecesToResolveCheck",(function(){console.log("Resetting validPiecesToResolveCheck array."),l.validPiecesToResolveCheck=[],l.threateningPath=[]}))}return t=e,n=[{key:"setupMoveListener",value:function(){var e=this;console.log("setupMoveListener function entered"),document.addEventListener("moveReceived",(function(t){console.log("move received trying to call applymove function");var n=t.detail,r=(n.piece,n.from),o=n.to;e.applyMove(r,o)}))}},{key:"applyMove",value:function(e,t){console.log("applyMove function entered in classPiece from being :",e,"to being:",t),this.getPosition(e)&&this.forceMove(t)}},{key:"showNotification",value:function(e,t,n,r){var o=window.spellDetail(e,t,n,r);if(o){var i=document.getElementById("game-ui");if(i){var a=e.toLowerCase().replace(/\s+/g,"-"),s=document.createElement("div");s.className="notification-box",s.id="".concat(a,"-notification"),s.innerHTML="<p><strong>".concat(e,"</strong>: ").concat(o.description," (").concat(o.duration," turns left)</p>"),i.appendChild(s)}else console.error("Game UI not found")}else console.error("Failed to retrieve spell details for:",e)}},{key:"updateNotification",value:function(e,t){var n=e.toLowerCase().replace(/\s+/g,"-"),r=document.getElementById("".concat(n,"-notification")),o=document.getElementById("".concat(n,"-turns-left"));o&&r&&(o.textContent="".concat(t," turns left"),t<=0&&r.remove())}},{key:"removeNotification",value:function(e){var t=e.toLowerCase().replace(/\s+/g,"-"),n=document.getElementById("".concat(t,"-notification"));n&&n.remove()}},{key:"createChessPieces",value:function(){document.createElement("div"),document.createElement("div"),document.createElement("div"),document.createElement("div"),document.createElement("div"),document.createElement("div");for(var t={whitePawns:[],blackPawns:[],whiteRooks:[],blackRooks:[],whiteKnights:[],blackKnights:[],whiteBishops:[],blackBishops:[],whiteQueen:[],blackQueen:[],whiteKing:[],blackKing:[]},n=0;n<8;n++){var r=new e("pawn","white",1,n,"./images/whitePAWN.png","pawn_1_".concat(n),this);t.whitePawns.push(r),this.addChessPiece("pawn","white",1,n,"./images/whitePAWN.png","pawn_1_".concat(n),this),console.log("White pawn added to board")}for(var o=0;o<8;o++){var i=new e("pawn","black",6,o,"./images/blackPAWN.png","pawn_6_".concat(o),this);t.blackPawns.push(i),this.addChessPiece(i)}var a=new e("rook","white",0,0,"./images/whiteROOK.png","rook_0_0",this.game),s=new e("rook","white",0,7,"./images/whiteROOK.png","rook_0_7",this);t.whiteRooks.push(a,s),this.addChessPiece(a,s);var c=new e("rook","black",7,0,"./images/blackROOK.png","rook_7_0",this),l=new e("rook","black",7,7,"./images/blackROOK.png","rook_7_7",this);t.blackRooks.push(c,l),this.addChessPiece(c,l);var u=new e("knight","white",0,1,"./images/whiteKNIGHT.png","knight_0_1",this),h=new e("knight","white",0,6,"./images/whiteKNIGHT.png","knight_0_6",this);t.whiteKnights.push(u,h),this.addChessPiece(u,h);var d=new e("knight","black",7,1,"./images/blackKNIGHT.png","knight_7_1",this),f=new e("knight","black",7,6,"./images/blackKNIGHT.png","knight_7_6",this);t.blackKnights.push(d,f),this.addChessPiece(d,f);var g=new e("bishop","black",7,2,"./images/blackBishop.png","bishop_7_2",this),p=new e("bishop","black",7,5,"./images/blackBishop.png","bishop_7_5",this);t.blackBishops.push(g,p),this.addChessPiece(g,p);var m=new e("bishop","white",0,2,"./images/whiteBISHOP.png","bishop_0_2",this),v=new e("bishop","white",0,5,"./images/whiteBISHOP.png","bishop_0_5",this);t.whiteBishops.push(m,v),this.addChessPiece(m,v);var y=new e("queen","black",7,3,"./testNewImages/BlackQUeenRevisited.png","queen_7_3",this);t.blackQueen.push(y),this.addChessPiece(y);var w=new e("king","black",7,4,"./images/blackKING.png","king_7_4",this);t.blackKing.push(w),this.addChessPiece(w);var b=new e("queen","white",0,3,"./images/whiteQUEEN.png","queen_0_3",this);t.whiteQueen.push(b),this.addChessPiece(b);var P=new e("king","white",0,4,"./images/whiteKING.png","king_0_4",this);t.whiteKing.push(P),this.addChessPiece(P)}},{key:"initSquares",value:function(e,t){console.log("Initial board argument:",JSON.stringify(e,null,2)),console.log("Initial game argument:",JSON.stringify(t,null,2));for(var n=0;n<8;n++)for(var r=0;r<8;r++){var o=e[n][r];console.log("Processing square at row: ".concat(n,", col: ").concat(r,", value: ").concat(o)),o?(this.squares.push(o),t.board[n][r]=o.querySelector(".chess-piece")):t.board[n][r]=null}console.log("Final state of this.squares:",JSON.stringify(this.squares,null,2)),console.log("Final state of game.board:",JSON.stringify(t.board,null,2))}},{key:"isSpellActive",value:function(){return this.isSpellActive}},{key:"handleBoardClick",value:function(e){var t=e.target,n=t.classList.contains("chess-piece"),r=n?t.closest(".chess-square"):t;n?selectPiece(t):r.classList.contains("chess-square")&&moveToSquare(r)}},{key:"selectPiece",value:function(e){var t=document.querySelector(".selected");t&&t.classList.remove("selected"),e.classList.add("selected")}},{key:"moveToSquare",value:function(e){var t=document.querySelector(".selected");t&&isValidMove(t,e)&&(movePiece(t,e),t.classList.remove("selected"))}},{key:"showAlert",value:function(e){console.log("showAlrt function entered, message being :",e);var t=document.getElementById("game-message");t.textContent=e,t.classList.add("show"),setTimeout((function(){t.classList.remove("show")}),2e3)}},{key:"shouldDeselect",value:function(e,t,n){console.log("shouldDeselect function entenred");var r=this.selectedPiece.element===n,o=e&&e.color===this.selectedPiece.color,i=!t.classList.contains("valid-move");return r||o||i}},{key:"extractPieceInfo",value:function(e){var t=e.className.split(" ").find((function(e){return e.includes("-")}));return t?t.split("-"):[null,null]}},{key:"deselectAndClear",value:function(){console.log("deselectAndClear function entered, selectedPiece being:",this.selectedPiece),this.selectedPiece&&(this.selectedPiece.element&&this.selectedPiece.element.classList?(console.log("Deselecting piece with element property:",this.selectedPiece),this.selectedPiece.element.classList.remove("selected-piece")):this.selectedPiece.classList?(console.log("Deselecting piece directly:",this.selectedPiece),this.selectedPiece.classList.remove("selected-piece")):console.log("selectedPiece does not have a classList to modify:",this.selectedPiece),this.clearValidMoves(),this.selectedPiece=null)}},{key:"initChessBoard",value:function(){console.log("initChessBoard function called"),document.querySelector(".chess-board").addEventListener("click",this.handleBoardClick.bind(this))}},{key:"executeMove",value:function(e,t,n,r){var o=this,a=document.querySelector(".selected-piece"),s=a.parentNode,c=s.getAttribute("data-type"),l=s.getAttribute("data-color");if(console.log("oldPiece",a),console.log("Chaos Theory activated for ".concat(this.chaosTheoryTurnsLeft," turns.")),this.hasMovedDueToRift)return console.log("Piece already moved by rift effect, skipping normal move logic."),void(this.hasMovedDueToRift=!1);a.classList.contains("petrified")&&(this.clearPetrification(a),console.log("attempt to propagate petrification for oldColor :",l),this.attemptToTransferPetrification(l)),this.updatePetrifiedPieces(),parseInt(t.getAttribute("data-row"),10),parseInt(t.getAttribute("data-col"),10);var u=parseInt(s.getAttribute("data-row"),10),h=parseInt(s.getAttribute("data-col"),10);console.log("OLD ROW IN EECUTEMOVE",u,"OLD COL N EECUTEMOVE",h);var d=parseInt(t.getAttribute("data-row"),10),f=parseInt(t.getAttribute("data-col"),10),g=document.getElementById("square-".concat(d,"-").concat(f));function p(e,t){return String.fromCharCode("a".charCodeAt(0)+t)+e.toString()}this.game.game.board[d][f],console.log("destinationElement",g);var m=p(u,h),v=p(d,f);console.log("game.board",this.game.game.board);var y=function(e,t,n,r){var o=e[t][n];return o&&o.color!==r}(this.game.game.board,d,f,l);console.log("piece",a,"fromPosition sending the to the serv",m,"toPosition sending to the serv",v);var w=new CustomEvent("pieceMoved",{detail:{color:l,type:c,capture:y,from:{row:u,col:h},to:{row:d,col:f}}});console.log("trying to emit the move to the socket");var b=i;if(console.log(b),socket.emit("move",{color:l,type:c,capture:y,from:{row:u,col:h},to:{row:d,col:f}}),myTurn=!myTurn,console.log("trying to send move to the server :",w),g.classList.contains("hole-square"))return this.forceRandomMove(a,n,event,this.excludeMiniBoardArea=!1),this.game.endTurnMove(),this.game.startTurn(),void(this.game.currentPlayer="white"===this.game.currentPlayer?"black":"white");if(g.classList.contains("magma-square"))return this.forceRemove(u,h),this.game.endTurnMove(),this.game.currentPlayer="white"===this.game.currentPlayer?"black":"white",void this.game.startTurn();if(!g.classList.contains("rock-square")){var P=this.game.game.board[this.selectedPiece.row][this.selectedPiece.col];this.game.board[d][f]=P,this.game.board[this.selectedPiece.row][this.selectedPiece.col]=null,console.log("Executing move:",{piece:this.selectedPiece,from:{row:this.selectedPiece.row,col:this.selectedPiece.col},to:{row:d,col:f}}),console.log("Flag before requestAnimationFrame in executeMove:",this.hasMovedDueToRift),requestAnimationFrame((function(){if(g.classList.contains("enchanted-ground")){var e=o.handleMagicalCardEffect(a);o.showSpellInteraction(e.name,e.description),o.pieceSwapped=!0}if(console.log("Flag in requestAnimationFrame in executeMove:",o.hasMovedDueToRift),console.log("this.towerOfPowerActivated",o.towerOfPowerActivated),o.towerOfPowerActivated&&(o.checkAndPlaceTowerEachTurn(turnCount),o.checkTowerCountAndActivateBeam()),o.hasMovedDueToRift)return console.log("Piece already moved by rift effect, skipping normal move logic."),void(o.hasMovedDueToRift=!1);console.log("Flag in requestAnimationFrame in executeMove:",o.hasMovedDueToRift),s.removeChild(a),g.appendChild(a),s.removeAttribute("data-type"),s.removeAttribute("data-color"),s.style.backgroundImage="",s.classList.remove("has-piece");var t="images/".concat(o.currentPlayer,"_").concat(c,".png");g.setAttribute("data-type",c),g.setAttribute("data-color",l),g.style.backgroundImage="url(".concat(t,")"),g.classList.add("has-piece"),g.style.gridArea="".concat(d+1," / ").concat(f+1),console.log("this.currentPlayer",o.currentPlayer),console.log("Piece element after append:",a.outerHTML),console.log("Destination element children:",g.innerHTML)})),this.game.currentPlayer="white"===this.game.currentPlayer?"black":"white",console.log("this.game",this.game),console.log("this.game before trying to endTurn",this.game),this.game.startTurn(),console.log("this.game after trying to endTurn",this.game),a.addEventListener("click",this.boundHandleClick,{once:!0}),console.log("this context",this),console.log("Board state after move and before syncBoardState:",this.game.board),this.game.syncBoardState(),console.log("Board state after move&&syncBoardState:",this.game.board)}}},{key:"getPiece",value:function(e,t){return console.log("getPiece function called"),e<0||e>7||t<0||t>7?null:this.game.board[e][t]}},{key:"retrieveOrCreatePiece",value:function(e,t,n,r,o,i,a,s,c){console.log("retrieveOrCreatePiece function called with:$type, $color",e,t);var l=document.querySelector('.chess-square[data-row="'.concat(n,'"][data-col="').concat(r,'"] .chess-piece'));return console.log("existingPiece :",l),l.parent=c,l?(console.log("Retrieved existing piece from the board:",l),l):(console.error("No piece found at the specified location:",n,r),null)}},{key:"selectNewPiece",value:function(e,t,n,r){console.log("chessBoard in selectNewPiece:",n),n=document.querySelector("#chessboard"),console.log("chessBoard in selectNewPiece after querySelector:",n),console.log("clickedPiece in selectNewPiece:",e);var o=t.parentElement;console.log("clickedSquare in selectNewPiece:",o),this.retrieveOrCreatePiece(e.type,e.color,e.row,e.col),console.log("clickedSquare.row:",e.row),console.log("clickedSquare.col:",e.col);var i=this.calculateValidMoves(e.row,e.col,n,e.type,e.color);t.classList.add("selected-piece"),this.selectedPiece={row:e.row,col:e.col,element:t,piece:e,validMoves:i},console.log("newSelected piece in selectNewPiece:",this.selectedPiece),console.log("this.game.board in selectedPiece",this.game.board),this.showValidMoves(this.selectedPiece,n,i)}},{key:"addCapturedPiece",value:function(e,t){console.log("addcapturedPieces function called");var n=document.getElementById(t+"-captured"),r=document.createElement("div");r.classList.add("dead-piece"),r.style.fontSize="35px",r.style.width="35px",r.style.height="35px",r.style.display="inline-block",r.style.textAlign="center",r.innerHTML=e,n.appendChild(r)}},{key:"mapPieceToEmoji",value:function(e,t){return"white"===t?{pawn:"♙",rook:"♖",knight:"♘",bishop:"♗",queen:"♕",king:"♔"}[e]:{pawn:"♟",rook:"♜",knight:"♞",bishop:"♝",queen:"♛",king:"♚"}[e]}},{key:"deselectPiece",value:function(e){e.classList.remove("selected-piece"),console.log("selectedPiece deselected",e),this.clearValidMoves(),document.querySelectorAll(".selected-piece").forEach((function(e){e.classList.remove("selected-piece"),e.innerHTML=""})),this.selectedPiece=null}},{key:"showValidMoves",value:function(e,t,n){var r=this,o=this.threateningPath;if(console.log("threateningPath in showValidMoves",o),console.log("this.towerOfPowerActivated ",this.towerOfPowerActivated),console.log("this.isChaosTheoryActive",this.isChaosTheoryActive),e&&this.hasMovedDueToRift)return console.log("Piece already moved by rift effect, skipping normal move logic."),void(e.hasMovedDueToRift=!1);console.log("game.game.board in showValidMoves:",this.game.game.board),document.querySelectorAll(".chess-square").forEach((function(e){e.classList.remove("valid-move");var t=e.querySelector(".pattern");t&&e.removeChild(t);var n="".concat(e.dataset.row,"-").concat(e.dataset.col);r.activeClickListeners[n]&&(e.removeEventListener("click",r.activeClickListeners[n]),e.classList.remove("event-listener-attached"),delete e.dataset.listenerAttached,delete r.activeClickListeners[n])})),console.log();var i=n;o&&o.length>0&&this.validPiecesToResolveCheck.length>0&&(i=n.filter((function(e){return o.some((function(t){return e.row===t.row&&e.col===t.col}))})));var a,s=u(i);try{var c=function(){var t=a.value,n=document.querySelector('.chess-square[data-row="'.concat(t.row,'"][data-col="').concat(t.col,'"]'));n.classList.add("valid-move");var o=document.querySelector('.chess-square[data-row="'.concat(e.row,'"][data-col="').concat(e.col,'"]'));"Pawn"===e.type&&o&&o.classList.contains("mini-board")&&(console.log("pawn on miniboard"),n.classList.add("special-pawn-move"));var i=document.createElement("div");i.classList.add("pattern"),n.appendChild(i);var s=function(e){var t=n;if(console.log("trying to executeMove fnution in showValidMoves:"),console.log("clickedSquareElement passed :",t),console.log("Dice Flag before executeMove:",r.isChaosTheoryActive),r.isChaosTheoryActive){var o=r.rollDice();if(!(o>=5))return console.log("Random move enforced by Chaos Theory."),r.performRandomMove(),r.deselectAndClear(),r.selectedPiece&&r.selectedPiece.element&&r.selectedPiece.element.addEventListener("click",r.boundHandleClick,{once:!0}),r.game.endTurnMove(),r.game.startTurn(),void r.switchTurn();console.log("dice roll number",o),console.log("Normal turn allowed by Chaos Theory."),r.executeMove(r.chessBoard,t,n)}else r.executeMove(r.chessBoard,t,n),r.checkMiniBoardAndEndFinalStand();r.deselectAndClear()},c="".concat(t.row,"-").concat(t.col);r.activeClickListeners[c]=s,n.addEventListener("click",s,{once:!0}),n.hasChildNodes()&&(n.firstChild.dataset.listenerAttached="true")};for(s.s();!(a=s.n()).done;)c()}catch(e){s.e(e)}finally{s.f()}}},{key:"clearValidMoves",value:function(){console.log("clearValidMoves function entered"),document.querySelectorAll(".valid-move").forEach((function(e){e.classList.remove("valid-move"),e.innerHTML=""}))}},{key:"getPieceFromElement",value:function(e){if(!e)return console.log("Piece element is null"),null;var t=e.closest(".chess-square");if(!t)return console.log("Chess square element not found"),null;console.log("squareElement",t);var n=t.getAttribute("data-row"),r=t.getAttribute("data-col"),o=l(e.className.split(/\s+/).find((function(e){return e.includes("pawn")||e.includes("king")||e.includes("queen")||e.includes("bishop")||e.includes("knight")||e.includes("rook")})).split("-"),2),i=o[0],a=o[1];if(console.log("pieceType",a),console.log("pieceColor",i),!a||!i)return console.log("Piece type or color data attribute is missing"),null;var s={type:a,color:i,row:n,col:r};return console.log("Retrieved piece from DOM:",s),s}},{key:"addChessPiece",value:function(t,n,r,o,i,a,s,c){if(r<0||r>7||o<0||o>7)console.error("Invalid row ".concat(r," or col ").concat(o," for adding piece."));else{c=document.querySelectorAll(".chess-square"),console.log(" ssquares: ",c);var l=8*r+o,u=c.item(l);if(u){var h=new e(t,n,r,o,i,a,s);console.log("Adding piece: ",h),console.log("Added piece color: ".concat(h.color,", row: ").concat(r,", col: ").concat(o));var d=h.element;if(d){var f=u.querySelector(".chess-piece");f?u.replaceChild(d,f):u.appendChild(d),this.game.board[r][o]=h}else console.error("Failed to create piece element for ".concat(n," ").concat(t," at row ").concat(r,", col ").concat(o,"."))}else console.error("Cannot add piece at row ".concat(r,", col ").concat(o,". Square does not exist."))}}},{key:"toggleSpellMode",value:function(e,t){var n=this;console.log("toggleSpellMode called: ".concat(e," - ").concat(t)),this.isSpellActive=t;var r=document.querySelectorAll(".chess-piece");t?r.forEach((function(e){console.log("piece in toggleSpellMode",e),e.removeEventListener("click",n.boundHandleClick)})):r.forEach((function(e){e.addEventListener("click",n.boundHandleClick,{once:!0})}))}},{key:"addSpecialPawn",value:function(t,n,r,o,i,a,s,c){if(console.log("Adding special pawn of type: ",t),r<0||r>7||o<0||o>7)console.error("Invalid row ".concat(r," or col ").concat(o," for adding special pawn."));else{i="./img/".concat(t,".png"),console.log("imagePath",i);var l=8*r+o,u=c.item(l);if(u){var h=new e(t,n,r,o,i,a,s),d=document.createElement("div");if(d.classList.add("chess-piece"),d.style.backgroundImage="url('".concat(i,"')"),d.setAttribute("data-type",t),d.setAttribute("data-color",n),console.log("Adding special pawn: ",h),d){var f=u.querySelector(".chess-piece");console.log("squareElement:",u,"pieceElement:",d),f?u.replaceChild(d,f):u.appendChild(d),s.board[r][o]=h,console.log("gameboard after pawn placement",s.board[r][o]),this.refreshPieceEventListeners(),this.toggleGameState(!1),this.restoreNormalGameState()}else console.error("Failed to create piece element for ".concat(n," ").concat(t," at row ").concat(r,", col ").concat(o,"."))}else console.error("Cannot add special pawn at row ".concat(r,", col ").concat(o,". Square does not exist."))}}},{key:"convertSquareIdToRowCol",value:function(e){console.log("convertSquareIdToRowCol called , value of squareElement",e);var t=parseInt(e.getAttribute("data-row")),n=parseInt(e.getAttribute("data-col"));return console.log("row",t),console.log("col",n),isNaN(t)||isNaN(n)?(console.error("Row or col is not a number"),null):t<0||t>=this.game.board.length?(console.error("Row is out of bounds"),null):n<0||n>=this.game.board[t].length?(console.error("Col is out of bounds"),null):[t,n]}},{key:"removeSquareSelectionListeners",value:function(e){console.log("isPawnPlacementActive?",false)}},{key:"preparePawnCreation",value:function(e,t,n){var r=this;console.log("preparePawnCreation successfully entered in classPiece"),console.log("preparePawnCreation called for ".concat(e)),this.showSelectSquarePrompt(),console.log("Before toggling game state:",this.isPawnPlacementActive),console.log("After toggling game state:",this.isPawnPlacementActive);var o=document.querySelectorAll(".chess-square"),i=this,a=function(a){var s=a.currentTarget;console.log("selectedSquareElement",s);var c=l(i.convertSquareIdToRowCol(s),2),u=c[0],h=c[1];i.addSpecialPawn(e,"white",u,h,t,n,i.game,o),console.log("Special pawn placed, restoring normal game state"),r.isPawnPlacementActive=!1,r.toggleGameState(!1),r.refreshPieceEventListeners(),i.restoreNormalGameState(r.pawnPlacementListener)};o.forEach((function(e){r.isSquareEmpty(e)&&e.addEventListener("click",a,{once:!0})})),this.toggleGameState(!0)}},{key:"restoreNormalGameState",value:function(e){document.querySelectorAll(".chess-square").forEach((function(t){e&&t.removeEventListener("click",e)})),this.refreshPieceEventListeners(!0),console.log("Normal game state restored")}},{key:"showSelectSquarePrompt",value:function(){var e=this;console.log("Showing modal"),document.getElementById("select-square-modal").style.display="block",this.setupSquareListeners(),setTimeout((function(){e.hideSelectSquarePrompt()}),500)}},{key:"hideSelectSquarePrompt",value:function(){document.getElementById("select-square-modal").style.display="none"}},{key:"setupSquareListeners",value:function(){var e=this;document.querySelectorAll(".chess-square").forEach((function(t){e.isSquareEmpty(t)&&(t.removeEventListener("click",e.boundHandleSquareClick),t.addEventListener("click",e.boundHandleSquareClick,{once:!0}))}))}},{key:"addPieceEventListener",value:function(e){e.addEventListener("click",this.boundHandleClick),e.classList.add("event-listener-attached")}},{key:"removePieceEventListener",value:function(e){e.removeEventListener("click",this.boundHandleClick),e.classList.remove("event-listener-attached")}},{key:"initObserver",value:function(){var e=this;console.log("initObserver function entered");var t={attributes:!0,childList:!1,subtree:!0,attributeFilter:["data-listenerAttached"]};console.log("config",t),new MutationObserver((function(t,n){var r,o=u(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;if("attributes"===i.type&&"data-listenerAttached"===i.attributeName){console.log("Mutation type: ".concat(i.type)),console.log("The data-listenerAttached attribute was modified on:",i.target);var a="true"!==i.target.dataset.listenerAttached;e.refreshPieceEventListeners(a)}}}catch(e){o.e(e)}finally{o.f()}})).observe(document.body,t)}},{key:"refreshPieceEventListeners",value:function(e){var t=this;console.log("refreshPieceEventListeners function called, enableListeners being :",e),document.querySelectorAll(".chess-piece").forEach((function(n){var r=n.parentNode,o=!r.dataset.listenerAttached;console.log("square, needsListener",r,o),e&&o?(console.log("Attaching event listener to piece:",n),r.addEventListener("click",t.boundHandleClick),r.dataset.listenerAttached="true"):e||o||(console.log("Detaching event listener from piece:",n),r.removeEventListener("click",t.boundHandleClick),delete r.dataset.listenerAttached)}))}},{key:"setupCloseButtonListener",value:function(){var e=document.getElementsByClassName("close-button")[0];if(console.log("closeButton",e),e){console.log("Close button setup");var t=this;e.addEventListener("click",(function(){t.hideSelectSquarePrompt()}))}}},{key:"isSquareEmpty",value:function(e,t){console.log("row",e,"col",t);var n=".chess-square[data-row='".concat(e,"'][data-col='").concat(t,"']"),r=document.querySelector(n);return console.log("squareSelector",n),r?!r.hasChildNodes():(console.error("Square at row ".concat(e," and column ").concat(t," not found.")),!1)}},{key:"calculateValidMovesForPiece",value:function(){var t=this.row,n=this.col,r=this.type,o=this.color;return e.calculateValidMoves(t,n,this.game.board,r,o)}},{key:"calculateValidMoves",value:function(e,t,n,r,o,i){var a=this;console.log("calculateValidMoves called for",e,t),console.log("Board state in calculateValidMoves:",n),console.log("this.game.board state at the beginnign of calculateValidMoves",this.game.game.board),console.log("Piece type in calculateValidMoves:",r,"Color:",o);var s=[],c="white"===o?"black":"white",l=parseInt(e,10),u=parseInt(t,10);switch(this.game,r){case"pawn":var h=document.querySelector('.chess-square[data-row="'.concat(l,'"][data-col="').concat(u,'"]')),d=h.firstElementChild;console.log("pawnSquare",h),console.log("pawnSquare class list:",h.classList);var f=h.classList.contains("mini-board-highlight"),g=d.classList.contains("pawn-random-move");if(console.log("isPawnOnMiniBoard",f),f)console.log("Processing pawn In MINIBOARD SPELL"),[{row:l-1,col:u-1},{row:l-1,col:u},{row:l-1,col:u+1},{row:l,col:u-1},{row:l,col:u+1},{row:l+1,col:u-1},{row:l+1,col:u},{row:l+1,col:u+1}].forEach((function(e){if(console.log("Checking move: row=".concat(e.row,", col=").concat(e.col)),e.row>=0&&e.row<8&&e.col>=0&&e.col<8){console.log("Board state at [".concat(e.row,"][").concat(e.col,"]:"),a.game.game.board[e.row][e.col]);var t=a.game.game.board[e.row][e.col];t&&t.color!==c||s.push(e)}}));else if("pawn"===r&&g){var p="white"===o?1:-1;if(console.log("Pawn under Wind of Change spell",this),console.log("moveForward",p),console.log("currentCol",u),d.classList.contains("left"))console.log("moveForward in left moves",p),console.log("currentCol in left moves",u,"currentRow in left move",l),u>0&&!this.game.game.board[l][u-1]&&(s.push({row:l,col:u-1}),u-2>=0&&!this.game.game.board[l][u-2]&&s.push({row:l,col:u-2}));else if(d.classList.contains("right"))u<7&&!this.game.game.board[l][u+1]&&(s.push({row:l,col:u+1}),u+2<=7&&!this.game.game.board[l][u+2]&&s.push({row:l,col:u+2}));else if(d.classList.contains("forward")){var m=l+p;if(m>=0&&m<8&&!this.game.game.board[m][u]&&s.push({row:m,col:u}),"white"===this.color&&1===l||"black"===this.color&&6===l){var v=m+p;this.game.game.board[v][u]||s.push({row:v,col:u})}}else if(d.classList.contains("diagonalLeft")){var y=l+p,w=u-1;if(y>=0&&y<8&&w>=0&&w<8){if(!this.game.game.board[y][w]||this.game.game.board[y][w].color!==this.color){s.push({row:y,col:w});var b=y+p,P=w-1;b>=0&&b<8&&P>=0&&P<8&&(this.game.game.board[b][P]&&this.game.game.board[b][P].color===this.color||s.push({row:b,col:P}))}for(var S=0,k=[1,-1];S<k.length;S++){var E=u+k[S];if(E>=0&&E<8){var A=this.game.game.board[y][E];A&&A.color!==this.color&&s.push({row:newRow,col:E})}}}}else if(d.classList.contains("diagonalRight")){var q=l+p,C=u+1;if(q>=0&&q<8&&C>=0&&C<8&&(!this.game.game.board[q][C]||this.game.game.board[q][C].color!==this.color)){s.push({row:q,col:C});var M=q+p,I=C+1;M>=0&&M<8&&I>=0&&I<8&&(this.game.game.board[M][I]&&this.game.game.board[M][I].color===this.color||s.push({row:M,col:I}))}for(var L=0,T=[1,-1];L<T.length;L++){var B=u+T[L];if(B>=0&&B<8){var O=this.game.game.board[q][B];O&&O.color!==this.color&&s.push({row:newRow,col:B})}}}}else{console.log("Processing pawn");var _="white"===o?1:-1;console.log("direction",_);var x=l+_;if(console.log("newRow for pawn in calculateValidMoves:",x),x>=0&&x<8&&!this.game.game.board[x][u]&&(s.push({row:x,col:u}),console.log("this.color before the pawn double square first move aka PDSFM",this.color),console.log("Pawn starting row check:","white"===this.color&&1===e||"black"===this.color&&6===e),console.log("Square directly in front is empty:",!this.game.game.board[l+_][u]),console.log("Square two steps ahead is empty:",!this.game.game.board[l+2*_][u]),"white"===this.color&&1===l||"black"===this.color&&6===l)){var R=x+_;this.game.game.board[R][u]||s.push({row:R,col:u})}for(var N=0,j=[1,-1];N<j.length;N++){var U=u+j[N];if(U>=0&&U<8){var D=this.game.game.board[x][U];D&&D.color!==this.color&&s.push({row:x,col:U})}}}break;case"knight":[{row:l-2,col:u-1},{row:l-2,col:u+1},{row:l-1,col:u-2},{row:l-1,col:u+2},{row:l+1,col:u-2},{row:l+1,col:u+2},{row:l+2,col:u-1},{row:l+2,col:u+1}].forEach((function(e){if(e.row>=0&&e.row<8&&e.col>=0&&e.col<8){var t=a.game.game.board[e.row][e.col];t&&t.color!==c||s.push(e)}}));break;case"bishop":console.log("Processing bishop"),[{dr:-1,dc:-1},{dr:-1,dc:1},{dr:1,dc:-1},{dr:1,dc:1}].forEach((function(e){for(var t=1;t<8;t++){var n=l+e.dr*t,r=u+e.dc*t;if(n>=0&&n<8&&r>=0&&r<8){var o=a.game.game.board[n][r];if(o){o.color===c&&s.push({row:n,col:r});break}s.push({row:n,col:r})}}}));break;case"rook":console.log("Processing rook"),[{dr:-1,dc:0},{dr:1,dc:0},{dr:0,dc:-1},{dr:0,dc:1}].forEach((function(e){for(var t=1;t<8;t++){var n=l+e.dr*t,r=u+e.dc*t;if(n>=0&&n<8&&r>=0&&r<8){var o=a.game.game.board[n][r];if(o){o.color===c&&s.push({row:n,col:r});break}s.push({row:n,col:r})}}}));break;case"queen":[{dr:-1,dc:-1},{dr:-1,dc:1},{dr:1,dc:-1},{dr:1,dc:1},{dr:-1,dc:0},{dr:1,dc:0},{dr:0,dc:-1},{dr:0,dc:1}].forEach((function(e){for(var t=1;t<8;t++){var n=l+e.dr*t,r=u+e.dc*t;if(n>=0&&n<8&&r>=0&&r<8){var o=a.game.game.board[n][r];if(o){o.color===c&&s.push({row:n,col:r});break}s.push({row:n,col:r})}}}));break;case"king":console.log("Processing king");var G=[{row:l-1,col:u-1},{row:l-1,col:u},{row:l-1,col:u+1},{row:l,col:u-1},{row:l,col:u+1},{row:l+1,col:u-1},{row:l+1,col:u},{row:l+1,col:u+1}];console.log("King Moves:",G),G.forEach((function(e){console.log("Evaluating move:",e),e.row>=0&&e.row<7&&e.col>=0&&e.col<7&&(a.game.game.board[e.row][e.col]&&a.game.game.board[e.row][e.col].color!==c||(s.push(e),console.log("Valid move added:",e)))}));break;default:console.error("Unknown piece type:",this.type)}return console.log("this.game;board at the end of calculateValidMovesl :",this.game.board),console.log("Valid moves generated:",s),s}},{key:"isValidMove",value:function(t,n,r,o,i){var a=new e(this.type,this.color,this.row,this.col,this.imagePath,this.element,this.board);if(r<0||r>7||o<0||o>7)return console.log("move outside of board boundaries"),!1;var s=document.querySelector('.chess-square[data-row="'.concat(t,'"][data-col="').concat(n,'"]')),c=s&&s.classList.contains("mini-board");switch(console.log("currentSquare0",s,"onMiniBoard",c),a.type){case"pawn":if(c)return console.log("pawn is on miniboard upgrading"),Math.abs(r-t)<=1&&Math.abs(o-n)<=1;if("white"==a.color){if(r==t-1&&o==n&&!i[r][o])return!0;if(r==t-2&&o==n&&!i[r][o]&&!i[t-1][n]&&6==t)return!0}else if("black"==a.color){if(r==t+1&&o==n&&!i[r][o])return!0;if(r==t+2&&o==n&&!i[r][o]&&!i[t+1][n]&&1==t)return!0}break;case"rook":if((r==t||o==n)&&!isBlocked(a,r,o))return!0;break;case"knight":if(2==Math.abs(r-t)&&1==Math.abs(o-n)||1==Math.abs(r-t)&&2==Math.abs(o-n))return!0;break;case"bishop":if(Math.abs(r-t)==Math.abs(o-n)&&!isBlocked(a,r,o))return!0;break;case"queen":if((r==t||o==n||Math.abs(r-t)==Math.abs(o-n))&&!isBlocked(t,n,r,o))return!0;break;case"king":if(Math.abs(r-t)<=1&&Math.abs(o-n)<=1)return!0;break;default:return console.log("piece not recognized"),!1}return console.log("unvalidmove"),!1}},{key:"updateBoardVisuals",value:function(){var e=this;console.log("updateBoardVisuals called"),document.querySelectorAll(".square").forEach((function(t){var n=parseInt(t.getAttribute("data-row")),r=parseInt(t.getAttribute("data-col"));console.log("squareElement in udpateBoardVisuals",t),t.removeEventListener("click",e.boundHandleClick),t.addEventListener("click",(function(t){return e.boundHandleClick(t,e.chessBoard)}),{once:!0});var o=e.board[n][r];console.log("this.game.board in updateBoardVisuals",o),t.innerHTML=o?'<div class="chess-piece" style="background-image: url(\''.concat(o.imagePath,"')\"></div>"):""})),console.log("Finished updateBoardVisuals")}},{key:"initializeBoard",value:function(){var e=this;document.querySelectorAll(".chess-square").forEach((function(t){var n=parseInt(t.getAttribute("data-row")),r=parseInt(t.getAttribute("data-col")),o=t.querySelector(".chess-piece div");console.log("piece in initializeBoard",o),o&&(e.game.board[n][r]={type:o.className,row:n,cols:r,imagePath:o.getAttribute("src")})}))}},{key:"nextRandom",value:function(e,t,n,r){var o=(e*t+n)%r;return{newSeed:o,nextValue:o/r}}},{key:"chaosWarp",value:function(e,t){var n=this;console.log("chaosWarp called with rng:",t);var r=Array.from(document.querySelectorAll(".chess-square"));console.log("squares found:",r);var o=t.seed,i=[];r.forEach((function(e){var t=e.querySelector(".chess-piece");t&&(i.push({element:t,originalSquare:e,type:t.classList[1].split("-")[1],color:t.classList[1].split("-")[0],row:parseInt(e.getAttribute("data-row"),10),col:parseInt(e.getAttribute("data-col"),10)}),e.classList.remove("has-piece"),e.removeAttribute("data-type"),e.removeAttribute("data-color"),e.style.backgroundImage="",e.removeChild(t))}));for(var a=i.length-1;a>0;a--){var s=this.nextRandom(t.multiplier,o,t.increment,t.modulus),c=Math.floor(s.nextValue*(a+1)),l=[i[c],i[a]];i[a]=l[0],i[c]=l[1],o=s.newSeed}for(var u=r.length-1;u>0;u--){var h=this.nextRandom(t.multiplier,o,t.increment,t.modulus),d=Math.floor(h.nextValue*(u+1)),f=[r[d],r[u]];r[u]=f[0],r[d]=f[1],o=h.newSeed}var g=[];return i.forEach((function(e,t){var o=r[t],i=parseInt(o.getAttribute("data-row"),10),a=parseInt(o.getAttribute("data-col"),10);o.appendChild(e.element),o.classList.add("has-piece"),o.setAttribute("data-type",e.type),o.setAttribute("data-color",e.color),n.game.board[i][a]={type:e.type,color:e.color},console.log("piece value before pushing shuffledposition in the array",e),g.push({id:e.element,newRow:i,newCol:a})})),console.log("Shuffling complete, internal board updated."),console.log("shuffledPositions",g),this.updateInternalBoardStateFromDOM(),this.updateBoardVisuals(),g}},{key:"updateInternalBoardStateFromDOM",value:function(){var e=this;console.log("updateInternalBoardStateFromDOM called"),document.querySelectorAll(".chess-square").forEach((function(t){var n=parseInt(t.getAttribute("data-row"),10),r=parseInt(t.getAttribute("data-col"),10),o=t.getAttribute("data-type"),i=t.getAttribute("data-color"),a=t.querySelector(".chess-piece");if(o&&i){var s=e.retrieveOrCreatePiece(o,i,n,r,e.game,e.chessBoard);e.game.board[n][r]=s,a&&s&&s.imagePath&&(a.style.backgroundImage="url('".concat(s.imagePath,"')"))}else e.game.board[n][r]=null})),console.log("Updated internal board state:",this.game.board)}},{key:"isValidPlacement",value:function(e,t,n,r){return!0}},{key:"castFrostGridSpell",value:function(){console.log("castFrostGridSpell called"),this.toggleSpellMode("FrostGrid",!0);var e=document.getElementById("chessboard");e.addEventListener("mousemove",this.handleHover),e.addEventListener("click",this.boundHandleSelection,{once:!0})}},{key:"handleHover",value:function(e){if(this.isSpellActive){var t=this.determineTopLeftCorner(e),n=t.x,r=t.y;this.highlightArea(n,r)}else console.log("handleHover returned due to isSpellActive being :",this.isSpellActive)}},{key:"handleSelection",value:function(e){if(e.preventDefault(),e.stopPropagation(),this.isSpellActive){var t=this.determineTopLeftCorner(e),n=t.x,r=t.y;this.applySpellEffects(n,r),this.deactivateSpell()}else console.log("handleSelection returned due to isSpellActive being :",this.isSpellActive)}},{key:"highlightArea",value:function(e,t){this.clearHighlights();for(var n=0;n<2;n++)for(var r=0;r<2;r++){var o=e+n,i=t+r,a=document.getElementById("square-".concat(o,"-").concat(i));a&&(a.classList.add("highlight"),this.highlightedSquares.push(a))}}},{key:"clearHighlights",value:function(){this.highlightedSquares.forEach((function(e){return e.classList.remove("highlight")})),this.highlightedSquares=[]}},{key:"applySpellEffects",value:function(e){var t=this,n=Math.floor(151*Math.random())+1;console.log("King's Number:",n);var r=null,o=null,i=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER;if(e.forEach((function(e,o){var a=Math.abs(e-n);("white"===t.color&&o.classList.contains("black-pawn")||"black"===t.color&&o.classList.contains("white-pawn"))&&a<i&&(r=o,i=a)})),e.forEach((function(e,r){var i=Math.abs(e-n);("white"===t.color&&r.classList.contains("white-pawn")||"black"===t.color&&r.classList.contains("black-pawn"))&&i<a&&(o=r,a=i)})),r){var s=r.closest(".chess-square"),c=s.dataset.row,l=s.dataset.col;document.querySelectorAll(".number-box").forEach((function(e){return e.remove()})),this.forceRemove(c,l)}if(o){var u=["rook","bishop","knight"],h=u[Math.floor(Math.random()*u.length)],d=o.closest(".chess-square");if(d){o.parentNode===d&&d.removeChild(o);var f=document.createElement("img");f.classList.add("chess-piece","".concat(this.color,"-").concat(h)),f.style.backgroundImage="url('img/".concat(this.color).concat(h,".png')"),f.setAttribute("data-color",this.color),f.setAttribute("data-type",h),d.appendChild(f)}}}},{key:"applyEffectToPiece",value:function(e,t,n){console.log("applyEffectToPiece called");var r=document.querySelector("#chessboard");console.log("chessBoard",r),r.querySelectorAll(".has-piece.highlight").forEach((function(e){e.classList&&e.classList.add("frozen-piece")})),e.classList&&e.classList.add("frozen-square")}},{key:"deactivateSpell",value:function(){console.log("Deactivating Frost Grid Spell called"),this.toggleSpellMode("FrostGrid",!1);var e=document.getElementById("chessboard");e.removeEventListener("mousemove",this.handleHover),e.removeEventListener("click",this.boundHandleSelection)}},{key:"determineTopLeftCorner",value:function(e){var t=document.getElementById("chessboard").getBoundingClientRect(),n=t.width/8,r=e.clientX-t.left,o=e.clientY-t.top,i=Math.floor(r/n),a=Math.floor(o/n);return{x:a=Math.max(0,Math.min(a,6)),y:i=Math.max(0,Math.min(i,6))}}},{key:"getPieceFromCoords",value:function(e,t,n){console.log("getPieceFromCoords called with row:",t,"col:",n);var r='.chess-square[data-row="'.concat(t,'"][data-col="').concat(n,'"]'),o=document.querySelector(r);if(o){console.log("Found square element:",o);var i=o.querySelector(".chess-piece");return i?(console.log("Found piece element:",i),i):(console.error("No piece element found in square at row ".concat(t,", col ").concat(n)),null)}return console.error("No square element found at row ".concat(t,", col ").concat(n)),null}},{key:"syncWithClients",value:function(e,t){i(e).players.forEach((function(e){e.socket.emit("gameUpdate",t)}))}},{key:"castAdeptWandSpell",value:function(e,t,n,r){var o=this;console.log(" random rift duration being",e),this.riftDuration=e,console.log("Rift started with duration: ".concat(this.riftDuration," turns")),this.defineAndShowRiftArea();var i={name:"Rift",duration:this.riftDuration,updateEffect:function(){o.updateNotification(i.name,i.duration,"Piece teleported to a random square.")},endEffect:function(){o.removeRiftArea(),o.removeNotification(i.name)}};this.riftSpellDuration=this.riftDuration,console.log("this.riftSpellDuration in castAdeptWandSpell",this.riftSpellDuration),this.activeSpells.push(i),this.updateGameStateInMovePiece=this.updateGameStateInMovePiece.bind(this,this.activeSpells),this.executeMove=this.executeMove.bind(this,this.activeSpells),console.log("Active Spells after adding Rift:",this.activeSpells),i.updateEffect()}},{key:"postMoveActions",value:function(e,t,n){if(console.log("Executing post-move actions for piece:",this),this.isInRift(e,t)){console.log("Piece moved into rift, shuffling position"),this.randomlyPlacePiece(),console.log("Active Spells in postMoveActions:",this.activeSpells);var r=this.activeSpells.find((function(e){return"Rift"===e.name}));console.log("riftSpell in postMoveActionsos",r),r&&(console.log("trying to updateNotification on rifl increment, spell duration",r.duration),this.updateNotification("Rift",r.duration,"Piece teleported to a random square.")),console.log("tried to updateNotification")}else console.log("Piece did not move into rift, no additional action taken")}},{key:"removeRiftArea",value:function(){var e=Math.floor(this.game.board.length/2),t=Math.floor(this.game.board[0].length/2);[[e-1,t-1],[e-1,t],[e,t-1],[e,t]].forEach((function(e){var t=l(e,2),n=t[0],r=t[1],o=document.querySelector("#square-".concat(n,"-").concat(r));o&&o.classList.remove("rift")}))}},{key:"defineAndShowRiftArea",value:function(){var e=Math.floor(this.game.board.length/2),t=Math.floor(this.game.board[0].length/2);[[e-1,t-1],[e-1,t],[e,t-1],[e,t]].forEach((function(e){var t=l(e,2),n=t[0],r=t[1],o=document.querySelector("#square-".concat(n,"-").concat(r));o&&o.classList.add("rift")}))}},{key:"isInRift",value:function(e,t){return this.getRiftArea().some((function(n){var r=l(n,2),o=r[0],i=r[1];return o===e&&i===t}))}},{key:"getRiftArea",value:function(){var e=this.game.board,t=Math.floor(e.length/2),n=Math.floor(e[0].length/2);return[[t-1,n-1],[t-1,n],[t,n-1],[t,n]]}},{key:"updateGameStateInMovePiece",value:function(e,t){var n=this;console.log(".game in updateGameStateInMovePiece :",e),console.log("Flag before executeMove:",this.hasMovedDueToRift),console.log(".activeSpells in updateGameStateInMovePiece :",t),t=this.activeSpells,console.log("activeSpells in updateGameStateInMovePiece",t),this.currentPlayer="white"===this.currentPlayer?"black":"white",console.log("Active Spells in updateGameStateInMovePiece:",this.activeSpells),this.activeSpells.forEach((function(e){console.log("spell.duration before -- :",e.duration),n.riftSpellDuration--,console.log("spell.duration after -- :",e.duration),n.riftSpellDuration>0?n.updateNotification(e.name,n.riftSpellDuration,"Piece teleported to a random square."):e.endEffect()})),this.activeSpells=this.activeSpells.filter((function(e){return e.duration>0}))}},{key:"randomlyPlacePiece",value:function(e){if(console.log("this.game.board in randomlyPlacePiece",this.game.board),this.isRandomlyPlacing)console.log("Already placing a piece, exiting to prevent overlap.");else{this.isRandomlyPlacing=!0;var t=this.board.squareElements.filter((function(e){return!e.classList.contains("has-piece")}));if(console.log("emptySquares :",t),0===t.length)return console.error("No empty squares available"),void(this.isRandomlyPlacing=!1);var n=l(t[Math.floor(Math.random()*t.length)].id.split("-").map(Number),3),r=(n[0],n[1]),o=n[2];this.forceMove(this,r,o,!0),this.isRandomlyPlacing=!1,this.hasMovedDueToRift=!0,console.log("Rift move completed, flag set:",this.hasMovedDueToRift),console.log("Piece moved to new position: (".concat(r,", ").concat(o,")"))}}},{key:"updateRiftDurationOnPlayerChange",value:function(){console.log("updateRiftDurationOnPlayerChange called"),console.log("Current active spells:",this.activeSpells);var e=this.activeSpells.find((function(e){return e.name}));console.log("Rift Spell found:",e),e&&(e.duration--,console.log("Rift duration decremented to ".concat(e.duration)),e.duration>0?this.updateNotification(e.name,e.duration,"Piece teleported to a random square."):(e.endEffect(),this.activeSpells=this.activeSpells.filter((function(t){return t!==e})),console.log("Rift spell ended and removed from active spells")))}},{key:"startFinalStand",value:function(){this.isFinalStandActive=!0,this.setupMiniBoard(),this.clearMiniBoard()}},{key:"setupMiniBoard",value:function(){var e,t=this;console.log("Current player color:",this.playerColor||(null===(e=this.game)||void 0===e?void 0:e.currentPlayer)),"white"===this.playerColor?this.miniBoardArea={x1:6,y1:6,x2:7,y2:7}:"black"===this.playerColor&&(this.miniBoardArea={x1:0,y1:0,x2:1,y2:1}),this.highlightMiniBoardArea();var n=document.querySelectorAll(".chess-square");console.log("allSquares",n),n.forEach((function(e){var n=parseInt(e.getAttribute("data-row")),r=parseInt(e.getAttribute("data-col"));t.isWithinMiniBoard(n,r)||e.classList.add("inactive-square")})),document.querySelectorAll(".chess-piece").forEach((function(e){var n=parseInt(e.parentNode.getAttribute("data-row")),r=parseInt(e.parentNode.getAttribute("data-col"));t.isWithinMiniBoard(n,r)||e.classList.add("grayed-out")}))}},{key:"clearMiniBoard",value:function(){var e=this;console.log("clearMiniBoard function entered"),console.log("this.miniBoardArea.x1",this.miniBoardArea.x1,"this.miniBoardArea.y1",this.miniBoardArea.y1,"this.miniBoardArea.y2",this.miniBoardArea.y2,"this.miniBoardArea.x2",this.miniBoardArea.x2);for(var t=Array.from(document.querySelectorAll(".chess-square:not(.has-piece)")).filter((function(t){return!e.isWithinMiniBoard(parseInt(t.getAttribute("data-row")),parseInt(t.getAttribute("data-col")))})),n=this.miniBoardArea.y1;n<=this.miniBoardArea.y2;n++)for(var r=this.miniBoardArea.x1;r<=this.miniBoardArea.x2;r++){var o=document.querySelector('.chess-square[data-row="'.concat(n,'"][data-col="').concat(r,'"]'));if(o){console.log("Clearing square:",o);var i=o.querySelector(".chess-piece");if(i)if(t.length>0){var a=Math.floor(Math.random()*t.length),s=t[a];t.splice(a,1),this.forceMovePieceToSquare(i,s)}else console.error("No unoccupied squares available to move the piece")}else console.error("Square not found at row ".concat(n,", col ").concat(r))}this.handlePieceSelection()}},{key:"highlightMiniBoardArea",value:function(){var e=this;console.log("highlightMiniBoardArea function called");var t,n,r=document.getElementById("chessboard"),o=document.createElement("div");o.className="mini-board-container",r.appendChild(o);for(var i=this.miniBoardArea.y1;i<=this.miniBoardArea.y2;i++)for(var a=this.miniBoardArea.x1;a<=this.miniBoardArea.x2;a++){var s=document.querySelector('.chess-square[data-row="'.concat(i,'"][data-col="').concat(a,'"]'));s.classList.add("mini-board-highlight"),t||(t=s),n=s}var c=t.getBoundingClientRect(),l=n.getBoundingClientRect();o.style.position="absolute",o.style.left="".concat(c.left,"px"),o.style.top="".concat(c.top,"px"),o.style.width="".concat(l.right-c.left,"px"),o.style.height="".concat(l.bottom-c.top,"px");for(var u=this.miniBoardArea.y1;u<=this.miniBoardArea.y2;u++)for(var h=this.miniBoardArea.x1;h<=this.miniBoardArea.x2;h++){var d=document.querySelector('.chess-square[data-row="'.concat(u,'"][data-col="').concat(h,'"]'));d.classList.add("mini-board-highlight"),d.addEventListener("click",this.handleSquareClick)}document.querySelectorAll(".chess-square").forEach((function(t){var n=parseInt(t.getAttribute("data-row")),r=parseInt(t.getAttribute("data-col"));if(!e.isWithinMiniBoard(n,r)){t.classList.add("inactive-square");var o=t.querySelector(".chess-piece");o&&o.classList.add("grayed-out")}}))}},{key:"setupPieceEventListeners",value:function(){var e=this;document.querySelectorAll(".chess-square").forEach((function(t){var n=parseInt(t.getAttribute("data-row"),10),r=parseInt(t.getAttribute("data-col"),10);e.isWithinMiniBoard(n,r)?t.addEventListener("click",e.handleSquareClick):t.classList.add("inactive-square")}))}},{key:"isWithinMiniBoard",value:function(e,t){return console.log("isWithinMiniBoard function called"),e>=this.miniBoardArea.y1&&e<=this.miniBoardArea.y2&&t>=this.miniBoardArea.x1&&t<=this.miniBoardArea.x2}},{key:"isMoveValid",value:function(e,t,n){if(this.isFinalStandActive)return this.isWithinMiniBoard(t,n)}},{key:"checkMiniBoardAndEndFinalStand",value:function(){console.log("checkMiniBoardAndEndFinalStand function called");var e=document.querySelectorAll(".mini-board-highlight");if(console.log("miniBoardSquares",e.length),0!==e.length){var t=document.querySelectorAll(".mini-board-highlight .chess-piece.white"),n=document.querySelectorAll(".mini-board-highlight .chess-piece.black");console.log("miniBoardWhitePieces",t.length,"miniBoardBlackPieces",n.length),(t.length<=1||n.length<=1)&&this.endFinalStand()}else console.log("No mini-board squares highlighted. Spell is not active.")}},{key:"endFinalStand",value:function(){var e=this,t=document.querySelectorAll(".mini-board-highlight .chess-square:has(.chess-piece.white)").length,n=document.querySelectorAll(".mini-board-highlight .chess-square:has(.chess-piece.black)").length;console.log("White pieces count:",t,"Black pieces count:",n),t<=1||n<=1?(console.log("Ending Final Stand Spell"),document.querySelectorAll(".chess-square").forEach((function(e){console.log("Removing inactive from:",e),e.classList.remove("inactive-square"),e.classList.remove("mini-board-highlight")})),document.querySelectorAll(".chess-piece").forEach((function(e){console.log("Removing grayed-out from:",e),e.classList.remove("grayed-out")})),document.querySelectorAll(".chess-square:not(.mini-board-highlight) .chess-piece").forEach((function(t){console.log("Reattaching event listeners to:",t),e.attachEventListenersToPiece(t)})),this.isFinalStandActive=!1,this.applyFinalStandOutcome()):console.log("Final Stand Spell continues")}},{key:"attachEventListenersToPiece",value:function(e){e.addEventListener("click",this.boundHandleClick)}},{key:"applyFinalStandOutcome",value:function(){}},{key:"handlePieceSelection",value:function(e){var t=this.currentPlayer;this.finalStandPlayerPieces=this.queryAlliedMiniBoardPieces(t);var n=document.getElementById("piece-selection-container");n&&(n.style.display="none"),this.selectOpponentPiece(),this.setupMiniBoard()}},{key:"selectOpponentPiece",value:function(){var e="white"===this.currentPlayer?"black":"white";this.finalStandOpponentPieces=this.queryOponentMiniBoardPieces(e),this.placePiecesOnMiniBoard(this.finalStandPlayerPieces,this.finalStandOpponentPieces)}},{key:"queryOponentMiniBoardPieces",value:function(e){var t="white"===this.currentPlayer?"black":"white",n=Array.from(document.querySelectorAll(".chess-piece.".concat(t,"-pawn"))),r=Array.from(document.querySelectorAll(".chess-piece.".concat(t,"-rook, \n                                                                       .chess-piece.").concat(t,"-bishop, \n                                                                       .chess-piece.").concat(t,"-knight"))),o=this.randomlySelectPieces(n,2),i=this.randomlySelectPieces(r,1);return o.concat(i)}},{key:"queryAlliedMiniBoardPieces",value:function(e){var t=this.currentPlayer,n=Array.from(document.querySelectorAll(".chess-piece.".concat(t,"-pawn"))),r=this.randomlySelectPieces(n,2),o=".chess-piece.".concat(t,"-rook, .chess-piece.").concat(t,"-bishop, .chess-piece.").concat(t,"-knight"),i=Array.from(document.querySelectorAll(o)).filter((function(e){return!r.includes(e)})),a=this.randomlySelectPieces(i,1);return console.log("Selected pawns:",r,"Selected upgraded piece:",a),r.concat(a)}},{key:"randomlySelectPieces",value:function(e,t){console.log("pieces",e);for(var n=Array.from(e).sort((function(){return.5-Math.random()})),r=[],o=0;o<t&&o<n.length;o++)r.push(n[o]);return r}},{key:"placePiecesOnMiniBoard",value:function(e,t){var n=this;e.concat(t).sort((function(){return.5-Math.random()})).forEach((function(e){var t=Array.from(document.querySelectorAll(".mini-board .chess-square:not(.has-piece)")).sort((function(){return.5-Math.random()}));if(t.length>0){var r=t[0];n.forceMovePieceInsideMiniBoard(e,r)}else console.error("No unoccupied squares available to place the piece")}))}},{key:"forceMovePieceToSquare",value:function(e,t){if(console.log("forceMovePieceToSquare function entered with piece",e),t){var n=parseInt(e.parentNode.getAttribute("data-row")),r=parseInt(e.parentNode.getAttribute("data-col")),o=parseInt(t.getAttribute("data-row")),i=parseInt(t.getAttribute("data-col"));console.log("fromRow",n,"fromCol",r,"toRow",o,"toCol",i),this.forceMove(e,n,r,o,i)}else console.error("No target square provided")}},{key:"forceMovePieceInsideMiniBoard",value:function(e,t){console.log("forceMovePieceInsideMiniBoard function entered with piece",e),console.log("this.miniBoardArea.y2",this.miniBoardArea.y2),console.log("this.miniBoardArea.y1",this.miniBoardArea.y1),console.log("this.miniBoardArea.x2",this.miniBoardArea.x2),console.log("this.miniBoardArea.x1",this.miniBoardArea.x1);var n,r,o=parseInt(e.parentNode.getAttribute("data-row")),i=parseInt(e.parentNode.getAttribute("data-col")),a=0;do{if(a++>15)return void console.error("Unable to find an empty square after 50 attempts.");n=Math.floor(Math.random()*(this.miniBoardArea.y2-this.miniBoardArea.y1+1))+this.miniBoardArea.y1,r=Math.floor(Math.random()*(this.miniBoardArea.x2-this.miniBoardArea.x1+1))+this.miniBoardArea.x1,console.log("Attempt",a,": trying row",n,"col",r)}while(!1===this.isSquareEmpty(n,r));console.log("Moving piece from",o,i,"to",n,r),this.forceMove(e,o,i,n,r)}},{key:"checkFinalStandEndCondition",value:function(){}},{key:"castPetrifySpell",value:function(e,t,n,r){console.log("castPetrifySpell function entered, spell result being:",e);var o="white"===this.currentPlayer?"black":"white";console.log("enemyColor",o);var i=Array.from(document.querySelectorAll(".chess-piece.".concat(o,"-pawn")));console.log("enemyPieces",i);var a=this.currentPlayer,s=Array.from(document.querySelectorAll(".chess-piece.".concat(a,"-pawn")));console.log("allyColor",a),console.log("allyPieces",s);var c=e.selectedEnemyIndices,l=e.selectedAllyIndices;this.processSelectedPieces(c,e,r),this.processSelectedPieces(l,e,r),console.log("Selected enemies:",c),console.log("Selected allies:",l);var u=c.concat(l),h=e.turnsPetrified.slice(0,u.length),d=e.turnsUntilDestruction.slice(0,u.length);console.log("check before the call to applyPetrification totalTurnsPetrified being:",h,"totalTurnsUntilDestruction",d),this.applyPetrification(u,h,d)}},{key:"processSelectedPieces",value:function(e,t,n){var r=this;e.forEach((function(e,o){var i=e.row,a=e.col,s=document.querySelector('.chess-square[data-row="'.concat(i,'"][data-col="').concat(a,'"]')),c=s.querySelector(".chess-piece"),l=t.turnsUntilDestruction[o],u=r.getCurrentTurnCount();s?(console.log("about to call petrifyElement with",c),r.petrifyElement(c,u,l,n)):console.error("No element found at row ".concat(i,", col ").concat(a))}))}},{key:"petrifyElement",value:function(e,t,n){console.log("Petrifying element:",e),e.classList.add("petrified"),e.dataset.petrifiedOnTurn=t,e.dataset.turnsUntilDestruction=n,this.createPetrifiTimer(e,n)}},{key:"applyPetrification",value:function(e,t){var n=this;e.forEach((function(e){var r=t.turnsPetrified;n.petrifyElement(e,r,t)}))}},{key:"createPetrifiTimer",value:function(e,t,n,r){var o=document.createElement("span");o.className="petrification-timer",o.textContent=t,e.appendChild(o)}},{key:"getCurrentTurnCount",value:function(){var e=document.querySelector("#turn-count-display");if(e){var t=e.textContent.match(/\d+/);if(t)return parseInt(t[0],10)}return-1}},{key:"updatePetrifiedPieces",value:function(){var e=this;document.querySelectorAll(".petrified").forEach((function(t){var n=parseInt(t.dataset.turnsUntilDestruction,10);(n-=1)<=0?e.clearPetrification(t):(t.dataset.turnsUntilDestruction=n,e.updatePetrificationIndicator(t))}))}},{key:"updatePetrifyExpiration",value:function(e){var t=parseInt(e.dataset.petrifiedOnTurn,10),n=parseInt(e.dataset.turnsUntilDestruction,10),r=Math.floor((this.getCurrentTurnCount()-t)/2);if(r>0&&(n-=r,e.dataset.turnsUntilDestruction=n,this.updatePetrificationIndicator(e),n<=0)){var o=e.parentNode,i=o.getAttribute("data-col"),a=o.getAttribute("data-row");console.log("parent",o,"row",a,"col",i),this.forceRemove(a,i),e.classList.remove("petrified"),e.removeAttribute("data-turnsUntilDestruction");var s=e.querySelector(".petrification-indicator");s&&s.remove()}}},{key:"updatePetrificationIndicator",value:function(e){console.log("updatePetrificationIndicator function called with:",e);var t=parseInt(e.dataset.turnsUntilDestruction,10),n=e.querySelector(".petrification-timer");n&&(n.textContent=t)}},{key:"attemptToTransferPetrification",value:function(e){if(console.log("attemptToTransferPetrification function called for:",e),Math.random()<=.7){console.log("petrification probability is correct");var t=document.querySelectorAll(".chess-piece.".concat(e,"-pawn:not(.petrified)"));if(console.log("Ally pieces for potential petrification:",t),t.length>0){var n=t[Math.floor(Math.random()*t.length)];console.log("randomAlly",n),n.classList.add("petrified"),n.dataset.petrifiedOnTurn=this.getCurrentTurnCount(),n.dataset.turnsUntilDestruction=1,this.createPetrifiTimer(n,1)}}}},{key:"selectRandomPieces",value:function(e,t){console.log("selectRandomPiece function entered, numbPcs being :",t);for(var n=Array.from(e),r=n.length-1;r>0;r--){var o=Math.floor(Math.random()*(r+1)),i=[n[o],n[r]];n[r]=i[0],n[o]=i[1]}return n.slice(0,t)}},{key:"clearPetrification",value:function(e){e.classList.remove("petrified"),e.removeAttribute("data-petrifiedOnTurn"),e.removeAttribute("data-turnsUntilDestruction");var t=e.querySelector(".petrification-timer");t&&t.remove()}},{key:"applyChessquakeEffect",value:function(e){var t=this;console.log("applyChessquakeEffect function entered"),document.querySelector("#chessboard");var n=document.querySelectorAll(".chess-square.event-listener-attached.has-piece");console.log("pieces",n),n.forEach((function(n){var r=Math.random();r<.01?t.removepPiece(e,n):r<.009?t.movePieceToRandomSquare(e,n):r<.1&&t.swapPiece(n)}));var r=document.querySelectorAll(".chess-square:not(.has-piece)");console.log("emptySquares",r),r.forEach((function(n){var r=Math.random();r<.05?t.createMagmaSquare(e,n):r<.08?t.createHole(e,n):r<.12&&t.createRock(e,n)}))}},{key:"removepPiece",value:function(e,t){console.log("removepiece function called for :",t);var n=t.getAttribute("data-row"),r=t.getAttribute("data-col");this.forceRemove(n,r)}},{key:"movePieceToRandomSquare",value:function(e,t){console.log("Moving piece to a random square:",t);var n=t.querySelector(".chess-piece"),r=t.getAttribute("data-row"),o=t.getAttribute("data-col"),i=document.querySelectorAll(".chess-square:not(.has-piece)");if(0!==i.length){var a=i[Math.floor(Math.random()*i.length)],s=a.getAttribute("data-row"),c=a.getAttribute("data-col");this.forceMove(n,r,o,s,c)}else console.log("No empty squares available for movement.")}},{key:"swapWithRandomPiece",value:function(e,t){console.log("removepiece function called")}},{key:"createMagmaSquare",value:function(e,t){console.log("createMagmaSquare function called for:",t),t.classList.add("magma-square");var n=parseInt(t.getAttribute("data-row"),10),r=parseInt(t.getAttribute("data-col"),10);this.game.board[n][r]="magma"}},{key:"createHole",value:function(e,t){var n=this;console.log("createHole function called for:",t),t.classList.add("hole-square");var r=parseInt(t.getAttribute("data-row"),10),o=parseInt(t.getAttribute("data-col"),10);this.game.board[r][o]="hole",t.addEventListener("pieceLanded",(function(){var r=document.querySelectorAll(".chess-square:not(.has-piece)");r.length>0&&(r[Math.floor(Math.random()*r.length)],n.movePieceToRandomSquare(e,t))}))}},{key:"createRock",value:function(e,t){console.log("createRock function called for:",t),t.classList.add("rock-square");var n=parseInt(t.getAttribute("data-row"),10),r=parseInt(t.getAttribute("data-col"),10);this.game.board[n][r]="rock",this.game.board[n][r]="rock"}},{key:"triggerPieceLanding",value:function(e){var t=new Event("pieceLanded");e.dispatchEvent(t)}},{key:"split",value:function(){this.isSplit||"King"===this.type||"Pawn"===this.type||(this.isSplit=!0)}},{key:"canMergeWith",value:function(e){return this.isSplit&&e.isSplit&&this.type===e.type&&this.color===e.color&&this.areAdjacent(e)}},{key:"mergeWith",value:function(e){this.canMergeWith(e)&&(this.isSplit=!1,e.isSplit=!1,this.splitPart=null,e.splitPart=null)}},{key:"castStickOfTheForestSpell",value:function(){console.log("castStickOfTheForestSpell function called")}},{key:"assignRandomElement",value:function(e){var t=Math.floor(Math.random()*e.length);this.seedElement=e[t]}},{key:"growSeed",value:function(){this.seedStage>0&&this.seedStage<MAX_GROWTH_STAGE&&this.seedStage++}},{key:"activateTreeAbility",value:function(e){if(this.seedStage===MAX_GROWTH_STAGE){switch(this.seedElement){case"Fire":case"Frost":this.castFirePlantSpell();break;case"Stone":this.castStonePlantSpell();break;case"Light":this.castLightPlantSpell();break;case"Mystic":this.castMysticPlantSpell();break;case"Aqua":this.castWaterPlantSpell();break;case"Earth":this.castEarthPlantSpell();break;case"Whirlwind":this.castWindPlantSpell();break;case"Quake":this.castQuakePlantSpell()}this.seedStage=0}}},{key:"checkAndTriggerCombo",value:function(){var e=this.getBoardElements(),t=this.getRandomElement(e),n={FireWater:this.triggerInfernoWave(),EarthAir:this.triggerSandstormDance(),LightShadow:this.triggerEclipseMirage(),FrostFire:this.triggerThermalShock(),MysticNature:this.triggerVerdantResurgence(),WaterAir:this.triggerHurricaneSurge(),ShadowFire:this.triggerDarkFlame(),NatureFrost:this.triggerIcyBloom(),MysticLight:this.triggerArcaneIllumination(),AirShadow:this.triggerWhisperingShadows(),WaterMystic:this.triggerReflectionPool(),EarthFrost:this.triggerFrozenGround(),FireNature:this.triggerWildfireGrowth(),LightAir:this.triggerRadiantWind(),ShadowEarth:this.triggerTerrifyingQuake(),MysticAir:this.triggerEtherealBreeze()}[this.element+t];n&&n.call(this)}},{key:"rollDiceForSpell",value:function(){return Math.floor(4*Math.random())+1+Math.floor(4*Math.random())+1}},{key:"selectRandomPiece",value:function(e){var t=Array.from(document.querySelectorAll(".chess-piece.".concat(e,"-pawn, \n         .chess-piece.").concat(e,"-rook, \n         .chess-piece.").concat(e,"-bishop, \n         .chess-piece.").concat(e,"-knight, \n         .chess-piece.").concat(e,"-queen, \n         .chess-piece.").concat(e,"-king")));return 0===t.length?(console.error("No pieces found for player:",e),null):t[Math.floor(Math.random()*t.length)]}},{key:"castDiceOfDestinySpell",value:function(){var e=this,t=this.rollDiceForSpell(),n=0,r=2*t,o=setInterval((function(){var t=n%2==0?"white":"black",i=e.selectRandomPiece(t);i&&e.forceRandomMove(i),++n>=r&&clearInterval(o)}),1e3)}},{key:"castDigitzKingSpell",value:function(){var e=this;this.assignRowClassesToPawns(),console.log("Casting Number King Spell");var t="white"===this.color?"black":"white",n=document.querySelectorAll(".chess-piece.".concat(this.color,"-pawn")),r=document.querySelectorAll(".chess-piece.".concat(t,"-pawn")),o=[].concat(c(n),c(r)),i=(document.querySelector("#chessboard"),Math.floor(151*Math.random())+1);console.log("allPawns",o);var a=0,s=new Map;o.forEach((function(t,n){setTimeout((function(){var r=t.closest(".chess-square"),i=r.dataset.row,a=e.createNumberBox(n);r.appendChild(a),"0"===i?a.classList.add("bottom-box"):"7"===i&&a.classList.add("top-box");var c=0,l=Math.floor(11*Math.random())+5,u=setInterval((function(){var n=Math.floor(151*Math.random());a.textContent=n,++c>=l&&(clearInterval(u),s.set(t,n),s.size===o.length&&e.applySpellEffects(s))}),100)}),a),a+=500})),this.displayKingsNumber(i)}},{key:"assignRowClassesToPawns",value:function(){console.log("assignRowClassesToPawns called"),document.querySelectorAll(".chess-piece.pawn").forEach((function(e){var t=e.closest(".chess-square").dataset.row;"0"===t?e.classList.add("top-row"):"7"===t?e.classList.add("bottom-row"):e.classList.add("middle-row")}))}},{key:"displayKingsNumber",value:function(e){var t=document.createElement("div");t.textContent="King's Number: ".concat(e),t.classList.add("kings-number-display"),document.body.appendChild(t),setTimeout((function(){return t.style.opacity=0}),2e3),setTimeout((function(){return t.remove()}),3e3)}},{key:"createNumberBox",value:function(e){console.log("createNumberBox FUCNCTION CALLED ");var t=document.createElement("div");return t.classList.add("number-box"),t.style.backgroundColor=this.getRandomColor(e),t}},{key:"updateNumberBoxColor",value:function(e,t,n){var r=this.getBaseColor(n),o=t%256,i="rgb(".concat(r.r+o,", ").concat(r.g+o,", ").concat(r.b+o,")");e.style.backgroundColor=i;var a=this.isLightColor(i)?"black":"white";e.style.color=a}},{key:"isLightColor",value:function(e){var t=e.match(/\d+/g);return(.299*t[0]+.587*t[1]+.114*t[2])/255>.5}},{key:"getRandomColor",value:function(e){return console.log("getRandomColor FUCNCTION CALLED "),"rgb(".concat(50*e%256,", ").concat(100*e%256,", ").concat(150*e%256,")")}},{key:"getBaseColor",value:function(e){return{r:50*e%256,g:100*e%256,b:150*e%256}}},{key:"getPawnRow",value:function(e){var t=e.closest(".chess-row");return t?parseInt(t.getAttribute("data-row"),10):-1}},{key:"positionNumberBox",value:function(e,t){t<=1?(e.style.bottom="auto",e.style.top="100%"):(e.style.bottom="100%",e.style.top="auto")}},{key:"castEnchantedGroundSpell",value:function(){var e=this;console.log("castEnchantedGroundSpell function called");for(var t=Array.from(document.querySelectorAll(".chess-square")).filter((function(e){return!e.classList.contains("has-piece")})),n=new Set;n.size<5&&t.length>0;){var r=Math.floor(Math.random()*t.length),o=t[r];n.add(o.id),t.splice(r,1)}return n.forEach((function(t){var n=document.getElementById(t);n&&(n.classList.add("enchanted-ground"),n.style.backgroundColor=e.color,n.style.border="2px solid black")})),n}},{key:"handleMagicalCardEffect",value:function(e){var t=this;console.log("handleMagicalCardEffect function called with",e);var n={upgrade:{effect:function(){return t.upgradePiece(e)},description:"The piece is promoted rabdomly created."},downgrade:{effect:function(){return t.downgradePiece(e)},description:"The piece is demoted."},swap:{effect:function(){return t.swapPiece(e)},description:"swap two allies randomPiece."},teleport:{effect:function(){return t.teleportPiece(e)},description:"teleport the piece random empty square."},freeze:{effect:function(){return t.freezePiece(e)},description:"Cannot move for two turns..."}},r=n[Object.keys(n)[Math.floor(Math.random()*Object.keys(n).length)]];return console.log("Selected Effect:",r.description),r.effect(),r.description}},{key:"showSpellInteraction",value:function(e,t){console.log("showSpellInteraction function entered description being:",t),this.startShufflingAnimation();var n=document.getElementById("spell-interaction"),r=document.getElementById("spell-name"),o=document.getElementById("spell-description");r.textContent=e,o.textContent=t,n.classList.remove("hidden"),n.classList.add("visible"),setTimeout((function(){n.classList.remove("visible"),n.classList.add("hidden")}),9e3)}},{key:"startShufflingAnimation",value:function(){console.log("startShufflingAnimation function called");var e=document.getElementById("card-container");e.innerHTML="";for(var t=0;t<5;t++){var n=document.createElement("div");n.classList.add("card"),e.appendChild(n)}}},{key:"upgradePiece",value:function(e){console.log("Upgraded piece called for alliance:",e);var t=Array.from(document.querySelectorAll(".chess-piece"));console.log("Pieces",t);var n=e.parentNode.dataset.color,r=t.filter((function(e){var t=e.parentNode;return console.log("parentSquare",t),console.log("parentSquare.dataset.type",t.dataset.type),console.log("parentSquare.dataset.color",t.dataset.color),"pawn"===t.dataset.type&&t.dataset.color===n}));console.log("Allied Pawns",r);var o=this.getRandomElement(r);if(o){var i=this.getRandomElement(["knight","rook","bishop"]),a=o.parentNode;a.dataset.type=i,o.className="chess-piece ".concat(e,"-").concat(i),this.updatePieceAppearanceAndFunctionality(o,a,n,i)}else console.error("No eligible pawns found for upgrade.")}},{key:"downgradePiece",value:function(e){console.log("downgradePiece called with alliance piece",e);var t=e.parentNode,n=t.dataset.color;console.log("Alliance color:",n);var r=Array.from(document.querySelectorAll(".chess-piece.".concat(n,"-rook, .chess-piece.").concat(n,"-bishop, .chess-piece.").concat(n,"-knight")));console.log("Filtered pieces:",r);var o=this.getRandomElement(r);o?this.updatePieceAppearanceAndFunctionality(o,t,n,"pawn"):console.error("No eligible pieces found for downgrade.")}},{key:"getRandomElement",value:function(e){return console.log("getRandomElement  called"),e[Math.floor(Math.random()*e.length)]}},{key:"updatePieceAppearanceAndFunctionality",value:function(e,t,n,r){console.log("updatePieceAppea function called newType",r);var o=e.parentNode,i=r.charAt(0).toUpperCase()+r.slice(1);o.removeAttribute("data-type"),o.setAttribute("data-type",r),o.style.backgroundImage="url('img/".concat(n).concat(i,".png')"),console.log("parent",o),e.className="chess-piece ".concat(n,"-").concat(r),e.style.backgroundImage="url('img/".concat(n).concat(i,".png')")}},{key:"swapPiece",value:function(){var e=this;console.log("swapTwoPieces called");var t=Array.from(document.querySelectorAll(".chess-square.has-piece"));if(t.length<2)console.error("Not enough pieces on the board to swap.");else{var n=this.selectTwoDistinctRandomIndexes(t.length),r=t[n[0]],o=t[n[1]];r.style.backgroundImage="",o.style.backgroundImage="",["data-type","data-color"].forEach((function(t){e.swapAttributes(r,o,t)})),this.swapChessPieces(r,o),this.updateInternalGameStateForSwap(r,o),console.log("Two pieces swapped successfully.")}}},{key:"selectTwoDistinctRandomIndexes",value:function(e){var t,n=Math.floor(Math.random()*e);do{t=Math.floor(Math.random()*e)}while(n===t);return[n,t]}},{key:"swapAttributes",value:function(e,t,n){var r=e.getAttribute(n);e.setAttribute(n,t.getAttribute(n)),t.setAttribute(n,r)}},{key:"swapChessPieces",value:function(e,t){var n=e.querySelector(".chess-piece"),r=t.querySelector(".chess-piece"),o=document.createElement("div");o.appendChild(n.cloneNode(!0)),e.replaceChild(r.cloneNode(!0),n),t.replaceChild(o.firstChild,r)}},{key:"updateInternalGameStateForSwap",value:function(e,t){}},{key:"banishPiece",value:function(e){console.log("banish function called"),e.remove()}},{key:"shieldPiece",value:function(e){console.log("shield function called"),e.dataset.shielded="true",setTimeout((function(){return e.dataset.shielded="false"}),3*turnDuration)}},{key:"teleportPiece",value:function(e){console.log("teleport function called");var t=document.querySelectorAll(".chess-square:not(.has-piece)");console.log("emptySquares",t);var n=t[Math.floor(Math.random()*t.length)];console.log("randomSquare",n);var r=e.parentNode.dataset.color,o=Array.from(document.querySelectorAll(".chess-piece.".concat(r,"-pawn, \n                                                              .chess-piece.").concat(r,"-rook, \n                                                              .chess-piece.").concat(r,"-bishop, \n                                                              .chess-piece.").concat(r,"-knight, \n                                                              .chess-piece.").concat(r,"-queen")));console.log("Allied pieces except for the king:",o);var i=o[Math.floor(Math.random()*o.length)];if(console.log("Random Piece selected for teleport:",i),i&&n){var a=i.parentNode,s=a.getAttribute("data-type"),c=a.getAttribute("data-color");a.removeChild(i),a.classList.remove("has-piece","event-listener-attached"),a.removeAttribute("data-type"),a.removeAttribute("data-color"),a.removeEventListener("click",this.boundHandleClick),n.appendChild(i),n.setAttribute("data-type",s),n.setAttribute("data-color",c),n.classList.add("has-piece","event-listener-attached"),n.addEventListener("click",this.boundHandleClick),console.log("Teleported ".concat(i.className," to square ").concat(n.id))}else console.error("Teleportation failed: No piece or square selected.")}},{key:"freezePiece",value:function(){var e=this;console.log("freeze function called");var t=this.game.currentPlayer;console.log("currentPlayerColor",t);var n="white"===t?"black":"white";console.log("Enemy color:",n);var r=Array.from(document.querySelectorAll(".chess-piece.".concat(t,"-pawn, \n                                                              .chess-piece.").concat(t,"-rook, \n                                                              .chess-piece.").concat(t,"-bishop, \n                                                              .chess-piece.").concat(t,"-knight, \n                                                              .chess-piece.").concat(t,"-queen")));console.log("Enemy pieces:",r);for(var o=this.turnCount,i=Math.floor(4*Math.random())+1,a=function(){var t=Math.floor(Math.random()*r.length),n=r[t];n.parentNode.classList.add("frozen-square"),n.classList.add("frozen-piece");var i=Math.floor(3*Math.random())+2,a=o+i,s=setInterval((function(){e.turnCount>=a&&(n.dataset.frozen="false",clearInterval(s))}),1e3)},s=0;s<i&&s<r.length;s++)a()}},{key:"chaosShift",value:function(e){console.log("chaosShift function called");var t=e.parentNode,n=t.getAttribute("data-color");console.log("parent",t);var r=this.currentPlayer;console.log("selectedPiece.color",t.getAttribute("data-color")),console.log("currentPlayerColor",r);var o=Array.from(document.querySelectorAll(".chess-piece.".concat(n,"-pawn, \n                                                              .chess-piece.").concat(n,"-rook, \n                                                              .chess-piece.").concat(n,"-bishop, \n                                                              .chess-piece.").concat(n,"-knight, \n                                                              .chess-piece.").concat(n,"-queen")));console.log("alliedPieces pieces:",o);var i=Array.from(o).map((function(e){var t=e.parentNode;return{row:t.getAttribute("data-row"),col:t.getAttribute("data-col")}}));this.shuffleArray(i),o.forEach((function(t,n){var r=i[n],o="square-".concat(r.row,"-").concat(r.col),a=document.getElementById(o);a&&!a.contains(t)&&(t.parentNode.removeChild(t),a.appendChild(t),a.dataset.type=e.dataset.type,a.dataset.color=e.dataset.color)}))}},{key:"shuffleArray",value:function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=[e[n],e[t]];e[t]=r[0],e[n]=r[1]}}},{key:"blinkStep",value:function(e){console.log("Blink Step activated for",e.id),this.forceRandomMove(e),e.dataset.blinkStep="active"}},{key:"castChaosTheorySpell",value:function(){var e=this;console.log("chaostheoryspell entered"),document.dispatchEvent(this.chaosTheoryStartEvent),setTimeout((function(){document.dispatchEvent(e.chaosTheoryEndEvent)}),6e4)}},{key:"performRandomMove",value:function(){var e=this.game.currentPlayer;console.log("playerColor",e);var t=Array.from(document.querySelectorAll(".chess-piece.".concat(e,"-pawn, \n                                                              .chess-piece.").concat(e,"-rook, \n                                                              .chess-piece.").concat(e,"-bishop, \n                                                              .chess-piece.").concat(e,"-knight")));console.log("alliedPieces pieces:",t);var n=t[Math.floor(Math.random()*t.length)],r=Array.from(document.querySelectorAll(".chess-square:not(.has-piece)"));if(r.length>0){var o=r[Math.floor(Math.random()*r.length)],i=parseInt(o.getAttribute("data-row"),10),a=parseInt(o.getAttribute("data-col"),10),s=parseInt(n.parentNode.getAttribute("data-row"),10),c=parseInt(n.parentNode.getAttribute("data-col"),10);console.log("Performing random move on piece :(".concat(n,") from (").concat(s,", ").concat(c,") to (").concat(i,", ").concat(a,")")),this.forceMove(n,s,c,i,a)}else console.log("No empty squares available to move the randomly selected piece.")}},{key:"showDiceRoll",value:function(e){var t=document.getElementById("dice-container");document.getElementById("dice-image").src="img/dice".concat(e,".png"),t.style.display="block",setTimeout((function(){t.style.display="none"}),2e3)}},{key:"rollDice",value:function(){var e=Math.floor(6*Math.random())+1;return this.showDiceRoll(e),e}},{key:"magneticPull",value:function(e){console.log("Magnetic Pull activated for selectedPiece",e);var t=e.parentNode,n=parseInt(t.getAttribute("data-row"),10),r=parseInt(t.getAttribute("data-col"),10),o="white"===e.dataset.color?-1:1;this.applyGravitationalField(e,n,r,o)}},{key:"applyGravitationalField",value:function(e,t,n){console.log("Applying Gravitational Field for",e);for(var r=t-1;r<=t+1;r++)for(var o=n-1;o<=n+1;o++)if(!(r===t&&o===n||r<0||r>=8||o<0||o>=8)){var i="square-".concat(r,"-").concat(o),a=document.getElementById(i);if(a&&a.classList.contains("has-piece")){var s=a.querySelector(".chess-piece");if(s&&s!==e){var c=s.parentNode,l=void 0;console.log("piece color",c.dataset.color),"white"===c.dataset.color?(l=Math.min(r+1,7),console.log("newRow",l)):l=Math.max(r-1,0),l!==r&&this.forceMove(s,r,o,l,o)}}}}},{key:"forceRandomMove",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];console.log("forceRandomMove called for:",e);var o,i,a,s,c=e.parentNode,l=parseInt(c.getAttribute("data-row")),u=parseInt(c.getAttribute("data-col"));do{o=Math.floor(8*Math.random()),i=Math.floor(8*Math.random()),s=(a=document.querySelector("[data-row='".concat(o,"'][data-col='").concat(i,"']")))&&!a.classList.contains("has-piece")&&(o!==l||i!==u),r&&(s=s&&!this.isWithinMiniBoard(o,i))}while(!s);this.forceMove(e,l,u,o,i),this.syncBoardState(),console.log("this context",this)}},{key:"isOutsideMiniBoard",value:function(e,t){return e<this.miniBoardArea.y1||e>this.miniBoardArea.y2||t<this.miniBoardArea.x1||t>this.miniBoardArea.x2}},{key:"activateWindOfChangeSpell",value:function(){var e=new SeededRNG(this.game.turnCount);console.log("rng",e);var t=document.querySelectorAll(".chess-piece.white-pawn, .chess-piece.black-pawn"),n=this.game.turnCount;t.forEach((function(e){var t,r=Math.floor(4*Math.random())+2;e.dataset.spellExpirationTurn=n+r;var o=["forward","left","right","diagonalLeft","diagonalRight"],i=o[Math.floor(Math.random()*o.length)];(t=e.classList).remove.apply(t,o),e.classList.add(i,"pawn-random-move")}))}},{key:"determineMovement",value:function(){switch(this.type){case"Pawn":return"forward";case"Rook":return"straight";case"Knight":return"L-shape";case"Bishop":return"diagonal";default:return"default"}}},{key:"applySpell",value:function(e){this.currentMovement=e,this.isUnderSpell=!0}},{key:"revertSpell",value:function(){this.currentMovement=this.originalMovement,this.isUnderSpell=!1}},{key:"placeTower",value:function(){var e=document.querySelectorAll(".chess-square:not(.has-piece)");if(e.length>0){var t=e[Math.floor(Math.random()*e.length)];t.classList.add("TOWER"),t.innerHTML='<img src="path/to/tower-icon.png" alt="Tower">';var n=t.getAttribute("id").split("-").slice(1).map(Number);this.towers.push({x:n[0],y:n[1]})}else console.log("No unoccupied squares available.")}},{key:"castTowerSpell",value:function(e){this.towerOfPowerActivated=!0,this.activationTurn=e,this.placeTower()}},{key:"checkTowerCountAndActivateBeam",value:function(){4===this.towers.length&&this.activateBeamOfLight()}},{key:"checkAndPlaceTowerEachTurn",value:function(e){this.towerOfPowerActivated&&(e-this.activationTurn)%2==0&&this.placeTower()}},{key:"createBeamAndApplyEffects",value:function(){var e=this;this.towers.forEach((function(t,n){if(n<e.towers.length-1){var r=e.towers[n+1];e.drawBeam(t,r)}e.checkAndApplyBeamEffects(t)}))}},{key:"drawBeam",value:function(e,t){}},{key:"checkAndApplyBeamEffects",value:function(e){}},{key:"updateTurnCount",value:function(e){console.log("updateTurnCount function called"),console.log("Updating turn count to",e),document.getElementById("turn-count-display").textContent="Turn: ".concat(e);try{var t=new CustomEvent("turnChanged",{detail:{turnCount:e}});document.dispatchEvent(t)}catch(e){console.error("Error dispatching turnChanged event:",e)}}},{key:"castRealityShatterSpell",value:function(e,t){this.isRealityShattered=!0,this.storePiecePositions(),this.createMiniBoardContainers(),this.hideMainBoard(),this.divideBoardIntoMiniBoards(e,t)}},{key:"storePiecePositions",value:function(){document.querySelectorAll(".chess-piece").forEach((function(e){var t=e.parentNode;e.setAttribute("data-original-row",t.getAttribute("data-row")),e.setAttribute("data-original-col",t.getAttribute("data-col"))}))}},{key:"divideBoardIntoMiniBoards",value:function(){var e=this;console.log("divideBoardIntoMiniBoards function called"),document.querySelectorAll(".chess-square.has-piece").forEach((function(t){var n=parseInt(t.getAttribute("data-row"),10),r=parseInt(t.getAttribute("data-col"),10),o=t.querySelector(".chess-piece");if(o){var i=e.getMiniBoard(n,r),a=document.getElementById("".concat(i,"-mini-board"));a?a.appendChild(o):console.error("Mini-board container not found for ID: ".concat(i,"-mini-board"))}})),this.isRealityShattered=!0}},{key:"hideMainBoard",value:function(){document.getElementById("chessboard").style.display="none",document.getElementById("mini-board-container").style.display="block"}},{key:"createMiniBoardContainers",value:function(){var e=document.createElement("div");e.className="mini-board-container",["topLeft","topRight","bottomLeft","bottomRight"].forEach((function(t){var n=document.createElement("div");n.className="mini-board",e.appendChild(n)})),document.body.appendChild(e)}},{key:"getMiniBoard",value:function(e,t){return e<4&&t<4?"topLeft":e<4&&t>=4?"topRight":e>=4&&t<4?"bottomLeft":e>=4&&t>=4?"bottomRight":void 0}},{key:"createEmptyMiniBoard",value:function(){return Array(4).fill(null).map((function(){return Array(4).fill(null)}))}},{key:"mergeMiniBoardsBack",value:function(){document.querySelectorAll(".chess-piece").forEach((function(e){e.parentNode,document.querySelector('.chess-square[data-row="'.concat(e.dataset.row,'"][data-col="').concat(e.dataset.col,'"]')).appendChild(e)})),this.isRealityShattered=!1}},{key:"castAutoSpellSpell",value:function(e,t,n){switch(e){case"staff-of-fire":this.preparePawnCreation("FirePawn");break;case"staff-of-water":this.preparePawnCreation("WaterPawn"),console.log("preparePawnCreation successfully called on WaterPawn");break;case"adept-wand":this.castAdeptWandSpell(t,n);break;case"staff-of-light":chessPiece.castRealityShatterSpell();case"staff-of-earth":chessPiece.preparePawnCreation("Earthpawn");break;case"ice":case"novice-staff":break;case"iced-out":chessPiece.castFrostGridSpell();break;case"apprentice-wand":chessPiece.activateDaggerSpell();break;case"lightsaber":chessPiece.castLightsaberSpell();break;case"hourglass":break;case"staff-of-chaos":chessPiece.chaosWarp(t);break;case"staff-of-the-necromancer":chessPiece.castNecronomancerSpell();break;case"apprentice-staff":chessPiece.castDigitzKingSpell();break;case"apprentice-wand":case"staff":break;case"orbs-of-illusion":chessPiece.castChaosTheorySpell();break;case"adept-wand":chessPiece.castAdeptWandSpell(chessBoard,chessGame)}}},{key:"drawSpell",value:function(){var e=Math.floor(Math.random()*this.spellDeck.length);return this.spellDeck[e]}},{key:"activateShadowMerge",value:function(){this.selectPiecesForMerge()}},{key:"mergePieces",value:function(e,t){var n=this,r=this.createMergedPiece(e,t);this.placeMergedPieceOnBoard(r),this.mergedPieces.push(r),setTimeout((function(){return n.splitMergedPiece(r)}),2*turnDuration)}},{key:"createMergedPiece",value:function(e,t){return mergedPiece}},{key:"placeMergedPieceOnBoard",value:function(e){}},{key:"splitMergedPiece",value:function(e){}},{key:"capturePiece",value:function(e,t){}},{key:"castDaggerSpell",value:function(e){var t=this;console.log("Casting Dagger Spell");var n="white"===this.currentPlayer?"black":"white";console.log(n);var r=document.querySelectorAll(".chess-piece.".concat(n,"-pawn"));console.log("enemyPieces",r);var o=e.seed;r.forEach((function(n){var r=document.createElement("img");r.src="img/dagger.png",r.classList.add("dagger"),n.appendChild(r);var i=t.nextRandom(e.multiplier,o,e.increment,e.modulus);if(o=i.newSeed,i.nextValue<.33){var a=n.parentNode;a&&a.removeChild(n)}}))}},{key:"activateDaggerSpell",value:function(e){this.castDaggerSpell(e)}},{key:"getRandomDirection",value:function(){var e=["left","right","top","bottom"];return e[Math.floor(Math.random()*e.length)]}},{key:"applyGravitationalSpell",value:function(){console.log("Casting Gravitational Spell");var e=this.getRandomDirection();console.log("Gravitational pull towards: ".concat(e));for(var t=0;t<8;t++)for(var n=0;n<8;n++)if(this.getPieceFromCoords(t,n)){var r=l(this.calculateNewPosition(t,n,e),3),o=r[0],i=r[1];r[2]?this.movePiece(t,n,o,i):Math.random()<.25&&this.removePiece(t,n)}}},{key:"calculateNewPosition",value:function(e,t,n){for(var r=e,o=t,i=!1;;)switch(n){case"left":if(!(o>0)||this.getPieceFromCoords(r,o-1))return[r,o,i];o--,i=!0;break;case"right":if(!(o<7)||this.getPieceFromCoords(r,o+1))return[r,o,i];o++,i=!0;break;case"top":if(!(r>0)||this.getPieceFromCoords(r-1,o))return[r,o,i];r--,i=!0;break;case"bottom":if(!(r<7)||this.getPieceFromCoords(r+1,o))return[r,o,i];r++,i=!0}}},{key:"movePiece",value:function(e,t,n,r){}},{key:"removePiece",value:function(e,t){}},{key:"castNecronomancerSpell",value:function(){console.log("Casting Chronomancer Spell");var e=this.currentPlayer,t="white"===e?"black":"white";this.reviveCapturedPieces(e),console.log("check after reviveCapturedPieces"),this.removeAndStealEnemyPieces(t,e)}},{key:"reviveCapturedPieces",value:function(e){var t=this;this.getCapturedPieces(e).forEach((function(e){Math.random()<.1&&t.placePieceOnBoard(e)}))}},{key:"removeAndStealEnemyPieces",value:function(e,t,n){var r=this;console.log("removeAndStealEnemyPieces function called"),document.querySelectorAll(".chess-piece.".concat(e,"-pawn")).forEach((function(e){if(Math.random()<.07){var n=e.parentNode;r.getPieceType(e),n.removeChild(e),r.addPieceToPlayerSet(e,t)}}))}},{key:"getPieceType",value:function(e){return console.log("getPieceType entered with :",e),e.classList.contains("white-pawn")||e.classList.contains("black-pawn")?"pawn":e.classList.contains("white-rook")||e.classList.contains("black-rook")?"rook":e.classList.contains("white-king")?"king":e.classList.contains("white-queen")?"queen":e.classList.contains("white-bishop")?"bishop":e.classList.contains("white-knight")?"knight":e.classList.contains("black-king")?"king":e.classList.contains("black-queen")?"queen":e.classList.contains("black-bishop")?"bishop":e.classList.contains("black-knight")?"knight":"unknown"}},{key:"getCapturedPieces",value:function(e){return this.capturedPieces?this.capturedPieces.filter((function(t){return t.color===e})):(console.error("Captured pieces data is not available."),[])}},{key:"placePieceOnBoard",value:function(e,t){if(t.querySelector(".chess-piece"))console.log("Cannot place the piece, the square is not empty.");else{t.appendChild(e);var n=parseInt(t.getAttribute("data-row"),10),r=parseInt(t.getAttribute("data-col"),10);this.game.board[n][r]=e}}},{key:"addPieceToPlayerSet",value:function(e,t,n){this.syncBoardState();var r=e.classList.value.split(" ")[1].split("-")[1];if(r){var o=document.createElement("div");o.classList.add("chess-piece","".concat(t,"-").concat(r)),o.style.backgroundImage="url('img/".concat(t,"-").concat(r,".png')");var i=document.querySelectorAll(".chess-square:not(.has-piece)");if(0!==i.length){var a=i[Math.floor(Math.random()*i.length)];console.log("targetSquare",a),"images/".concat(a.color,"_").concat(a.type,".png"),a.appendChild(o),a.classList.add("has-piece");var s=parseInt(a.getAttribute("data-row"),10),c=parseInt(a.getAttribute("data-col"),10);a.style.gridRow=s+1,a.style.gridColumn=c+1,a.setAttribute("data-type",r),a.setAttribute("data-color",t),o.addEventListener("click",this.boundHandleClick,{once:!0}),o.dataset.listenerAttached="true",console.log("this.game",this.game),console.log("this.game.board in addPieceToPlayerSet before syncBoardState",this.game.game.board),console.log("this.game.board in addPieceToPlayerSet before syncBoardState",this.game.board),console.log("newPiece value :",o),this.game.game.board[s][c]={type:r,color:t},console.log("this.game.game.board in addPieceToPlayerSet after syncBoardState",this.game.game.board),console.log("this.game.board in addPieceToPlayerSet after syncBoardState",this.game.board)}else console.log("No empty squares available to place the piece.")}else console.error("Could not determine the piece type from the element",e)}},{key:"activateGambitOfAges",value:function(){var e=this;console.log("Casting gambitOfAges");var t="white"===this.currentPlayer?"black":"white";console.log(t),document.querySelector("#chessboard");var n=document.querySelectorAll(".chess-piece.".concat(t,"-pawn")),r=document.querySelectorAll(".chess-piece.".concat(this.currentPlayer,"-pawn"));console.log("enemyPawn",n),console.log("alliedPawn",r);var o=Array.from(document.querySelectorAll(".chess-piece.".concat(t,"-rook, \n                                                                       .chess-piece.").concat(t,"-bishop, \n                                                                       .chess-piece.").concat(t,"-knight"))),i=Array.from(document.querySelectorAll(".chess-piece.".concat(this.currentPlayer,"-rook, \n                                                                       .chess-piece.").concat(this.currentPlayer,"-bishop, \n                                                                       .chess-piece.").concat(this.currentPlayer,"-knight"))),a=this.randomlySelectPieces(n,2),s=this.randomlySelectPieces(o,2),c=this.randomlySelectPieces(i,2),l=this.randomlySelectPieces(r,2);console.log("alliedPawnSelected",a),console.log("alliedUpgradedPieceSelected",s),console.log("alliedPawnSelected",l),console.log("alliedUpgradedPieceSelected",c),c.forEach((function(t){return e.enhancePiece(t)})),s.forEach((function(t){return e.enhancePiece(t)})),a.forEach((function(t){return e.enhancePiece(t)})),l.forEach((function(t){return e.enhancePiece(t)}))}},{key:"enhancePiece",value:function(e){console.log("Enhancing piece:",e),e.dataset.isEnhanced="true",e.style.boxShadow="0 0 10px 5px rgba(255, 215, 0, 0.7)"}},{key:"castLightsaberSpell",value:function(e){var t=this;console.log("Casting Lightsaber Spell with rng:",e);var n=e.seed;this.playLightsaberAnimation(e,n,(function(e){t.removePiecesInColumn(e)}))}},{key:"removePiecesInColumn",value:function(e){console.log("Column Index for removal:",e);for(var t=0;t<8;t++){var n="square-".concat(t,"-").concat(e),r=document.getElementById(n);console.log("square",r),r&&r.classList.contains("has-piece")&&this.isEnemyPiece(r)&&(console.log("Enemy piece detected at ".concat(t,", ").concat(e,":"),r),this.forceRemove(t,e))}}},{key:"isEnemyPiece",value:function(e){if(!this.currentPlayer)return console.log("this.currentPlayer",this.currentPlayer),console.error("Current player color is not defined."),!1;console.log("Current player color: ".concat(this.currentPlayer));var t=e.getAttribute("data-color");return console.log("Piece color on square:",t),t!==this.currentPlayer}},{key:"playLightsaberAnimation",value:function(e,t){var n=this,r=new Audio("sound/lightsaber.mp3"),o=0,i=t,a=this.nextRandom(e.multiplier,i,e.increment,e.modulus),s=Math.floor(13*a.nextValue)+3;i=a.newSeed;var c=0,l=setInterval((function(){n.updateLightsaberColumn(o),r.play(),c++,o=(o+1)%8,c>=s&&(clearInterval(l),setTimeout((function(){var e=0===o?7:o-1;n.removePiecesInColumn(e)}),500))}),500)}},{key:"updateLightsaberColumn",value:function(e){var t=document.getElementById("lightsaber"),n=document.querySelector("#chessboard");console.log("chessBoard",n);var r=n.offsetWidth/8;t.style.left="".concat(e*r,"px"),t.style.width="".concat(r,"px"),t.style.display="block",setTimeout((function(){t.style.display="none"}),400)}},{key:"forceRemove",value:function(e,t){console.log("forceRemove function called for row:",e,"col:",t);var n="square-".concat(e,"-").concat(t),r=document.getElementById(n);if(r.getAttribute("data-color"),r.getAttribute("data-type"),console.log("square in forceRemove:",r),r){var o=r.querySelector(".chess-piece");console.log("piece to be removed:",o),o&&(r.removeChild(o),r.classList.remove("has-piece"),r.removeAttribute("data-color"),r.removeAttribute("data-type")),r.style.backgroundImage=""}}},{key:"getType",value:function(){return this.type}},{key:"getColor",value:function(){return this.color}},{key:"getPosition",value:function(e){return[this.row,this.col]}},{key:"setPosition",value:function(e,t){this.row=e,this.col=t}},{key:"playMoveSound",value:function(){var e=document.createElement("audio");e.src="/sounds/move.mp3",document.body.appendChild(e),e.play()}},{key:"playCaptureSound",value:function(){var e=document.createElement("audio");e.src="/sounds/capture.mp3",document.body.appendChild(e),e.play()}},{key:"playWrongSound",value:function(){var e=document.createElement("audio");e.src="/sounds/wrong.mp3",document.body.appendChild(e),e.play()}}],r=[{key:"resetCheckArray",value:function(){console.log("resetCheckArray function entered.");var e=new CustomEvent("resetValidPiecesToResolveCheck");window.dispatchEvent(e)}},{key:"switchTurn",value:function(){console.log("witchTurn entered with player :",this.currentPlayer),console.log("this.game",this.game,"chessGame",chessGame),this.game.currentPlayer="white"===this.game.currentPlayer?"black":"white",console.log(this.currentPlayer)}},{key:"activateSplitSpell",value:function(e){e.forEach((function(e){return e.split()}))}},{key:"castArcaneAnarchy",value:function(){var t=e.allPieces.filter((function(e){return"King"!==e.type&&"Queen"!==e.type})),n=t.map((function(e){return e.originalMovement})).sort((function(){return Math.random()-.5}));t.forEach((function(e,t){e.applySpell(n[t]||e.originalMovement)}))}},{key:"forceMove",value:function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(console.log("forceMove called with piece:",e,"fromRow:",t,"fromCol:",n,"toRow:",r,"toCol:",o),null!==t&&null!==n&&null!==r&&null!==o){var a=document.getElementById("square-".concat(t,"-").concat(n)),s=a.querySelector(".piece");console.log("pieceElement",s);var c=a.getAttribute("data-type"),l=a.getAttribute("data-color");console.log("pieceType",c,"pieceColor",l,"fromSquare",a),console.log("piece",e),a&&a.contains(e.pieceElement)?(a.classList.remove("has-piece","enchanted-ground","event-listener-attached"),a.removeAttribute("data-color"),a.removeAttribute("data-type"),a.removeAttribute("style"),a.removeChild(e.pieceElement)):console.error("Failed to find or remove piece from square (".concat(t,", ").concat(n,")"));var u=document.getElementById("square-".concat(r,"-").concat(o));if(u){var h=u.querySelector(".chess-piece");h&&h.dataset.color!==e.dataset.color&&u.removeChild(h),console.log("fromSquare",a),u.appendChild(e.pieceElement),u.classList.add("has-piece"),u.setAttribute("data-type",c),u.setAttribute("data-color",l),u.style.backgroundImage="url('img/".concat(l,"-").concat(c,".png')"),console.log("isRiftMove",i),i||(console.log("trying to addEventListener in forceMove"),e.pieceElement.addEventListener("click",this.boundHandleClick,{once:!0}))}else console.error("Failed to find target square at position (".concat(r,", ").concat(o,")"));i&&console.log("Rift-induced move completed.")}else console.error("Invalid move: Position out of bounds")}},{key:"forceRemove",value:function(e,t){console.log("forceRemove function called for row:",e,"col:",t);var n="square-".concat(e,"-").concat(t),r=document.getElementById(n);if(r.getAttribute("data-color"),r.getAttribute("data-type"),console.log("square in forceRemove:",r),r){var o=r.querySelector(".chess-piece");console.log("piece to be removed:",o),o&&(r.removeChild(o),r.classList.remove("has-piece"),r.removeAttribute("data-color"),r.removeAttribute("data-type")),r.style.backgroundImage=""}}}],n&&f(t.prototype,n),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();"undefined"!=typeof window&&"undefined"!=typeof document&&(document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementsByClassName("close-button")[0];e&&(console.log("Close button setup"),e.addEventListener("click",(function(){})))})),document.addEventListener("turnChanged",(function(e){console.log("turn changed"),chessPiece.placeTower(),chessPiece.checkTowerCountAndActivateBeam()})),document.getElementById("turn-count-display").addEventListener("turnChanged",(function(e){var t=e.detail.turnCount;console.log("Turn changed:",t),chessPiece.checkAndUpdateSpellEffects()})),document.addEventListener("turnChanged",function(e){console.log("trying to call checkAndUpdateSpellEffects"),chessPiece.checkAndUpdateSpellEffects()}.bind(void 0)))},4577:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function i(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}n.r(t),n.d(t,{SeededRNG:()=>a});var a=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modulus=4294967296,this.multiplier=1664525,this.increment=1013904223,this.seed=parseInt(t.slice(0,10),16)},(t=[{key:"next",value:function(){return this.seed=(this.multiplier*this.seed+this.increment)%this.modulus,this.seed/this.modulus}}])&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()},8499:(e,t,n)=>{"use strict";Promise.all([n.e(565),n.e(968)]).then(n.t.bind(n,1565,19)).then((function(e){e.default})).catch((function(e){return console.error("Failed to load crypto module:",e)}))}},l={};function u(e){var t=l[e];if(void 0!==t)return t.exports;var n=l[e]={id:e,loaded:!1,exports:{}};return c[e].call(n.exports,n,n.exports,u),n.loaded=!0,n.exports}u.m=c,e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},u.a=(o,i,a)=>{var s;a&&((s=[]).d=-1);var c,l,u,h=new Set,d=o.exports,f=new Promise(((e,t)=>{u=t,l=e}));f[t]=d,f[e]=e=>(s&&e(s),h.forEach(e),f.catch((e=>{}))),o.exports=f,i((o=>{var i;c=(o=>o.map((o=>{if(null!==o&&"object"==typeof o){if(o[e])return o;if(o.then){var i=[];i.d=0,o.then((e=>{a[t]=e,r(i)}),(e=>{a[n]=e,r(i)}));var a={};return a[e]=e=>e(i),a}}var s={};return s[e]=e=>{},s[t]=o,s})))(o);var a=()=>c.map((e=>{if(e[n])throw e[n];return e[t]})),l=new Promise((t=>{(i=()=>t(a)).r=0;var n=e=>e!==s&&!h.has(e)&&(h.add(e),e&&!e.d&&(i.r++,e.push(i)));c.map((t=>t[e](n)))}));return i.r?l:a()}),(e=>(e?u(f[n]=e):l(d),r(s)))),s&&s.d<0&&(s.d=0)},i=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,u.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);u.r(n);var r={};o=o||[null,i({}),i([]),i(i)];for(var a=2&t&&e;"object"==typeof a&&!~o.indexOf(a);a=i(a))Object.getOwnPropertyNames(a).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,u.d(n,r),n},u.d=(e,t)=>{for(var n in t)u.o(t,n)&&!u.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},u.f={},u.e=e=>Promise.all(Object.keys(u.f).reduce(((t,n)=>(u.f[n](e,t),t)),[])),u.u=e=>e+".bundle.js",u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a={},s="chessmos:",u.l=(e,t,n,r)=>{if(a[e])a[e].push(t);else{var o,i;if(void 0!==n)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var h=c[l];if(h.getAttribute("src")==e||h.getAttribute("data-webpack")==s+n){o=h;break}}o||(i=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,u.nc&&o.setAttribute("nonce",u.nc),o.setAttribute("data-webpack",s+n),o.src=e),a[e]=[t];var d=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var r=a[e];if(delete a[e],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((e=>e(n))),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),i&&document.head.appendChild(o)}},u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),u.p="/",(()=>{var e={792:0};u.f.j=(t,n)=>{var r=u.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=o);var i=u.p+u.u(t),a=new Error;u.l(i,(n=>{if(u.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",a.name="ChunkLoadError",a.type=o,a.request=i,r[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,o,[i,a,s]=n,c=0;if(i.some((t=>0!==e[t]))){for(r in a)u.o(a,r)&&(u.m[r]=a[r]);s&&s(u)}for(t&&t(n);c<i.length;c++)o=i[c],u.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkchessmos=self.webpackChunkchessmos||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),u(2091),u(3894),u(473),u(2115),u(8499),u(4577),u(63)})();
//# sourceMappingURL=main.bundle.js.map